!function(e){function t(t){for(var n,i,s=t[0],c=t[1],u=t[2],p=0,d=[];p<s.length;p++)i=s[p],Object.prototype.hasOwnProperty.call(o,i)&&o[i]&&d.push(o[i][0]),o[i]=0;for(n in c)Object.prototype.hasOwnProperty.call(c,n)&&(e[n]=c[n]);for(l&&l(t);d.length;)d.shift()();return a.push.apply(a,u||[]),r()}function r(){for(var e,t=0;t<a.length;t++){for(var r=a[t],n=!0,s=1;s<r.length;s++){var c=r[s];0!==o[c]&&(n=!1)}n&&(a.splice(t--,1),e=i(i.s=r[0]))}return e}var n={},o={3:0},a=[];function i(t){if(n[t])return n[t].exports;var r=n[t]={i:t,l:!1,exports:{}};return e[t].call(r.exports,r,r.exports,i),r.l=!0,r.exports}i.e=function(e){var t=[],r=o[e];if(0!==r)if(r)t.push(r[2]);else{var n=new Promise((function(t,n){r=o[e]=[t,n]}));t.push(r[2]=n);var a,s=document.createElement("script");s.charset="utf-8",s.timeout=120,i.nc&&s.setAttribute("nonce",i.nc),s.src=function(e){return i.p+""+({}[e]||e)+"."+{0:"9719df9c",1:"5ac491bf",2:"396da666",18:"9d65cb23",19:"2b58591f",20:"04c86613",21:"8adc9354",22:"97050f4d",23:"f690959a"}[e]+".iframe.bundle.js"}(e);var c=new Error;a=function(t){s.onerror=s.onload=null,clearTimeout(u);var r=o[e];if(0!==r){if(r){var n=t&&("load"===t.type?"missing":t.type),a=t&&t.target&&t.target.src;c.message="Loading chunk "+e+" failed.\n("+n+": "+a+")",c.name="ChunkLoadError",c.type=n,c.request=a,r[1](c)}o[e]=void 0}};var u=setTimeout((function(){a({type:"timeout",target:s})}),12e4);s.onerror=s.onload=a,document.head.appendChild(s)}return Promise.all(t)},i.m=e,i.c=n,i.d=function(e,t,r){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},i.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(i.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)i.d(r,n,function(t){return e[t]}.bind(null,n));return r},i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="",i.oe=function(e){throw console.error(e),e};var s=window.webpackJsonp=window.webpackJsonp||[],c=s.push.bind(s);s.push=t,s=s.slice();for(var u=0;u<s.length;u++)t(s[u]);var l=c;a.push([798,7,5,16,15,6,17,4,10,13,11,9,12,14,8]),r()}({1115:function(e,t,r){},1116:function(e,t,r){"use strict";(function(e){(0,r(551).configure)([r(1117),r(1157)],e,!1)}).call(this,r(223)(e))},1117:function(e,t,r){var n={"./stories/IntroductionCore.stories.mdx":1118};function o(e){var t=a(e);return r(t)}function a(e){if(!r.o(n,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return n[e]}o.keys=function(){return Object.keys(n)},o.resolve=a,e.exports=o,o.id=1117},1118:function(e,t,r){"use strict";r.r(t),r.d(t,"__page",(function(){return u}));r(0);var n=r(120),o=r(705),a=r(711);function i(){return(i=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}const s={};function c({components:e,...t}){return Object(n.b)("wrapper",i({},s,t,{components:e,mdxType:"MDXLayout"}),Object(n.b)(a.a,{title:"Core/Introduction",mdxType:"Meta"}))}c.isMDXComponent=!0;const u=()=>{throw new Error("Docs-only story")};u.parameters={docsOnly:!0};const l={title:"Core/Introduction",includeStories:["__page"]},p={};l.parameters=l.parameters||{},l.parameters.docs={...l.parameters.docs||{},page:()=>Object(n.b)(o.a,{mdxStoryNameToKey:p,mdxComponentAnnotations:l},Object(n.b)(c,null))},t.default=l},1157:function(e,t,r){var n={"./components/MapLibreMap/MapLibreMap.stories.js":1158,"./components/MlComponentTemplate/MlComponentTemplate.stories.js":1479,"./components/MlCreatePdfButton/MlCreatePdfButton.stories.js":1469,"./components/MlFeatureEditor/MlFeatureEditor.stories.js":1465,"./components/MlFillExtrusionLayer/MlFillExtrusionLayer.stories.js":1480,"./components/MlFollowGps/MlFollowGps.stories.js":1167,"./components/MlGPXViewer/MlGPXViewer.stories.js":1168,"./components/MlGeoJsonLayer/MlGeoJsonLayer.stories.js":1172,"./components/MlImageMarkerLayer/MlImageMarkerLayer.stories.js":1481,"./components/MlLayer/MlLayer.stories.js":1173,"./components/MlLayerMagnify/MlLayerMagnify.stories.js":1482,"./components/MlLayerSwipe/MlLayerSwipe.stories.js":1483,"./components/MlMarker/MlMarker.stories.js":1176,"./components/MlNavigationCompass/MlNavigationCompass.stories.js":1177,"./components/MlNavigationTools/MlNavigationTools.stories.js":1484,"./components/MlOsmLayer/MlOsmLayer.stories.js":1485,"./components/MlScaleReference/MlScaleReference.stories.js":1486,"./components/MlShareMapState/MlShareMapState.stories.js":1487,"./components/MlSpatialElevationProfile/MlSpatialElevationProfile.stories.js":1488,"./components/MlThreeJsLayer/MlThreeJsLayer.stories.js":1470,"./components/MlUseMapDebugger/MlUseMapDebugger.stories.js":1489,"./components/MlVectorTileLayer/MlVectorTileLayer.stories.js":1490,"./components/MlWmsFeatureInfoPopup/MlWmsFeatureInfoPopup.stories.js":1491,"./components/MlWmsLayer/MlWmsLayer.stories.js":1460,"./components/MlWmsLoader/MlWmsLoader.stories.js":1471,"./hooks/useMapState.stories.js":1463};function o(e){var t=a(e);return r(t)}function a(e){if(!r.o(n,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return n[e]}o.keys=function(){return Object.keys(n)},o.resolve=a,e.exports=o,o.id=1157},1158:function(e,t,r){"use strict";r.r(t),r.d(t,"ExampleConfig",(function(){return c}));var n=r(6),o=(r(0),r(159)),a=r(29),i=r(1),s={title:"Core/MapLibreMap",component:o.a,argTypes:{options:{control:{type:"object"}}}};t.default=s;var c=function(e){return Object(i.jsx)(a.a,{children:Object(i.jsx)(o.a,{options:e.options})})}.bind({});c.args={options:{style:"https://wms.wheregroup.com/tileserver/style/osm-bright.json",center:[8.607,53.1409349],maxBounds:[[1.40625,43.452919],[17.797852,55.973798]]}},c.parameters={},c.parameters=Object(n.a)({storySource:{source:"(args) => (\n  <MapComponentsProvider>\n    <MapLibreMap options={args.options} />\n  </MapComponentsProvider>\n)"}},c.parameters)},1159:function(e,t,r){},1167:function(e,t,r){"use strict";r.r(t),r.d(t,"ExampleConfig",(function(){return c}));var n=r(6),o=(r(0),r(287)),a=r(42),i=r(1),s={title:"MapComponents/MlFollowGps",component:o.a,argTypes:{url:{},layer:{}},decorators:a.a};t.default=s;var c=function(e){return Object(i.jsx)(o.a,{})}.bind({});c.parameters={},c.args={},c.parameters=Object(n.a)({storySource:{source:"(args) => <MlFollowGps />"}},c.parameters)},1168:function(e,t,r){"use strict";r.r(t),r.d(t,"ExampleConfig",(function(){return u}));var n=r(6),o=(r(0),r(289)),a=r(42),i=r(370),s=r(1),c={title:"MapComponents/MlGPXViewer",component:o.a,argTypes:{options:{control:{type:"object"}}},decorators:a.a};t.default=c;var u=function(e){return Object(s.jsx)(s.Fragment,{children:Object(s.jsx)(i.a,{children:Object(s.jsx)(o.a,{})})})}.bind({});u.parameters={},u.parameters=Object(n.a)({storySource:{source:"(args) => (\n  <>\n    <GeoJsonProvider>\n      <MlGPXViewer />\n    </GeoJsonProvider>\n  </>\n)"}},u.parameters)},1172:function(e,t,r){"use strict";r.r(t),r.d(t,"ExampleConfig",(function(){return f}));var n=r(6),o=r(21),a=r(0),i=r(207),s=r(42),c=r(29),u=r(726),l=r(727),p=r(1),d={title:"MapComponents/MlGeoJsonLayer",component:i.a,argTypes:{url:{},layer:{}},decorators:s.a};t.default=d;var f=function(e){var t=Object(a.useContext)(c.b),r=Object(a.useState)(u),n=Object(o.a)(r,2),s=n[0],d=n[1],f=Object(a.useRef)(!1);return Object(a.useEffect)((function(){t.getMap()&&!f.current&&(f.current=!0,t.getMap().setCenter({lng:7.137609868988648,lat:50.74746799549129}),t.getMap().setZoom(9.5),setTimeout((function(){d(l)}),4e3))}),[s,t]),Object(p.jsx)(p.Fragment,{children:Object(p.jsx)(i.a,{type:"line",geojson:s,transitionTime:2e3})})}.bind({});f.parameters={},f.args={},f.parameters=Object(n.a)({storySource:{source:'(props) => {\n  const mapContext = useContext(MapContext);\n  const [geojson, setGeojson] = useState(sample_geojson_1);\n  const initializedRef = useRef(false);\n\n  useEffect(() => {\n    if (!mapContext.getMap() || initializedRef.current) return;\n\n    initializedRef.current = true;\n    mapContext\n      .getMap()\n      .setCenter({ lng: 7.137609868988648, lat: 50.74746799549129 });\n    mapContext.getMap().setZoom(9.5);\n\n    setTimeout(() => {\n      setGeojson(sample_geojson_2);\n    }, 4000);\n  }, [geojson, mapContext]);\n\n  return (\n    <>\n      <MlGeoJsonLayer type="line" geojson={geojson} transitionTime={2000} />\n    </>\n  );\n}'}},f.parameters)},1173:function(e,t,r){"use strict";r.r(t),r.d(t,"ExampleConfig",(function(){return c}));var n=r(6),o=(r(0),r(290)),a=r(42),i=r(1),s={title:"MapComponents/MlLayer",component:o.a,argTypes:{url:{},layer:{}},decorators:a.a};t.default=s;var c=function(e){return Object(i.jsx)(o.a,{})}.bind({});c.parameters={},c.args={},c.parameters=Object(n.a)({storySource:{source:"(args) => <MlLayer />"}},c.parameters)},1174:function(e,t,r){},1175:function(e,t,r){},1176:function(e,t,r){"use strict";r.r(t),r.d(t,"ExampleConfig",(function(){return c}));var n=r(6),o=(r(0),r(291)),a=r(42),i=r(1),s={title:"MapComponents/MlMarker",component:o.a,decorators:a.a};t.default=s;var c=function(e){return Object(i.jsx)(o.a,Object(n.a)({},e))}.bind({});c.args={content:"WhereGroup",lng:7.0851268,lat:50.73884,mapId:"map_1"},c.parameters=Object(n.a)({storySource:{source:"(args) => <MlMarker {...args}/>"}},c.parameters)},1177:function(e,t,r){"use strict";r.r(t),r.d(t,"Standard",(function(){return u})),r.d(t,"StyleExample",(function(){return l}));var n=r(6),o=(r(0),r(292)),a=r(42),i=r(1),s={title:"MapComponents/MlNavigationCompass",component:o.a,decorators:a.a};t.default=s;var c=function(e){return Object(i.jsx)(o.a,Object(n.a)({},e))},u=c.bind({});u.args={style:{transform:"scale(4)",left:"50%",marginLeft:"-100px",top:"50%",marginTop:"-100px"}};var l=c.bind({});l.args={style:{transform:"scale(4)",left:"50%",marginLeft:"-100px",top:"50%",marginTop:"-100px"},backgroundStyle:{border:"12px solid #adad44",background:"radial-gradient(#417741, #111)"},needleStyle:{":hover svg path:nth-of-type(1)":{fill:"#eded66"},":hover svg path:nth-of-type(2)":{fill:"#252f1b"},"svg path:nth-of-type(1)":{fill:"#adad44"},"svg path:nth-of-type(2)":{fill:"#1a1d15"}},rotateRightStyle:{"svg:hover path":{fill:"#ededb1"}},rotateLeftStyle:{"svg:hover path":{fill:"#ededb1"}}},u.parameters=Object(n.a)({storySource:{source:"(props) => <MlNavigationCompass {...props} />"}},u.parameters),l.parameters=Object(n.a)({storySource:{source:"(props) => <MlNavigationCompass {...props} />"}},l.parameters)},1460:function(e,t,r){"use strict";r.r(t),r.d(t,"ExampleConfig",(function(){return d}));var n=r(6),o=r(21),a=r(0),i=r(158),s=r(95),c=r(745),u=r(235),l=(r(1461),r(1)),p={title:"MapComponents/MlWmsLayer",component:i.a,argTypes:{url:{},layer:{}},decorators:u.a};t.default=p;var d=function(e){var t=Object(a.useState)(!0),r=Object(o.a)(t,2),u=r[0],p=r[1];return Object(l.jsxs)(l.Fragment,{children:[Object(l.jsx)(s.a,{children:Object(l.jsx)(c.a,{color:"primary",variant:u?"contained":"outlined",onClick:function(){return p(!u)},children:"WMS"})}),Object(l.jsx)(i.a,Object(n.a)({visible:u},e))]})}.bind({});d.parameters={},d.args={mapId:"map_2",url:"https://www.wms.nrw.de/geobasis/wms_nw_uraufnahme",urlParameters:{layers:"nw_uraufnahme_rw"}},d.parameters=Object(n.a)({storySource:{source:'(props) => {\n  const [showLayer, setShowLayer] = useState(true);\n\n  return (\n    <>\n      <TopToolbar>\n        <Button\n          color="primary"\n          variant={showLayer ? "contained" : "outlined"}\n          onClick={() => setShowLayer(!showLayer)}\n        >\n          WMS\n        </Button>\n      </TopToolbar>\n      <MlWmsLayer visible={showLayer} {...props} />\n    </>\n  );\n}'}},d.parameters)},1461:function(e,t,r){},1463:function(e,t,r){"use strict";r.r(t),r.d(t,"ViewportOnly",(function(){return l})),r.d(t,"IncludeBaseLayers",(function(){return p})),r.d(t,"MatchLayerIdString",(function(){return d})),r.d(t,"MatchLayerIdRegexp",(function(){return f})),r.d(t,"NonBaseLayersOnly",(function(){return m}));var n=r(6),o=r(0),a=r(206),i=r(42),s=r(1),c={title:"Hooks/UseMapState",component:a.a,argTypes:{},decorators:i.a};t.default=c;var u=function(e){var t=Object(a.a)(Object(n.a)({},e));return Object(o.useEffect)((function(){}),[t.layers]),Object(s.jsx)(s.Fragment,{children:Object(s.jsx)("div",{style:{position:"fixed",zIndex:1e4,display:"flex",flexWrap:"wrap",top:0,left:0,right:0,bottom:0,maxHeight:"100VH",backgroundColor:"rgba(80,80,80,.8)",padding:"50px",fontSize:"20px",color:"#51ff09",overflow:"hidden",pointerEvents:"none"},children:Object(s.jsx)("pre",{children:JSON.stringify(t,null,"  ")})})})},l=u.bind({});l.parameters={},l.args={mapId:"map_1",watch:{viewport:!0,layers:!1,sources:!1}};var p=u.bind({});p.parameters={},p.args={mapId:"map_1",watch:{viewport:!1,layers:!0,sources:!1},filter:{includeBaseLayers:!0}};var d=u.bind({});d.parameters={},d.args={mapId:"map_1",watch:{viewport:!1,layers:!0,sources:!1},filter:{includeBaseLayers:!0,matchLayerIds:"water"}};var f=u.bind({});f.parameters={},f.args={mapId:"map_1",watch:{viewport:!1,layers:!0,sources:!1},filter:{includeBaseLayers:!0,matchLayerIds:/water/}};var m=u.bind({});m.parameters={},m.args={mapId:"map_1",watch:{viewport:!1,layers:!0,sources:!1},filter:{includeBaseLayers:!1}},l.parameters=Object(n.a)({storySource:{source:'(props) => {\n  const mapState = useMapState({ ...props });\n\n  useEffect(() => {\n\n  \n  }, [mapState.layers])\n\n  return (\n    <>\n    <div\n        style={{\n          position: "fixed",\n          zIndex: 10000,\n          display: "flex",\n          flexWrap: "wrap",\n          top: 0,\n          left: 0,\n          right: 0,\n          bottom: 0,\n          maxHeight:\'100VH\',\n          backgroundColor: "rgba(80,80,80,.8)",\n          padding: "50px",\n          fontSize: "20px",\n          color: "#51ff09",\n          overflow:\'hidden\',\n          pointerEvents: "none",\n        }}\n    >\n\n        <pre>{JSON.stringify(mapState, null, "  ")}</pre>\n\n\n    </div>\n    </>\n  );\n}'}},l.parameters),p.parameters=Object(n.a)({storySource:{source:'(props) => {\n  const mapState = useMapState({ ...props });\n\n  useEffect(() => {\n\n  \n  }, [mapState.layers])\n\n  return (\n    <>\n    <div\n        style={{\n          position: "fixed",\n          zIndex: 10000,\n          display: "flex",\n          flexWrap: "wrap",\n          top: 0,\n          left: 0,\n          right: 0,\n          bottom: 0,\n          maxHeight:\'100VH\',\n          backgroundColor: "rgba(80,80,80,.8)",\n          padding: "50px",\n          fontSize: "20px",\n          color: "#51ff09",\n          overflow:\'hidden\',\n          pointerEvents: "none",\n        }}\n    >\n\n        <pre>{JSON.stringify(mapState, null, "  ")}</pre>\n\n\n    </div>\n    </>\n  );\n}'}},p.parameters),d.parameters=Object(n.a)({storySource:{source:'(props) => {\n  const mapState = useMapState({ ...props });\n\n  useEffect(() => {\n\n  \n  }, [mapState.layers])\n\n  return (\n    <>\n    <div\n        style={{\n          position: "fixed",\n          zIndex: 10000,\n          display: "flex",\n          flexWrap: "wrap",\n          top: 0,\n          left: 0,\n          right: 0,\n          bottom: 0,\n          maxHeight:\'100VH\',\n          backgroundColor: "rgba(80,80,80,.8)",\n          padding: "50px",\n          fontSize: "20px",\n          color: "#51ff09",\n          overflow:\'hidden\',\n          pointerEvents: "none",\n        }}\n    >\n\n        <pre>{JSON.stringify(mapState, null, "  ")}</pre>\n\n\n    </div>\n    </>\n  );\n}'}},d.parameters),f.parameters=Object(n.a)({storySource:{source:'(props) => {\n  const mapState = useMapState({ ...props });\n\n  useEffect(() => {\n\n  \n  }, [mapState.layers])\n\n  return (\n    <>\n    <div\n        style={{\n          position: "fixed",\n          zIndex: 10000,\n          display: "flex",\n          flexWrap: "wrap",\n          top: 0,\n          left: 0,\n          right: 0,\n          bottom: 0,\n          maxHeight:\'100VH\',\n          backgroundColor: "rgba(80,80,80,.8)",\n          padding: "50px",\n          fontSize: "20px",\n          color: "#51ff09",\n          overflow:\'hidden\',\n          pointerEvents: "none",\n        }}\n    >\n\n        <pre>{JSON.stringify(mapState, null, "  ")}</pre>\n\n\n    </div>\n    </>\n  );\n}'}},f.parameters),m.parameters=Object(n.a)({storySource:{source:'(props) => {\n  const mapState = useMapState({ ...props });\n\n  useEffect(() => {\n\n  \n  }, [mapState.layers])\n\n  return (\n    <>\n    <div\n        style={{\n          position: "fixed",\n          zIndex: 10000,\n          display: "flex",\n          flexWrap: "wrap",\n          top: 0,\n          left: 0,\n          right: 0,\n          bottom: 0,\n          maxHeight:\'100VH\',\n          backgroundColor: "rgba(80,80,80,.8)",\n          padding: "50px",\n          fontSize: "20px",\n          color: "#51ff09",\n          overflow:\'hidden\',\n          pointerEvents: "none",\n        }}\n    >\n\n        <pre>{JSON.stringify(mapState, null, "  ")}</pre>\n\n\n    </div>\n    </>\n  );\n}'}},m.parameters)},1465:function(e,t,r){"use strict";r.r(t),r.d(t,"EditPolygon",(function(){return he})),r.d(t,"EditPoint",(function(){return be})),r.d(t,"EditLineString",(function(){return ve})),r.d(t,"DrawPolygon",(function(){return ye})),r.d(t,"DrawPoint",(function(){return je})),r.d(t,"DrawLineString",(function(){return Oe}));var n=r(6),o=r(0),a=r(21),i=(r(1159),r(1160),r(491)),s=r.n(i),c="mapbox-gl-draw_boxselect",u="add",l="move",p="pointer",d="none",f="polygon",m="Feature",g="Polygon",h="LineString",b="Point",v="Multi",y="MultiPoint",j="MultiLineString",O="MultiPolygon",x="draw.create",S="draw.update",M="draw.combine",C="draw.uncombine",w="move",E="change_coordinates",L="feature",I="midpoint",T="vertex",R="true",_="false";function A(e){return function(t){var r=t.featureTarget;return!!r&&(!!r.properties&&r.properties.meta===e)}}function P(e){return!!e.featureTarget&&(!!e.featureTarget.properties&&(e.featureTarget.properties.active===R&&e.featureTarget.properties.meta===L))}function k(e){return!!e.featureTarget&&(!!e.featureTarget.properties&&(e.featureTarget.properties.active===_&&e.featureTarget.properties.meta===L))}function H(e){return void 0===e.featureTarget}function F(e){var t=e.featureTarget;return!!t&&(!!t.properties&&t.properties.meta===T)}function N(e){return!!e.originalEvent&&!0===e.originalEvent.shiftKey}var U={enable:function(e){setTimeout((function(){e.map&&e.map.doubleClickZoom&&e._ctx&&e._ctx.store&&e._ctx.store.getInitialConfigValue&&e._ctx.store.getInitialConfigValue("doubleClickZoom")&&e.map.doubleClickZoom.enable()}),0)},disable:function(e){setTimeout((function(){e.map&&e.map.doubleClickZoom&&e.map.doubleClickZoom.disable()}),0)}};var B=function(e,t){return!!e.lngLat&&(e.lngLat.lng===t[0]&&e.lngLat.lat===t[1])},G=function(e,t,r,n){return{type:m,properties:{meta:T,parent:e,coord_path:r,active:n?R:_},geometry:{type:b,coordinates:t}}},D={onSetup:function(){console.log("Change mode: custom polygon");var e=this.newFeature({type:m,properties:{},geometry:{type:g,coordinates:[[]]}});return this.addFeature(e),this.clearSelectedFeatures(),U.disable(this),this.updateUIClasses({mouse:u}),this.activateUIButton(f),this.setActionableState({trash:!0}),{polygon:e,currentVertexPosition:0}},clickAnywhere:function(e,t){if(e.currentVertexPosition>0&&B(t,e.polygon.coordinates[0][e.currentVertexPosition-1]))return this.changeMode("custom_select",{featureIds:[e.polygon.id]});this.updateUIClasses({mouse:u}),e.polygon.updateCoordinate("0.".concat(e.currentVertexPosition),t.lngLat.lng,t.lngLat.lat),e.currentVertexPosition++,e.polygon.updateCoordinate("0.".concat(e.currentVertexPosition),t.lngLat.lng,t.lngLat.lat),this.map.fire(x,{features:[e.polygon.toGeoJSON()]})},clickOnVertex:function(e){return this.changeMode("custom_select",{featureIds:[e.polygon.id]})},onMouseMove:function(e,t){e.polygon.updateCoordinate("0.".concat(e.currentVertexPosition),t.lngLat.lng,t.lngLat.lat),F(t)&&this.updateUIClasses({mouse:p})}};D.onTap=D.onClick=function(e,t){return F(t)?this.clickOnVertex(e,t):this.clickAnywhere(e,t)},D.onKeyUp=function(e,t){!function(e){return 27===e.keyCode}(t)?function(e){return 13===e.keyCode}(t)&&this.changeMode("custom_select",{featureIds:[e.polygon.id]}):(this.deleteFeature([e.polygon.id],{silent:!0}),this.changeMode("custom_select"))},D.onStop=function(e){this.updateUIClasses({mouse:d}),U.enable(this),this.activateUIButton(),void 0!==this.getFeature(e.polygon.id)&&(e.polygon.removeCoordinate("0.".concat(e.currentVertexPosition)),e.polygon.isValid()?this.map.fire(x,{features:[e.polygon.toGeoJSON()]}):(this.deleteFeature([e.polygon.id],{silent:!0}),this.changeMode("custom_select",{},{silent:!0})))},D.toDisplayFeatures=function(e,t,r){var n=t.properties.id===e.polygon.id;if(t.properties.active=n?R:_,!n)return r(t);if(0!==t.geometry.coordinates.length){var o=t.geometry.coordinates[0].length;if(!(o<3)){if(t.properties.meta=L,r(G(e.polygon.id,t.geometry.coordinates[0][0],"0.0",!1)),o>3){var a=t.geometry.coordinates[0].length-3;r(G(e.polygon.id,t.geometry.coordinates[0][a],"0.".concat(a),!1))}if(o<=4){var i=[[t.geometry.coordinates[0][0][0],t.geometry.coordinates[0][0][1]],[t.geometry.coordinates[0][1][0],t.geometry.coordinates[0][1][1]]];if(r({type:m,properties:t.properties,geometry:{coordinates:i,type:h}}),3===o)return}return r(t)}}},D.onTrash=function(e){this.deleteFeature([e.polygon.id],{silent:!0}),this.changeMode("custom_select")};var z=D,q=r(721),V=r.n(q);var W=function(e,t){var r=t.getBoundingClientRect();return new V.a(e.clientX-r.left-(t.clientLeft||0),e.clientY-r.top-(t.clientTop||0))},K=function(e,t,r){var n=t.geometry.coordinates,o=r.geometry.coordinates;if(n[1]>85||n[1]<-85||o[1]>85||o[1]<-85)return null;var a={lng:(n[0]+o[0])/2,lat:(n[1]+o[1])/2};return{type:m,properties:{meta:I,parent:e,lng:a.lng,lat:a.lat,coord_path:r.properties.coord_path},geometry:{type:b,coordinates:[a.lng,a.lat]}}};var J=function e(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,o=t.geometry,a=o.type,i=o.coordinates,s=t.properties&&t.properties.id,c=[];function u(e,t){var n="",o=null;e.forEach((function(e,a){var i=null!=t?"".concat(t,".").concat(a):String(a),u=G(s,e,i,l(i));if(r.midpoints&&o){var p=K(s,o,u);p&&c.push(p)}o=u;var d=JSON.stringify(e);n!==d&&c.push(u),0===a&&(n=d)}))}function l(e){return!!r.selectedPaths&&-1!==r.selectedPaths.indexOf(e)}function p(){var n=a.replace(v,"");i.forEach((function(o,a){var i={type:m,properties:t.properties,geometry:{type:n,coordinates:o}};c=c.concat(e(i,r,a))}))}return a===b?c.push(G(s,i,n,l(n))):a===g?i.forEach((function(e,t){u(e,null!==n?"".concat(n,".").concat(t):String(t))})):a===h?u(i,n):0===a.indexOf(v)&&p(),c};function Y(e){if(this._items={},this._nums={},this._length=e?e.length:0,e)for(var t=0,r=e.length;t<r;t++)this.add(e[t]),void 0!==e[t]&&("string"==typeof e[t]?this._items[e[t]]=t:this._nums[e[t]]=t)}Y.prototype.add=function(e){return this.has(e)||(this._length++,"string"==typeof e?this._items[e]=this._length:this._nums[e]=this._length),this},Y.prototype.delete=function(e){return!1===this.has(e)||(this._length--,delete this._items[e],delete this._nums[e]),this},Y.prototype.has=function(e){return("string"==typeof e||"number"==typeof e)&&(void 0!==this._items[e]||void 0!==this._nums[e])},Y.prototype.values=function(){var e=this,t=[];return Object.keys(this._items).forEach((function(r){t.push({k:r,v:e._items[r]})})),Object.keys(this._nums).forEach((function(r){t.push({k:JSON.parse(r),v:e._nums[r]})})),t.sort((function(e,t){return e.v-t.v})).map((function(e){return e.k}))},Y.prototype.clear=function(){return this._length=0,this._items={},this._nums={},this};var X=Y,Z=r(722),Q=r.n(Z),$=function(e,t){var r=-90,n=90,o=-90,a=90,i=270,s=-270;e.forEach((function(e){var t=Q()(e),c=t[1],u=t[3],l=t[0],p=t[2];c>r&&(r=c),u<n&&(n=u),u>o&&(o=u),c<a&&(a=c),l<i&&(i=l),p>s&&(s=p)}));var c=t;return r+c.lat>85&&(c.lat=85-r),o+c.lat>90&&(c.lat=90-o),n+c.lat<-85&&(c.lat=-85-n),a+c.lat<-90&&(c.lat=-90-a),i+c.lng<=-270&&(c.lng+=360*Math.ceil(Math.abs(c.lng)/360)),s+c.lng>=270&&(c.lng-=360*Math.ceil(Math.abs(c.lng)/360)),c},ee=function(e,t){var r=$(e.map((function(e){return e.toGeoJSON()})),t);e.forEach((function(e){var t,n=e.getCoordinates(),o=function(e){var t={lng:e[0]+r.lng,lat:e[1]+r.lat};return[t.lng,t.lat]},a=function(e){return e.map((function(e){return o(e)}))};e.type===b?t=o(n):e.type===h||e.type===y?t=n.map(o):e.type===g||e.type===j?t=n.map(a):e.type===O&&(t=n.map((function(e){return e.map((function(e){return a(e)}))}))),e.incomingCoords(t)}))},te={onSetup:function(e){var t=this;console.log("Change mode: custom select");var r={dragMoveLocation:null,boxSelectStartLocation:null,boxSelectElement:void 0,boxSelecting:!1,canBoxSelect:!1,dragMoving:!1,canDragMove:!1,initiallySelectedFeatureIds:e.featureIds||[]};return this.setSelected(r.initiallySelectedFeatureIds.filter((function(e){return void 0!==t.getFeature(e)}))),this.fireActionable(),this.setActionableState({combineFeatures:!0,uncombineFeatures:!0,trash:!0}),r},fireUpdate:function(){this.map.fire(S,{action:w,features:this.getSelected().map((function(e){return e.toGeoJSON()}))})},fireActionable:function(){var e=this,t=this.getSelected(),r=t.filter((function(t){return e.isInstanceOf("MultiFeature",t)})),n=!1;if(t.length>1){n=!0;var o=t[0].type.replace("Multi","");t.forEach((function(e){e.type.replace("Multi","")!==o&&(n=!1)}))}var a=r.length>0,i=t.length>0;this.setActionableState({combineFeatures:n,uncombineFeatures:a,trash:i})},getUniqueIds:function(e){return e.length?e.map((function(e){return e.properties.id})).filter((function(e){return void 0!==e})).reduce((function(e,t){return e.add(t),e}),new X).values():[]},stopExtendedInteractions:function(e){e.boxSelectElement&&(e.boxSelectElement.parentNode&&e.boxSelectElement.parentNode.removeChild(e.boxSelectElement),e.boxSelectElement=null),this.map.dragPan.enable(),e.boxSelecting=!1,e.canBoxSelect=!1,e.dragMoving=!1,e.canDragMove=!1},onStop:function(){U.enable(this)},onMouseMove:function(e){return this.stopExtendedInteractions(e)},onMouseOut:function(e){if(e.dragMoving)return this.fireUpdate()}};te.onTap=te.onClick=function(e,t){return H(t)?this.clickAnywhere(e,t):A(T)(t)?this.clickOnVertex(e,t):function(e){return!!e.featureTarget&&(!!e.featureTarget.properties&&e.featureTarget.properties.meta===L)}(t)?this.clickOnFeature(e,t):void 0},te.clickAnywhere=function(e){var t=this,r=this.getSelectedIds();r.length&&(this.clearSelectedFeatures(),r.forEach((function(e){return t.doRender(e)}))),U.enable(this),this.stopExtendedInteractions(e)},te.clickOnVertex=function(e,t){this.changeMode("custom_direct_select",{featureId:t.featureTarget.properties.parent,coordPath:t.featureTarget.properties.coord_path,startPos:t.lngLat}),this.updateUIClasses({mouse:l})},te.startOnActiveFeature=function(e,t){this.stopExtendedInteractions(e),this.map.dragPan.disable(),this.doRender(t.featureTarget.properties.id),e.canDragMove=!0,e.dragMoveLocation=t.lngLat},te.clickOnFeature=function(e,t){var r=this;U.disable(this),this.stopExtendedInteractions(e);var n=N(t),o=this.getSelectedIds(),a=t.featureTarget.properties.id,i=this.isSelected(a);if(!n&&i&&this.getFeature(a).type!==b)return this.changeMode("custom_direct_select",{featureId:a});i&&n?(this.deselect(a),this.updateUIClasses({mouse:p}),1===o.length&&U.enable(this)):!i&&n?(this.select(a),this.updateUIClasses({mouse:l})):i||n||(o.forEach((function(e){return r.doRender(e)})),this.setSelected(a),this.updateUIClasses({mouse:l})),this.doRender(a)},te.onMouseDown=function(e,t){return P(t)?this.startOnActiveFeature(e,t):this.drawConfig.boxSelect&&function(e){return!!e.originalEvent&&(!!e.originalEvent.shiftKey&&0===e.originalEvent.button)}(t)?this.startBoxSelect(e,t):void 0},te.startBoxSelect=function(e,t){this.stopExtendedInteractions(e),this.map.dragPan.disable(),e.boxSelectStartLocation=W(t.originalEvent,this.map.getContainer()),e.canBoxSelect=!0},te.onTouchStart=function(e,t){if(P(t))return this.startOnActiveFeature(e,t)},te.onDrag=function(e,t){return e.canDragMove?this.dragMove(e,t):this.drawConfig.boxSelect&&e.canBoxSelect?this.whileBoxSelect(e,t):void 0},te.whileBoxSelect=function(e,t){e.boxSelecting=!0,this.updateUIClasses({mouse:u}),e.boxSelectElement||(e.boxSelectElement=document.createElement("div"),e.boxSelectElement.classList.add(c),this.map.getContainer().appendChild(e.boxSelectElement));var r=W(t.originalEvent,this.map.getContainer()),n=Math.min(e.boxSelectStartLocation.x,r.x),o=Math.max(e.boxSelectStartLocation.x,r.x),a=Math.min(e.boxSelectStartLocation.y,r.y),i=Math.max(e.boxSelectStartLocation.y,r.y),s="translate(".concat(n,"px, ").concat(a,"px)");e.boxSelectElement.style.transform=s,e.boxSelectElement.style.WebkitTransform=s,e.boxSelectElement.style.width="".concat(o-n,"px"),e.boxSelectElement.style.height="".concat(i-a,"px")},te.dragMove=function(e,t){e.dragMoving=!0,t.originalEvent.stopPropagation();var r={lng:t.lngLat.lng-e.dragMoveLocation.lng,lat:t.lngLat.lat-e.dragMoveLocation.lat};ee(this.getSelected(),r),e.dragMoveLocation=t.lngLat},te.onMouseUp=function(e,t){var r=this;if(e.dragMoving)this.fireUpdate();else if(e.boxSelecting){var n=[e.boxSelectStartLocation,W(t.originalEvent,this.map.getContainer())],o=this.featuresAt(null,n,"click"),a=this.getUniqueIds(o).filter((function(e){return!r.isSelected(e)}));a.length&&(this.select(a),a.forEach((function(e){return r.doRender(e)})),this.updateUIClasses({mouse:l}))}this.stopExtendedInteractions(e)},te.toDisplayFeatures=function(e,t,r){t.properties.active=this.isSelected(t.properties.id)?R:_,r(t),this.fireActionable(),t.properties.active===R&&t.geometry.type!==b&&J(t).forEach(r)},te.onTrash=function(){this.deleteFeature(this.getSelectedIds()),this.fireActionable()},te.onCombineFeatures=function(){var e=this.getSelected();if(!(0===e.length||e.length<2)){for(var t=[],r=[],n=e[0].type.replace("Multi",""),o=0;o<e.length;o++){var a=e[o];if(a.type.replace("Multi","")!==n)return;a.type.includes("Multi")?a.getCoordinates().forEach((function(e){t.push(e)})):t.push(a.getCoordinates()),r.push(a.toGeoJSON())}if(r.length>1){var i=this.newFeature({type:m,properties:r[0].properties,geometry:{type:"Multi".concat(n),coordinates:t}});this.addFeature(i),this.deleteFeature(this.getSelectedIds(),{silent:!0}),this.setSelected([i.id]),this.map.fire(M,{createdFeatures:[i.toGeoJSON()],deletedFeatures:r})}this.fireActionable()}},te.onUncombineFeatures=function(){var e=this,t=this.getSelected();if(0!==t.length){for(var r=[],n=[],o=function(o){var a=t[o];e.isInstanceOf("MultiFeature",a)&&(a.getFeatures().forEach((function(t){e.addFeature(t),t.properties=a.properties,r.push(t.toGeoJSON()),e.select([t.id])})),e.deleteFeature(a.id,{silent:!0}),n.push(a.toGeoJSON()))},a=0;a<t.length;a++)o(a);r.length>1&&this.map.fire(C,{createdFeatures:r,deletedFeatures:n}),this.fireActionable()}};var re=te,ne={getMatchingVertices:function(e,t,r,n){for(var o=[],a=e[0].toFixed(5),i=e[1].toFixed(5),s=0;s<r.length;s++)if(r[s].id!==t)for(var c=0;c<r[s].geometry.coordinates.length;c++)for(var u=0;u<r[s].geometry.coordinates[c].length;u++)a===r[s].geometry.coordinates[c][u][0].toFixed(5)&&i===r[s].geometry.coordinates[c][u][1].toFixed(5)&&o.push({featureId:r[s].id,coord_path:c+"."+u,lng:r[s].geometry.coordinates[c][u][0],lat:r[s].geometry.coordinates[c][u][1]});return o},getDrawInstance:function(e){for(var t=e._controls.length-1;t>=0;t--)if(e._controls[t].options&&"custom_select"===e._controls[t].options.defaultMode)return e._controls[t];return null}},oe=A(T),ae=A(I),ie={fireUpdate:function(){this.map.fire(S,{action:E,features:this.getSelected().map((function(e){return e.toGeoJSON()}))})},fireActionable:function(e){this.setActionableState({combineFeatures:!1,uncombineFeatures:!1,trash:e.selectedCoordPaths.length>0})},startDragging:function(e,t){this.map.dragPan.disable(),e.canDragMove=!0,e.dragMoveLocation=t.lngLat},stopDragging:function(e){this.map.dragPan.enable(),e.dragMoving=!1,e.canDragMove=!1,e.dragMoveLocation=null},onVertex:function(e,t){this.startDragging(e,t);var r=t.featureTarget.properties,n=e.selectedCoordPaths.indexOf(r.coord_path);N(t)||-1!==n?N(t)&&-1===n&&e.selectedCoordPaths.push(r.coord_path):e.selectedCoordPaths=[r.coord_path];var o=ne.getDrawInstance(this.map).getAll(),a=ne.getMatchingVertices(t.featureTarget._geometry.coordinates,t.featureTarget.properties.parent,o.features,this.map);e.groupMove_vertices=a;for(var i=0;i<e.groupMove_vertices.length;i++)e.groupMove_vertices[i].feature=this.getFeature(e.groupMove_vertices[i].featureId);var s=this.pathsToCoordinates(e.featureId,e.selectedCoordPaths);this.setSelectedCoordinates(s)},onMidpoint:function(e,t){this.startDragging(e,t);var r=t.featureTarget.properties;e.feature.addCoordinate(r.coord_path,r.lng,r.lat),this.fireUpdate(),e.selectedCoordPaths=[r.coord_path]},pathsToCoordinates:function(e,t){return t.map((function(t){return{feature_id:e,coord_path:t}}))},onFeature:function(e,t){0===e.selectedCoordPaths.length?this.startDragging(e,t):this.stopDragging(e)},dragFeature:function(e,t,r){ee(this.getSelected(),r),e.dragMoveLocation=t.lngLat},dragVertex:function(e,t,r){for(var n=e.selectedCoordPaths.map((function(t){return e.feature.getCoordinate(t)})),o=n.map((function(e){return{type:m,properties:{},geometry:{type:b,coordinates:e}}})),a=$(o,r),i=0;i<n.length;i++){var s=n[i];e.feature.updateCoordinate(e.selectedCoordPaths[i],s[0]+a.lng,s[1]+a.lat);for(var c=0;c<e.groupMove_vertices.length;c++){var u=e.groupMove_vertices[c].coord_path.split(".");if(void 0!==u[0]&&void 0!==u[1]&&void 0!==e.groupMove_vertices[c].feature.coordinates[u[0]]&&void 0!==e.groupMove_vertices[c].feature.coordinates[u[0]][u[1]]){var l=e.groupMove_vertices[c].feature.coordinates[u[0]][u[1]];e.groupMove_vertices[c].feature.updateCoordinate(e.groupMove_vertices[c].coord_path,l[0]+a.lng,l[1]+a.lat)}}}},clickNoTarget:function(){this.changeMode("custom_select")},clickInactive:function(){this.changeMode("custom_select")},clickActiveFeature:function(e){e.selectedCoordPaths=[],this.clearSelectedCoordinates(),e.feature.changed()},onSetup:function(e){var t=e.featureId,r=this.getFeature(t);if(!r)throw new Error("You must provide a featureId to enter direct_select mode");if(r.type===b)throw new TypeError("direct_select mode doesn't handle point features");var n={featureId:t,feature:r,dragMoveLocation:e.startPos||null,dragMoving:!1,canDragMove:!1,selectedCoordPaths:e.coordPath?[e.coordPath]:[],groupMove_vertices:e.groupMove_vertices?e.groupMove_vertices:[]};return this.setSelectedCoordinates(this.pathsToCoordinates(t,n.selectedCoordPaths)),this.setSelected(t),U.disable(this),this.setActionableState({trash:!0}),n},onStop:function(){U.enable(this),this.clearSelectedCoordinates()},toDisplayFeatures:function(e,t,r){e.featureId===t.properties.id?(t.properties.active=R,r(t),J(t,{map:this.map,midpoints:!0,selectedPaths:e.selectedCoordPaths}).forEach(r)):(t.properties.active=_,r(t)),this.fireActionable(e)},onTrash:function(e){e.selectedCoordPaths.sort((function(e,t){return t.localeCompare(e,"en",{numeric:!0})})).forEach((function(t){return e.feature.removeCoordinate(t)})),this.fireUpdate(),e.selectedCoordPaths=[],this.clearSelectedCoordinates(),this.fireActionable(e),!1===e.feature.isValid()&&(this.deleteFeature([e.featureId]),this.changeMode("custom_select",{}))},onMouseMove:function(e,t){var r=P(t),n=oe(t),o=0===e.selectedCoordPaths.length;r&&o||n&&!o?this.updateUIClasses({mouse:l}):this.updateUIClasses({mouse:d}),this.stopDragging(e)},onMouseOut:function(e){e.dragMoving&&this.fireUpdate()}};ie.onTouchStart=ie.onMouseDown=function(e,t){return oe(t)?this.onVertex(e,t):P(t)?this.onFeature(e,t):ae(t)?this.onMidpoint(e,t):void 0},ie.onDrag=function(e,t){if(!0===e.canDragMove){e.dragMoving=!0,t.originalEvent.stopPropagation();var r={lng:t.lngLat.lng-e.dragMoveLocation.lng,lat:t.lngLat.lat-e.dragMoveLocation.lat};e.selectedCoordPaths.length>0?this.dragVertex(e,t,r):this.dragFeature(e,t,r),e.dragMoveLocation=t.lngLat}},ie.onClick=function(e,t){return H(t)?this.clickNoTarget(e,t):P(t)?this.clickActiveFeature(e,t):k(t)?this.clickInactive(e,t):void this.stopDragging(e)},ie.onTap=function(e,t){return H(t)?this.clickNoTarget(e,t):P(t)?this.clickActiveFeature(e,t):k(t)?this.clickInactive(e,t):void 0},ie.onTouchEnd=ie.onMouseUp=function(e){e.dragMoving&&this.fireUpdate(),this.stopDragging(e)};var se=ie,ce=r(212),ue=r(29),le=r(1);function pe(e){var t=Object(o.useRef)(null),r=Object(o.useRef)(null),n=Object(o.useContext)(ue.b),i=Object(o.useRef)((e.idPrefix?e.idPrefix:"MlFeatureEditor-")+Object(ce.a)()),c=Object(o.useRef)(e.onChange),u=Object(o.useState)(!1),l=Object(a.a)(u,2),p=l[0],d=l[1],f=Object(o.useState)(!1),m=Object(a.a)(f,2),g=m[0],h=m[1],b=Object(o.useState)(!1),v=Object(a.a)(b,2),y=v[0],j=v[1],O=function(e){console.log("MlFeatureEditor mode change to "+e.mode)},x=function(){j(Math.random())};return Object(o.useEffect)((function(){var e=i.current;return function(){t.current&&(t.current.cleanup(e),t.current=null)}}),[]),Object(o.useEffect)((function(){n.mapExists(e.mapId)&&n.getMap(e.mapId).style&&!p&&(t.current=n.getMap(e.mapId),d(!0),t.current&&t.current.style&&t.current.getSource("mapbox-gl-draw-cold")&&r.current&&void 0!==r.current.remove&&r.current.remove(),r.current=new s.a({displayControlsDefault:!1,defaultMode:e.mode||"custom_select",modes:Object.assign({custom_polygon:z,custom_select:re,custom_direct_select:se},s.a.modes)}),t.current.on("draw.modechange",O,i.current),t.current.addControl(r.current,"top-left",i.current),t.current.on("mouseup",x,i.current),h(!0))}),[n.map,n,e,p]),Object(o.useEffect)((function(){r.current&&e.geojson&&e.geojson.geometry&&e.geojson.geometry.coordinates&&r.current.set({type:"FeatureCollection",features:[e.geojson]})}),[e.geojson,g]),Object(o.useEffect)((function(){if(r.current&&y){var e=r.current.getAll();"function"==typeof c.current&&c.current(e.features)}}),[y]),Object(o.useEffect)((function(){e.mode&&r.current&&r.current.changeMode(e.mode)}),[e.mode]),Object(le.jsx)(le.Fragment,{})}pe.__docgenInfo={description:"",methods:[],displayName:"MlFeatureEditor"};var de=pe;"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/MlFeatureEditor/MlFeatureEditor.js"]={name:"MlFeatureEditor",docgenInfo:pe.__docgenInfo,path:"src/components/MlFeatureEditor/MlFeatureEditor.js"});var fe=r(42),me={title:"MapComponents/MlFeatureEditor",component:de,argTypes:{},decorators:fe.a},ge=(t.default=me,function(e){return Object(le.jsx)(de,Object(n.a)({debug:!0,onChange:function(e){console.log(e)}},e))}),he=ge.bind({});he.args={mode:"custom_select",geojson:{type:"Feature",properties:{},geometry:{coordinates:[[[7.0904979943736635,50.73948334574527],[7.087554458473562,50.73827346433987],[7.093562913197076,50.73723639825727],[7.096294028980594,50.7387727842636],[7.0904979943736635,50.73948334574527]]],type:"Polygon"}}};var be=ge.bind({});be.args={mode:"custom_select",geojson:{type:"Feature",properties:{},geometry:{type:"Point",coordinates:[7.0904979943736635,50.73948334574527]}}};var ve=ge.bind({});ve.args={mode:"simple_select",geojson:{type:"Feature",properties:{},geometry:{coordinates:[[7.0904979943736635,50.73948334574527],[7.087554458473562,50.73827346433987],[7.093562913197076,50.73723639825727],[7.096294028980594,50.7387727842636]],type:"LineString"}}};var ye=ge.bind({});ye.args={mode:"custom_polygon"};var je=ge.bind({});je.args={mode:"draw_point"};var Oe=ge.bind({});Oe.args={mode:"draw_line_string"},he.parameters=Object(n.a)({storySource:{source:"(args) => {\n  return (\n    <MlFeatureEditor\n      debug={true}\n      onChange={(features) => {\n        console.log(features);\n      }}\n      {...args}\n    />\n  );\n}"}},he.parameters),be.parameters=Object(n.a)({storySource:{source:"(args) => {\n  return (\n    <MlFeatureEditor\n      debug={true}\n      onChange={(features) => {\n        console.log(features);\n      }}\n      {...args}\n    />\n  );\n}"}},be.parameters),ve.parameters=Object(n.a)({storySource:{source:"(args) => {\n  return (\n    <MlFeatureEditor\n      debug={true}\n      onChange={(features) => {\n        console.log(features);\n      }}\n      {...args}\n    />\n  );\n}"}},ve.parameters),ye.parameters=Object(n.a)({storySource:{source:"(args) => {\n  return (\n    <MlFeatureEditor\n      debug={true}\n      onChange={(features) => {\n        console.log(features);\n      }}\n      {...args}\n    />\n  );\n}"}},ye.parameters),je.parameters=Object(n.a)({storySource:{source:"(args) => {\n  return (\n    <MlFeatureEditor\n      debug={true}\n      onChange={(features) => {\n        console.log(features);\n      }}\n      {...args}\n    />\n  );\n}"}},je.parameters),Oe.parameters=Object(n.a)({storySource:{source:"(args) => {\n  return (\n    <MlFeatureEditor\n      debug={true}\n      onChange={(features) => {\n        console.log(features);\n      }}\n      {...args}\n    />\n  );\n}"}},Oe.parameters)},1469:function(e,t,r){"use strict";r.r(t),r.d(t,"ExampleConfig",(function(){return S}));var n=r(6),o=r(0),a=r(29),i=r(61),s=r(178),c=r.n(s),u=r(712),l={street:["footway","street","road","street_name","residential","path","pedestrian","road_reference","road_reference_intl","square","place"],number:["house_number","street_number"],place:["city","village","hamlet","locality","croft","neighbourhood","suburb","city_district","district","quarter","borough","city_block","residential","commercial","industrial","houses","subdivision","allotments","postal_city","town","municipality","local_administrative_area"],zip:["postcode","partial_postcode"],state:["state","province","state_code"]},p=function(e){var t=[];for(var r in l)l[r].some((function(r){return!!e.hasOwnProperty(r)&&(t.push(e[r]),!0)}));return t.join(", ")},d=function(e){return 25.4,96/25.4*e+"px"},f=function(e,t,r){r(!0);var n=window.devicePixelRatio,o=document.createElement("div");o.className="hidden-map",document.body.appendChild(o);var a=document.createElement("div");a.style.width=d(210),a.style.height=d(297),o.appendChild(a);var s=new c.a.Map({container:a,center:e.getCenter(),zoom:e.getZoom(),bearing:e.getBearing(),pitch:e.getPitch(),interactive:!1,preserveDrawingBuffer:!0,fadeDuration:0,attributionControl:!1}),l=e.getStyle(),f=function(e){var t=l.sources[e];Object.keys(t).forEach((function(e){t[e]||delete t[e]}))};for(var m in l.sources)f(m);s.setStyle(l),s.once("idle",(function(){var e,a=new u.a({orientation:"p",unit:"mm",compress:!0});Object.defineProperty(window,"devicePixelRatio",{get:function(){return 3.125}});var c=(t?p(t.address):"").split(","),l=[];l.length&&c.forEach((function(e){var t=e.match(/.{1,34}/g);l.push.apply(l,Object(i.a)(t))})),a.addImage(s.getCanvas().toDataURL("image/png"),"png",0,0,210,297,null,"FAST"),a.setFillColor("white"),a.rect(138,287,297,10,"F"),a.setFontSize(10),a.text("Datenquelle: © OpenStreetMap-Mitwirkende",140,a.internal.pageSize.height-3),a.setFillColor("white");var d=3.25*l.length+3+3+6.5+4+1;a.rect(2.5,2,66.5,d,"F"),a.setFontSize(10),a.text("Karten PDF:",6,5.5),a.rect(6,7,60,3.25*l.length+4+1),a.setFontSize(10),l.forEach((function(e,t){a.text(e.trim(),8,10+3.5*t+2)})),a.addImage("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAKgAAACxCAMAAABnTAbVAAAC8VBMVEUAAAD/AACAAACqAFW/AECZMzOqK1W2JEm/IECqHDmzGk25F0aqFUCxJzu2JEmqIkSvIEC0HjyqHEeuG0OzGkC2GD2uI0axIUO1IECtHz2xHUWzHEKtG0CwGj6zIkS1IUKyHz60HkSvHUKxHECzHD6uG0OxIUGzIECuHz6wHkOyHkG0HUCwHD6xHEOzIUGvIECxHz6zH0KvHkGxHUCyHT+vHEKwHEGyIECzHz+wH0KxHkGzHkCwHT+xHUKyHEGvIECxHz+yH0KzHkGwHkCxHj+zHUKwHUGxHECyHz+wH0GxH0GyHkCwHj+xHUGyHUGzHUCwHz+xH0GyH0GwHkCxHj+yHkGwHUCxHUCyHT+wH0GxH0CxHkCyHj+wHkGxHkCyHUCwHT+xH0GyH0CwH0CxHj+yHkGwHkCxHUCxHT+yHUGwH0CxH0CyHj+wHkGxHkCyHkCwHT+xHUGxH0CyH0CxHz+xHkGyHkCwHkCxHj+yHUGwHUCxH0CwHkGxHkCxHkCyHj+xHUGxHUCyH0CwHz+xHkGyHkCwHkCxHj+xHkGwHUCxHUCxHz+yH0GxHkCyHj+wHkGxHUCxHUCwHz+xH0GxHkCyHkCxHj+xHkGyHkCxHUCxHT+yH0GwHkCxHkCxHj+wHkGxHkCxHkCyHT+xH0GxH0CyHkCxHj+xHkGxHkCwHkCxHT+xHUCwH0CxHkCxHj+yHkCxHkCxHkCyHj+xHUCxH0CxHkCwHj+xHkCxHkCwHkCxHj+xHkCyHUCxH0CxHj+xHkCxHkCxHkCxHj+wHkCxHUCxH0CyHj+xHkCxHkCyHkCxHj+xHkCxHUCxHz+xHkCwHkCxHkCxHj+yHkCxHkCxHkCxHkCxHkCxHkCxHj+xHkCwHkCxHT+xHkCxHkCxHkCxHj+xHkCxHkCxHkCxHj+xH0CxHkCxHkCyHj+xHkCxHkCxHkCxHj+xHkCxHkCxHkCxHj+xHkCxHkCxHkCxHj+xHkCxHkCxHkCxHj+xHkCxHkD///9g21WfAAAA+XRSTlMAAQIDBAUGBwgJCgsMDQ4PEBESExQVFhcYGRobHB0eHyEiIyQlJicoKSorLC0uLzAxMjM0NTY3ODk6Ozw9Pj9AQUJDREVGR0hJSktMTU5PUFFSU1RVVldYWVpbXF1eX2BhYmNkZWZnaGlqa2xtbm9wcXJzdHV2d3h5ent8fn+AgYKDhIWGh4iJiouMjY6PkZKTlJWWl5iZmpucnZ6foKGio6SlpqeoqaqrrK2ur7CxsrO0tba3uLm6u7y9vr/AwcLDxMXGx8jJysvMzc/Q0dLT1NXW19ja29zd3uDh4uPk5ebn6Onq6+zt7u/w8fLz9PX29/j5+vv8/f7v1AMKAAAAAWJLR0T61W0GSgAACWZJREFUGBnVwXlAVHUCB/DvmxkuD0QswFo3TcwzS0p01RVMpUytLKxMSVNpLUsLj7VDo7btsNTssrTMdAtWNjNbkyzF3EotwrXMI7XwAAxE5Jz5/rcaMMx782Z452/p84GV2na+ZmRqasrwxE4OtFRhI/+29SS9qn/86PGUKLQ4CW+X0p/n+xeTnGhB4v/NgIpXj3aihZhRyaCOPNYRwrW+KwkKmWxWTVYfiBRy49qzxW0hN5FaeLLiIUrv5UUkl0Au9iy1qXk1BgJIIzZ7eMG1kHuBmpVMkWCz0LQC1itzQkb6hTpsiYOdQmcfZ6M8yPWmLoWDYBsp9SCbZENuDPWpmgKbJO+mr9WQm0y95sEO8Zso9z7k7qJuj8JyzofPUeFjyA2nfvfDYl23089eyPWkfrXDYCXXI1X0Vy5BxllC/U50hHU676aqbpDLogEfoEFUR5g0qoTqJkJuAo0YjQZPpcIMab6bAayBXMgxGrDfiXrhBVnRMOyiTxhQkQtyGTTidjS4quZIEgzqfYRBjIFc2Pc0YCcaLWbdXyUY8acSBrMBCgPqqJ+nExpEniL/FQn9hpczKHdPKCyiAfeh0SMkf+wDvSbWsBlroCCtpX6volFkOcmzqdBntofN8QyGQkQudcuF12qe554DPWZRg70hUAjNoV6fwyuFv1nuhGYT3dRiDpRCVlCnHHiFlfM3m9tCo5trqUlFX/hJO0ddFqJJLut9HQ1NrquiRoc7wM/V31GPa9DkGTbIvwga9C+nZrlO+Al9opqabYWPqWy0NwbNuvQEdXgJKuI/oEaVfeFjFL32xaEZYV+yQeWBbVlZq15f9sp7W/YcrmYAS6AmOY9aeCbA13Vssv8SBPcazzuaPS/5Yvhy9bhtYfZxqlgiQU3SFg+bUzUJMtfTR0EUgpnK2s/n9oQ6qe+cT85R6SUnVPVYXsag9iVCLo2+dkQgsKv3zI9FUBGpuR7KbY6CulZ3bqplICfmhUHhWcpsdCGgi6FB16dOUeaHeATSbtyKI/Tn2TEtAn7yKLdSgkmt55ygr9M3I4ies9fkV7PJwXVTO0HFxbVUWAjTWj10kr7eikRQIb3vSJ8//5l5aSN7RyGAJ6nkuQXmRS1108eRZJgUeZp+yvvAAoP20od7VRxMeZEqDkXDAiFPuumjLCMExo3yUM2nLljhhhL6+iHVAYO6nqK6TFii05eU2ZfmhBHdf2YA7mRYIiybcnvTwqDbgJMM6Gh7WML5JhVOPvNH6CLNqmYQ62ENaSmVatbfFArNEvIoV7Phvmti2rXukrJgazXPmw6LLKa/4uUDHdAi/h8eylQtjoNX1H355JlOsIb0PtUUrhgTgeAcoza5KfddD8hIN37LjbBI+BdUV/HJI4NCEIBr2LKjVNrcFkquhypvh0UuOsCAzm5bktYnBHLRQx/d9Cv9veeCir550bBI3yoGVXv40xWZGdNT09LTH12yZmcR1X0VDlVtR8Aqc2mBXzrCdo7PaN44CHBZKc36CELMpUk1XSBE6EGa8xYEmUBT3L0giLSLZnwIYW6iGbdCGMdhGlcaAXHm07g3IVCHczRsHER6l0bVRkGk22jUTgjVpooGPQuxttCg8RDrARp0OcTqRWPKJYjlqqQh+RBtDw1ZD9FW0pDnIdqDNCQDoo2iIVMgWiINGQvRLqchwyBaFA35M0STamjEIAh3mkYMhnClNOJ6CHeGRqRCuCoakQ7RImhIJkSLoyFvQbSraMhWiDaWhhyFaDNpiKcdBFtOYwZCsG00ZjrEkoppzGsQqzsNyodY99CgukgI9TaNSoZIUiGNWgSREmjYfyDSszSsrj3EcRyjceMgTgpNWAlx1tGEYhdEiaygGddBlIdoyisQJKKQphx3QYxZNGk0hAj7mSblQIiZNKs2DgJEn6RpcyDACpr3kwu2S3TTAnfAbq58WmEP7PYYgzq1fdXf56anT5/ycOayNZ8WMaChsNeQWgZy4NXJie0hFzciY2MF1WyDrWJ/oaritfdchgAiRr18jP5ugI0cW6jCnZsWgaAcwzd6qPCdA/Z5mv4Ozr8EGvR4pZpyE2CbSR4qHU53QaP4LA99FbaDTW6po8L+iU7oMHg3fS2DPYZVUe50uhP6uBbWsom7P+xw7RnKrYuFfgMPsUl+KKw39FfKHEqBIW3Xs8lSWC61ijKrW8Egx1I2uQ0We8BNX1WzYMIsNxuVd4eVnIspc6gfTJnkZqP/RsM6l26nTG4UTHqAXl+1gVWGn6DMhnCYlkmvz8JhidDFHsqsdMICb9BrUxtY4M97KbdMghXCvqFXwWUwq+NaKjwHi3Qto1dhf5gSOruMCu9IsMqdbFI11wnDwmcepdLmEFhnHX18PQDGtM44Tj+72sBCl5yhD88/+0G/K18sor/CWFhqDuV2psfCq/UMNCdm9rdUU5cMa4V8TwVP/uszRicmJAyZ9m5ZJfCXpBAE4Lx2wWc1VLcQVhvHIN4DxrM0J2NwBBRikmdmlzCgrQ5YzbGfgaUA0k6eV1OQ8/y9qSMHJQy96e4HH389r5hBFcXBelMZ0DEngEQPdZsCG4T9zECewgUrqdcOCXZYyACqL8UFHYqoT21f2OJyD9WtQr1p1Oc52GQ3VXl6oZ6URz1OtYFNHqaqj9AovoI6LIBd/kBVQ+E1m9qVRMI2P1LFDjRx5FGzx2GfN+nPMxA+OpVQo7L2sM9k+suGzHhq9AJs1Jl+arpBbhW1uRJ2KqXSMii0LqAWu2Crb6hQGgOlrr9Sgxmw1ftUSIe/MR42q7I9bPU05bZLUPEEm5UDe02jTGU3qJHWsjn3wl7jKbMA6iK+YjO6wF430te3IQgg9hCDOgCbJdNH+RUIqMtxBvMybDaAPiYhiH5lDOJW2Kwfm7yBoJIqGFhX2CyJXgURCG74OQZS4YDNxrJR6RVozohKBrAHdpvEBjUj0LyUCqpbDbvdzwaTocWQUqqaB7stYr1MaJNQRDV3wG7v8DdrJGjU7SBVXA+7fcELPgyFZh2+oL/+sJmjjOd9HAYdWuXQzxWwWS+e92EodJEWeagQA5tNJ7khFHrdUk65cNgsh8wOhX4991GmFewVVs7nHTAiYil9tYO9Uuruh1F3n2GTONjr6dEwrnMevfrBXrEwwzGvig3GomXrvoP1HkQLJ6WV8II30OJ1XO0huQu/AwN3k5Vh+B1wpP3EIfhdCE2fhv+X/wF/AO+L9vuzfwAAAABJRU5ErkJggg==","png",5,12+3*l.length+4,3,3,null,"FAST"),a.setFontSize(10),a.text("wheregroup.com",40,12+3.25*l.length+4+1),a.setProperties({title:"Map export",subject:"Map export",creator:"WhereGroup GmbH",author:"(c)WhereGroup GmbH, (c)OpenStreetMap"}),a.save("Map.pdf"),s.remove(),null===(e=o.parentNode)||void 0===e||e.removeChild(o),Object.defineProperty(window,"devicePixelRatio",{get:function(){return n}}),r(!1)}))},m=r(713),g=r.n(m),h=r(745),b=r(1),v=function(e){var t=Object(o.useContext)(a.b),r=Object(o.useRef)(!1),n=Object(o.useRef)(void 0);return Object(o.useEffect)((function(){t.mapExists(e.mapId)&&!r.current&&(r.current=!0,n.current=t.getMap(e.mapId))}),[t.mapIds,t,e.mapId]),Object(b.jsx)(b.Fragment,{children:Object(b.jsx)(h.a,{color:"primary",variant:"contained",onClick:function(){f(n.current,null,(function(){}))},children:Object(b.jsx)(g.a,{})})})};v.defaultProps={mapId:void 0},v.__docgenInfo={description:"Renders a button that will create a PDF version of the current map view (dimensions adjusted to fit Din A4 Paper).\n\n@component",methods:[],displayName:"MlCreatePdfButton",props:{mapId:{defaultValue:{value:"undefined",computed:!0},type:{name:"string"},required:!1,description:"Id of the target MapLibre instance in mapContext"}}};var y=v;"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/MlCreatePdfButton/MlCreatePdfButton.js"]={name:"MlCreatePdfButton",docgenInfo:v.__docgenInfo,path:"src/components/MlCreatePdfButton/MlCreatePdfButton.js"});var j=r(95),O=r(42),x={title:"MapComponents/MlCreatePdfButton",component:y,argTypes:{options:{control:{type:"object"}}},decorators:O.a},S=(t.default=x,function(e){return Object(b.jsx)(j.a,{children:Object(b.jsx)(y,{})})}.bind({}));S.parameters=Object(n.a)({storySource:{source:"(args) => (\n  <TopToolbar>\n    <MlCreatePdfButton />\n  </TopToolbar>\n)"}},S.parameters)},1470:function(e,t,r){"use strict";r.r(t),r.d(t,"ExampleConfig",(function(){return x}));var n=r(6),o=r(0),a=r.n(o),i=r(95),s=r(21),c=r(29),u=r(745),l=r(178),p=r.n(l),d=r(8),f=function(){function e(e){d.B.call(this,e),this.dracoLoader=null,this.ktx2Loader=null,this.meshoptDecoder=null,this.pluginCallbacks=[],this.register((function(e){return new a(e)})),this.register((function(e){return new s(e)})),this.register((function(e){return new c(e)})),this.register((function(e){return new i(e)})),this.register((function(e){return new n(e)})),this.register((function(e){return new u(e)}))}function t(){var e={};return{get:function(t){return e[t]},add:function(t,r){e[t]=r},remove:function(t){delete e[t]},removeAll:function(){e={}}}}e.prototype=Object.assign(Object.create(d.B.prototype),{constructor:e,load:function(e,t,r,n){var o,a=this;o=""!==this.resourcePath?this.resourcePath:""!==this.path?this.path:d.C.extractUrlBase(e),this.manager.itemStart(e);var i=function(t){n?n(t):console.error(t),a.manager.itemError(e),a.manager.itemEnd(e)},s=new d.l(this.manager);s.setPath(this.path),s.setResponseType("arraybuffer"),s.setRequestHeader(this.requestHeader),s.setWithCredentials(this.withCredentials),s.load(e,(function(r){try{a.parse(r,o,(function(r){t(r),a.manager.itemEnd(e)}),i)}catch(e){i(e)}}),r,i)},setDRACOLoader:function(e){return this.dracoLoader=e,this},setDDSLoader:function(){throw new Error('THREE.GLTFLoader: "MSFT_texture_dds" no longer supported. Please update to "KHR_texture_basisu".')},setKTX2Loader:function(e){return this.ktx2Loader=e,this},setMeshoptDecoder:function(e){return this.meshoptDecoder=e,this},register:function(e){return-1===this.pluginCallbacks.indexOf(e)&&this.pluginCallbacks.push(e),this},unregister:function(e){return-1!==this.pluginCallbacks.indexOf(e)&&this.pluginCallbacks.splice(this.pluginCallbacks.indexOf(e),1),this},parse:function(e,t,n,a){var i,s={},c={};if("string"==typeof e)i=e;else if(d.C.decodeText(new Uint8Array(e,0,4))===l){try{s[r.KHR_BINARY_GLTF]=new m(e)}catch(e){return void(a&&a(e))}i=s[r.KHR_BINARY_GLTF].content}else i=d.C.decodeText(new Uint8Array(e));var u=JSON.parse(i);if(void 0===u.asset||u.asset.version[0]<2)a&&a(new Error("THREE.GLTFLoader: Unsupported asset. glTF versions >=2.0 are supported."));else{var p=new z(u,{path:t||this.resourcePath||"",crossOrigin:this.crossOrigin,requestHeader:this.requestHeader,manager:this.manager,ktx2Loader:this.ktx2Loader,meshoptDecoder:this.meshoptDecoder});p.fileLoader.setRequestHeader(this.requestHeader);for(var f=0;f<this.pluginCallbacks.length;f++){var b=this.pluginCallbacks[f](p);c[b.name]=b,s[b.name]=!0}if(u.extensionsUsed)for(f=0;f<u.extensionsUsed.length;++f){var j=u.extensionsUsed[f],O=u.extensionsRequired||[];switch(j){case r.KHR_MATERIALS_UNLIT:s[j]=new o;break;case r.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS:s[j]=new v;break;case r.KHR_DRACO_MESH_COMPRESSION:s[j]=new g(u,this.dracoLoader);break;case r.KHR_TEXTURE_TRANSFORM:s[j]=new h;break;case r.KHR_MESH_QUANTIZATION:s[j]=new y;break;default:O.indexOf(j)>=0&&void 0===c[j]&&console.warn('THREE.GLTFLoader: Unknown extension "'+j+'".')}}p.setExtensions(s),p.setPlugins(c),p.parse(n,a)}}});var r={KHR_BINARY_GLTF:"KHR_binary_glTF",KHR_DRACO_MESH_COMPRESSION:"KHR_draco_mesh_compression",KHR_LIGHTS_PUNCTUAL:"KHR_lights_punctual",KHR_MATERIALS_CLEARCOAT:"KHR_materials_clearcoat",KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS:"KHR_materials_pbrSpecularGlossiness",KHR_MATERIALS_TRANSMISSION:"KHR_materials_transmission",KHR_MATERIALS_UNLIT:"KHR_materials_unlit",KHR_TEXTURE_BASISU:"KHR_texture_basisu",KHR_TEXTURE_TRANSFORM:"KHR_texture_transform",KHR_MESH_QUANTIZATION:"KHR_mesh_quantization",EXT_TEXTURE_WEBP:"EXT_texture_webp",EXT_MESHOPT_COMPRESSION:"EXT_meshopt_compression"};function n(e){this.parser=e,this.name=r.KHR_LIGHTS_PUNCTUAL,this.cache={refs:{},uses:{}}}function o(){this.name=r.KHR_MATERIALS_UNLIT}function a(e){this.parser=e,this.name=r.KHR_MATERIALS_CLEARCOAT}function i(e){this.parser=e,this.name=r.KHR_MATERIALS_TRANSMISSION}function s(e){this.parser=e,this.name=r.KHR_TEXTURE_BASISU}function c(e){this.parser=e,this.name=r.EXT_TEXTURE_WEBP,this.isSupported=null}function u(e){this.name=r.EXT_MESHOPT_COMPRESSION,this.parser=e}n.prototype._markDefs=function(){for(var e=this.parser,t=this.parser.json.nodes||[],r=0,n=t.length;r<n;r++){var o=t[r];o.extensions&&o.extensions[this.name]&&void 0!==o.extensions[this.name].light&&e._addNodeRef(this.cache,o.extensions[this.name].light)}},n.prototype._loadLight=function(e){var t=this.parser,r="light:"+e,n=t.cache.get(r);if(n)return n;var o,a=t.json,i=((a.extensions&&a.extensions[this.name]||{}).lights||[])[e],s=new d.i(16777215);void 0!==i.color&&s.fromArray(i.color);var c=void 0!==i.range?i.range:0;switch(i.type){case"directional":(o=new d.j(s)).target.position.set(0,0,-1),o.add(o.target);break;case"point":(o=new d.S(s)).distance=c;break;case"spot":(o=new d.db(s)).distance=c,i.spot=i.spot||{},i.spot.innerConeAngle=void 0!==i.spot.innerConeAngle?i.spot.innerConeAngle:0,i.spot.outerConeAngle=void 0!==i.spot.outerConeAngle?i.spot.outerConeAngle:Math.PI/4,o.angle=i.spot.outerConeAngle,o.penumbra=1-i.spot.innerConeAngle/i.spot.outerConeAngle,o.target.position.set(0,0,-1),o.add(o.target);break;default:throw new Error("THREE.GLTFLoader: Unexpected light type: "+i.type)}return o.position.set(0,0,0),o.decay=2,void 0!==i.intensity&&(o.intensity=i.intensity),o.name=t.createUniqueName(i.name||"light_"+e),n=Promise.resolve(o),t.cache.add(r,n),n},n.prototype.createNodeAttachment=function(e){var t=this,r=this.parser,n=r.json.nodes[e],o=(n.extensions&&n.extensions[this.name]||{}).light;return void 0===o?null:this._loadLight(o).then((function(e){return r._getNodeRef(t.cache,o,e)}))},o.prototype.getMaterialType=function(){return d.H},o.prototype.extendParams=function(e,t,r){var n=[];e.color=new d.i(1,1,1),e.opacity=1;var o=t.pbrMetallicRoughness;if(o){if(Array.isArray(o.baseColorFactor)){var a=o.baseColorFactor;e.color.fromArray(a),e.opacity=a[3]}void 0!==o.baseColorTexture&&n.push(r.assignTexture(e,"map",o.baseColorTexture))}return Promise.all(n)},a.prototype.getMaterialType=function(e){var t=this.parser.json.materials[e];return t.extensions&&t.extensions[this.name]?d.I:null},a.prototype.extendMaterialParams=function(e,t){var r=this.parser,n=r.json.materials[e];if(!n.extensions||!n.extensions[this.name])return Promise.resolve();var o=[],a=n.extensions[this.name];if(void 0!==a.clearcoatFactor&&(t.clearcoat=a.clearcoatFactor),void 0!==a.clearcoatTexture&&o.push(r.assignTexture(t,"clearcoatMap",a.clearcoatTexture)),void 0!==a.clearcoatRoughnessFactor&&(t.clearcoatRoughness=a.clearcoatRoughnessFactor),void 0!==a.clearcoatRoughnessTexture&&o.push(r.assignTexture(t,"clearcoatRoughnessMap",a.clearcoatRoughnessTexture)),void 0!==a.clearcoatNormalTexture&&(o.push(r.assignTexture(t,"clearcoatNormalMap",a.clearcoatNormalTexture)),void 0!==a.clearcoatNormalTexture.scale)){var i=a.clearcoatNormalTexture.scale;t.clearcoatNormalScale=new d.ib(i,-i)}return Promise.all(o)},i.prototype.getMaterialType=function(e){var t=this.parser.json.materials[e];return t.extensions&&t.extensions[this.name]?d.I:null},i.prototype.extendMaterialParams=function(e,t){var r=this.parser,n=r.json.materials[e];if(!n.extensions||!n.extensions[this.name])return Promise.resolve();var o=[],a=n.extensions[this.name];return void 0!==a.transmissionFactor&&(t.transmission=a.transmissionFactor),void 0!==a.transmissionTexture&&o.push(r.assignTexture(t,"transmissionMap",a.transmissionTexture)),Promise.all(o)},s.prototype.loadTexture=function(e){var t=this.parser,r=t.json,n=r.textures[e];if(!n.extensions||!n.extensions[this.name])return null;var o=n.extensions[this.name],a=r.images[o.source],i=t.options.ktx2Loader;if(!i){if(r.extensionsRequired&&r.extensionsRequired.indexOf(this.name)>=0)throw new Error("THREE.GLTFLoader: setKTX2Loader must be called before loading KTX2 textures");return null}return t.loadTextureImage(e,a,i)},c.prototype.loadTexture=function(e){var t=this.name,r=this.parser,n=r.json,o=n.textures[e];if(!o.extensions||!o.extensions[t])return null;var a=o.extensions[t],i=n.images[a.source],s=r.textureLoader;if(i.uri){var c=r.options.manager.getHandler(i.uri);null!==c&&(s=c)}return this.detectSupport().then((function(o){if(o)return r.loadTextureImage(e,i,s);if(n.extensionsRequired&&n.extensionsRequired.indexOf(t)>=0)throw new Error("THREE.GLTFLoader: WebP required by asset but unsupported.");return r.loadTexture(e)}))},c.prototype.detectSupport=function(){return this.isSupported||(this.isSupported=new Promise((function(e){var t=new Image;t.src="data:image/webp;base64,UklGRiIAAABXRUJQVlA4IBYAAAAwAQCdASoBAAEADsD+JaQAA3AAAAAA",t.onload=t.onerror=function(){e(1===t.height)}}))),this.isSupported},u.prototype.loadBufferView=function(e){var t=this.parser.json,r=t.bufferViews[e];if(r.extensions&&r.extensions[this.name]){var n=r.extensions[this.name],o=this.parser.getDependency("buffer",n.buffer),a=this.parser.options.meshoptDecoder;if(!a||!a.supported){if(t.extensionsRequired&&t.extensionsRequired.indexOf(this.name)>=0)throw new Error("THREE.GLTFLoader: setMeshoptDecoder must be called before loading compressed files");return null}return Promise.all([o,a.ready]).then((function(e){var t=n.byteOffset||0,r=n.byteLength||0,o=n.count,i=n.byteStride,s=new ArrayBuffer(o*i),c=new Uint8Array(e[0],t,r);return a.decodeGltfBuffer(new Uint8Array(s),o,i,c,n.mode,n.filter),s}))}return null};var l="glTF",p=1313821514,f=5130562;function m(e){this.name=r.KHR_BINARY_GLTF,this.content=null,this.body=null;var t=new DataView(e,0,12);if(this.header={magic:d.C.decodeText(new Uint8Array(e.slice(0,4))),version:t.getUint32(4,!0),length:t.getUint32(8,!0)},this.header.magic!==l)throw new Error("THREE.GLTFLoader: Unsupported glTF-Binary header.");if(this.header.version<2)throw new Error("THREE.GLTFLoader: Legacy binary file detected.");for(var n=this.header.length-12,o=new DataView(e,12),a=0;a<n;){var i=o.getUint32(a,!0);a+=4;var s=o.getUint32(a,!0);if(a+=4,s===p){var c=new Uint8Array(e,12+a,i);this.content=d.C.decodeText(c)}else if(s===f){var u=12+a;this.body=e.slice(u,u+i)}a+=i}if(null===this.content)throw new Error("THREE.GLTFLoader: JSON content not found.")}function g(e,t){if(!t)throw new Error("THREE.GLTFLoader: No DRACOLoader instance provided.");this.name=r.KHR_DRACO_MESH_COMPRESSION,this.json=e,this.dracoLoader=t,this.dracoLoader.preload()}function h(){this.name=r.KHR_TEXTURE_TRANSFORM}function b(e){d.J.call(this),this.isGLTFSpecularGlossinessMaterial=!0;var t=["#ifdef USE_SPECULARMAP","\tuniform sampler2D specularMap;","#endif"].join("\n"),r=["#ifdef USE_GLOSSINESSMAP","\tuniform sampler2D glossinessMap;","#endif"].join("\n"),n=["vec3 specularFactor = specular;","#ifdef USE_SPECULARMAP","\tvec4 texelSpecular = texture2D( specularMap, vUv );","\ttexelSpecular = sRGBToLinear( texelSpecular );","\t// reads channel RGB, compatible with a glTF Specular-Glossiness (RGBA) texture","\tspecularFactor *= texelSpecular.rgb;","#endif"].join("\n"),o=["float glossinessFactor = glossiness;","#ifdef USE_GLOSSINESSMAP","\tvec4 texelGlossiness = texture2D( glossinessMap, vUv );","\t// reads channel A, compatible with a glTF Specular-Glossiness (RGBA) texture","\tglossinessFactor *= texelGlossiness.a;","#endif"].join("\n"),a=["PhysicalMaterial material;","material.diffuseColor = diffuseColor.rgb * ( 1. - max( specularFactor.r, max( specularFactor.g, specularFactor.b ) ) );","vec3 dxy = max( abs( dFdx( geometryNormal ) ), abs( dFdy( geometryNormal ) ) );","float geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );","material.specularRoughness = max( 1.0 - glossinessFactor, 0.0525 ); // 0.0525 corresponds to the base mip of a 256 cubemap.","material.specularRoughness += geometryRoughness;","material.specularRoughness = min( material.specularRoughness, 1.0 );","material.specularColor = specularFactor;"].join("\n"),i={specular:{value:(new d.i).setHex(16777215)},glossiness:{value:1},specularMap:{value:null},glossinessMap:{value:null}};this._extraUniforms=i,this.onBeforeCompile=function(e){for(var s in i)e.uniforms[s]=i[s];e.fragmentShader=e.fragmentShader.replace("uniform float roughness;","uniform vec3 specular;").replace("uniform float metalness;","uniform float glossiness;").replace("#include <roughnessmap_pars_fragment>",t).replace("#include <metalnessmap_pars_fragment>",r).replace("#include <roughnessmap_fragment>",n).replace("#include <metalnessmap_fragment>",o).replace("#include <lights_physical_fragment>",a)},Object.defineProperties(this,{specular:{get:function(){return i.specular.value},set:function(e){i.specular.value=e}},specularMap:{get:function(){return i.specularMap.value},set:function(e){i.specularMap.value=e,e?this.defines.USE_SPECULARMAP="":delete this.defines.USE_SPECULARMAP}},glossiness:{get:function(){return i.glossiness.value},set:function(e){i.glossiness.value=e}},glossinessMap:{get:function(){return i.glossinessMap.value},set:function(e){i.glossinessMap.value=e,e?(this.defines.USE_GLOSSINESSMAP="",this.defines.USE_UV=""):(delete this.defines.USE_GLOSSINESSMAP,delete this.defines.USE_UV)}}}),delete this.metalness,delete this.roughness,delete this.metalnessMap,delete this.roughnessMap,this.setValues(e)}function v(){return{name:r.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS,specularGlossinessParams:["color","map","lightMap","lightMapIntensity","aoMap","aoMapIntensity","emissive","emissiveIntensity","emissiveMap","bumpMap","bumpScale","normalMap","normalMapType","displacementMap","displacementScale","displacementBias","specularMap","specular","glossinessMap","glossiness","alphaMap","envMap","envMapIntensity","refractionRatio"],getMaterialType:function(){return b},extendParams:function(e,t,r){var n=t.extensions[this.name];e.color=new d.i(1,1,1),e.opacity=1;var o=[];if(Array.isArray(n.diffuseFactor)){var a=n.diffuseFactor;e.color.fromArray(a),e.opacity=a[3]}if(void 0!==n.diffuseTexture&&o.push(r.assignTexture(e,"map",n.diffuseTexture)),e.emissive=new d.i(0,0,0),e.glossiness=void 0!==n.glossinessFactor?n.glossinessFactor:1,e.specular=new d.i(1,1,1),Array.isArray(n.specularFactor)&&e.specular.fromArray(n.specularFactor),void 0!==n.specularGlossinessTexture){var i=n.specularGlossinessTexture;o.push(r.assignTexture(e,"glossinessMap",i)),o.push(r.assignTexture(e,"specularMap",i))}return Promise.all(o)},createMaterial:function(e){var t=new b(e);return t.fog=!0,t.color=e.color,t.map=void 0===e.map?null:e.map,t.lightMap=null,t.lightMapIntensity=1,t.aoMap=void 0===e.aoMap?null:e.aoMap,t.aoMapIntensity=1,t.emissive=e.emissive,t.emissiveIntensity=1,t.emissiveMap=void 0===e.emissiveMap?null:e.emissiveMap,t.bumpMap=void 0===e.bumpMap?null:e.bumpMap,t.bumpScale=1,t.normalMap=void 0===e.normalMap?null:e.normalMap,t.normalMapType=d.eb,e.normalScale&&(t.normalScale=e.normalScale),t.displacementMap=null,t.displacementScale=1,t.displacementBias=0,t.specularMap=void 0===e.specularMap?null:e.specularMap,t.specular=e.specular,t.glossinessMap=void 0===e.glossinessMap?null:e.glossinessMap,t.glossiness=e.glossiness,t.alphaMap=null,t.envMap=void 0===e.envMap?null:e.envMap,t.envMapIntensity=1,t.refractionRatio=.98,t}}}function y(){this.name=r.KHR_MESH_QUANTIZATION}function j(e,t,r,n){d.r.call(this,e,t,r,n)}g.prototype.decodePrimitive=function(e,t){var r=this.json,n=this.dracoLoader,o=e.extensions[this.name].bufferView,a=e.extensions[this.name].attributes,i={},s={},c={},u=void 0;for(var l in a)u=_[l]||l.toLowerCase(),i[u]=a[l];for(l in e.attributes)if(u=_[l]||l.toLowerCase(),void 0!==a[l]){var p=r.accessors[e.attributes[l]],d=L[p.componentType];c[u]=d,s[u]=!0===p.normalized}return t.getDependency("bufferView",o).then((function(e){return new Promise((function(t){n.decodeDracoFile(e,(function(e){for(var r in e.attributes){var n=e.attributes[r],o=s[r];void 0!==o&&(n.normalized=o)}t(e)}),i,c)}))}))},h.prototype.extendTexture=function(e,t){return e=e.clone(),void 0!==t.offset&&e.offset.fromArray(t.offset),void 0!==t.rotation&&(e.rotation=t.rotation),void 0!==t.scale&&e.repeat.fromArray(t.scale),void 0!==t.texCoord&&console.warn('THREE.GLTFLoader: Custom UV sets in "'+this.name+'" extension not yet supported.'),e.needsUpdate=!0,e},b.prototype=Object.create(d.J.prototype),b.prototype.constructor=b,b.prototype.copy=function(e){return d.J.prototype.copy.call(this,e),this.specularMap=e.specularMap,this.specular.copy(e.specular),this.glossinessMap=e.glossinessMap,this.glossiness=e.glossiness,delete this.metalness,delete this.roughness,delete this.metalnessMap,delete this.roughnessMap,this},j.prototype=Object.create(d.r.prototype),j.prototype.constructor=j,j.prototype.copySampleValue_=function(e){for(var t=this.resultBuffer,r=this.sampleValues,n=this.valueSize,o=e*n*3+n,a=0;a!==n;a++)t[a]=r[o+a];return t},j.prototype.beforeStart_=j.prototype.copySampleValue_,j.prototype.afterEnd_=j.prototype.copySampleValue_,j.prototype.interpolate_=function(e,t,r,n){for(var o=this.resultBuffer,a=this.sampleValues,i=this.valueSize,s=2*i,c=3*i,u=n-t,l=(r-t)/u,p=l*l,d=p*l,f=e*c,m=f-c,g=-2*d+3*p,h=d-p,b=1-g,v=h-p+l,y=0;y!==i;y++){var j=a[m+y+i],O=a[m+y+s]*u,x=a[f+y+i],S=a[f+y]*u;o[y]=b*j+v*O+g*x+h*S}return o};var O=0,x=1,S=2,M=3,C=4,w=5,E=6,L={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array},I={9728:d.L,9729:d.y,9984:d.N,9985:d.A,9986:d.M,9987:d.z},T={33071:d.h,33648:d.K,10497:d.Y},R={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},_={POSITION:"position",NORMAL:"normal",TANGENT:"tangent",TEXCOORD_0:"uv",TEXCOORD_1:"uv2",COLOR_0:"color",WEIGHTS_0:"skinWeight",JOINTS_0:"skinIndex"},A={scale:"scale",translation:"position",rotation:"quaternion",weights:"morphTargetInfluences"},P={CUBICSPLINE:void 0,LINEAR:d.t,STEP:d.s},k="OPAQUE",H="MASK",F="BLEND";function N(e,t){return"string"!=typeof e||""===e?"":(/^https?:\/\//i.test(t)&&/^\//.test(e)&&(t=t.replace(/(^https?:\/\/[^/]+).*/i,"$1")),/^(https?:)?\/\//i.test(e)||/^data:.*,.*$/i.test(e)||/^blob:.*$/i.test(e)?e:t+e)}function U(e,t,r){for(var n in r.extensions)void 0===e[n]&&(t.userData.gltfExtensions=t.userData.gltfExtensions||{},t.userData.gltfExtensions[n]=r.extensions[n])}function B(e,t){void 0!==t.extras&&("object"==typeof t.extras?Object.assign(e.userData,t.extras):console.warn("THREE.GLTFLoader: Ignoring primitive type .extras, "+t.extras))}function G(e,t){e.updateMorphTargets();var r,n=void 0;if(void 0!==t.weights)for(r=0,n=t.weights.length;r<n;r++)e.morphTargetInfluences[r]=t.weights[r];if(t.extras&&Array.isArray(t.extras.targetNames)){var o=t.extras.targetNames;if(e.morphTargetInfluences.length===o.length)for(e.morphTargetDictionary={},r=0,n=o.length;r<n;r++)e.morphTargetDictionary[o[r]]=r;else console.warn("THREE.GLTFLoader: Invalid extras.targetNames length. Ignoring names.")}}function D(e){for(var t="",r=Object.keys(e).sort(),n=0,o=r.length;n<o;n++)t+=r[n]+":"+e[r[n]]+";";return t}function z(e,r){this.json=e||{},this.extensions={},this.plugins={},this.options=r||{},this.cache=new t,this.associations=new Map,this.primitiveCache={},this.meshCache={refs:{},uses:{}},this.cameraCache={refs:{},uses:{}},this.lightCache={refs:{},uses:{}},this.nodeNamesUsed={},"undefined"!=typeof createImageBitmap&&!1===/Firefox/.test(navigator.userAgent)?this.textureLoader=new d.o(this.options.manager):this.textureLoader=new d.fb(this.options.manager),this.textureLoader.setCrossOrigin(this.options.crossOrigin),this.textureLoader.setRequestHeader(this.options.requestHeader),this.fileLoader=new d.l(this.options.manager),this.fileLoader.setResponseType("arraybuffer"),"use-credentials"===this.options.crossOrigin&&this.fileLoader.setWithCredentials(!0)}function q(e,t,r){var n=t.attributes,o=[];function a(t,n){return r.getDependency("accessor",t).then((function(t){e.setAttribute(n,t)}))}for(var i in n){var s=_[i]||i.toLowerCase();s in e.attributes||o.push(a(n[i],s))}if(void 0!==t.indices&&!e.index){var c=r.getDependency("accessor",t.indices).then((function(t){e.setIndex(t)}));o.push(c)}return B(e,t),function(e,t,r){var n,o,a=t.attributes,i=new d.c,s=void 0;if(void 0!==a.POSITION)if(o=(n=r.json.accessors[a.POSITION]).min,s=n.max,void 0!==o&&void 0!==s){i.set(new d.jb(o[0],o[1],o[2]),new d.jb(s[0],s[1],s[2]));var c=t.targets;if(void 0!==c){for(var u=new d.jb,l=new d.jb,p=0,f=c.length;p<f;p++){var m=c[p];void 0!==m.POSITION&&(o=(n=r.json.accessors[m.POSITION]).min,s=n.max,void 0!==o&&void 0!==s?(l.setX(Math.max(Math.abs(o[0]),Math.abs(s[0]))),l.setY(Math.max(Math.abs(o[1]),Math.abs(s[1]))),l.setZ(Math.max(Math.abs(o[2]),Math.abs(s[2]))),u.max(l)):console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION."))}i.expandByVector(u)}e.boundingBox=i;var g=new d.cb;i.getCenter(g.center),g.radius=i.min.distanceTo(i.max)/2,e.boundingSphere=g}else console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.")}(e,t,r),Promise.all(o).then((function(){return void 0!==t.targets?function(e,t,r){for(var n=!1,o=!1,a=void 0,i=0,s=t.length;i<s&&(void 0!==(a=t[i]).POSITION&&(n=!0),void 0!==a.NORMAL&&(o=!0),!n||!o);i++);if(!n&&!o)return Promise.resolve(e);var c=[],u=[];for(i=0,s=t.length;i<s;i++){a=t[i];var l=void 0;n&&(l=void 0!==a.POSITION?r.getDependency("accessor",a.POSITION):e.attributes.position,c.push(l)),o&&(l=void 0!==a.NORMAL?r.getDependency("accessor",a.NORMAL):e.attributes.normal,u.push(l))}return Promise.all([Promise.all(c),Promise.all(u)]).then((function(t){var r=t[0],a=t[1];return n&&(e.morphAttributes.position=r),o&&(e.morphAttributes.normal=a),e.morphTargetsRelative=!0,e}))}(e,t.targets,r):e}))}function V(e,t){var r=e.getIndex(),n=void 0;if(null===r){var o=[],a=e.getAttribute("position");if(void 0===a)return console.error("THREE.GLTFLoader.toTrianglesDrawMode(): Undefined position attribute. Processing not possible."),e;for(n=0;n<a.count;n++)o.push(n);e.setIndex(o),r=e.getIndex()}var i=r.count-2,s=[];if(t===d.gb)for(n=1;n<=i;n++)s.push(r.getX(0)),s.push(r.getX(n)),s.push(r.getX(n+1));else for(n=0;n<i;n++)n%2==0?(s.push(r.getX(n)),s.push(r.getX(n+1)),s.push(r.getX(n+2))):(s.push(r.getX(n+2)),s.push(r.getX(n+1)),s.push(r.getX(n)));s.length/3!==i&&console.error("THREE.GLTFLoader.toTrianglesDrawMode(): Unable to generate correct amount of triangles.");var c=e.clone();return c.setIndex(s),c}return z.prototype.setExtensions=function(e){this.extensions=e},z.prototype.setPlugins=function(e){this.plugins=e},z.prototype.parse=function(e,t){var r=this,n=this.json,o=this.extensions;this.cache.removeAll(),this._invokeAll((function(e){return e._markDefs&&e._markDefs()})),Promise.all(this._invokeAll((function(e){return e.beforeRoot&&e.beforeRoot()}))).then((function(){return Promise.all([r.getDependencies("scene"),r.getDependencies("animation"),r.getDependencies("camera")])})).then((function(t){var a={scene:t[0][n.scene||0],scenes:t[0],animations:t[1],cameras:t[2],asset:n.asset,parser:r,userData:{}};U(o,a,n),B(a,n),Promise.all(r._invokeAll((function(e){return e.afterRoot&&e.afterRoot(a)}))).then((function(){e(a)}))})).catch(t)},z.prototype._markDefs=function(){for(var e=this.json.nodes||[],t=this.json.skins||[],r=this.json.meshes||[],n=0,o=t.length;n<o;n++)for(var a=t[n].joints,i=0,s=a.length;i<s;i++)e[a[i]].isBone=!0;for(var c=0,u=e.length;c<u;c++){var l=e[c];void 0!==l.mesh&&(this._addNodeRef(this.meshCache,l.mesh),void 0!==l.skin&&(r[l.mesh].isSkinnedMesh=!0)),void 0!==l.camera&&this._addNodeRef(this.cameraCache,l.camera)}},z.prototype._addNodeRef=function(e,t){void 0!==t&&(void 0===e.refs[t]&&(e.refs[t]=e.uses[t]=0),e.refs[t]++)},z.prototype._getNodeRef=function(e,t,r){if(e.refs[t]<=1)return r;var n=r.clone();return n.name+="_instance_"+e.uses[t]++,n},z.prototype._invokeOne=function(e){var t=Object.values(this.plugins);t.push(this);for(var r=0;r<t.length;r++){var n=e(t[r]);if(n)return n}},z.prototype._invokeAll=function(e){var t=Object.values(this.plugins);t.unshift(this);for(var r=[],n=0;n<t.length;n++){var o=e(t[n]);o&&r.push(o)}return r},z.prototype.getDependency=function(e,t){var r=e+":"+t,n=this.cache.get(r);if(!n){switch(e){case"scene":n=this.loadScene(t);break;case"node":n=this.loadNode(t);break;case"mesh":n=this._invokeOne((function(e){return e.loadMesh&&e.loadMesh(t)}));break;case"accessor":n=this.loadAccessor(t);break;case"bufferView":n=this._invokeOne((function(e){return e.loadBufferView&&e.loadBufferView(t)}));break;case"buffer":n=this.loadBuffer(t);break;case"material":n=this._invokeOne((function(e){return e.loadMaterial&&e.loadMaterial(t)}));break;case"texture":n=this._invokeOne((function(e){return e.loadTexture&&e.loadTexture(t)}));break;case"skin":n=this.loadSkin(t);break;case"animation":n=this.loadAnimation(t);break;case"camera":n=this.loadCamera(t);break;default:throw new Error("Unknown type: "+e)}this.cache.add(r,n)}return n},z.prototype.getDependencies=function(e){var t=this.cache.get(e);if(!t){var r=this,n=this.json[e+("mesh"===e?"es":"s")]||[];t=Promise.all(n.map((function(t,n){return r.getDependency(e,n)}))),this.cache.add(e,t)}return t},z.prototype.loadBuffer=function(e){var t=this.json.buffers[e],n=this.fileLoader;if(t.type&&"arraybuffer"!==t.type)throw new Error("THREE.GLTFLoader: "+t.type+" buffer type is not supported.");if(void 0===t.uri&&0===e)return Promise.resolve(this.extensions[r.KHR_BINARY_GLTF].body);var o=this.options;return new Promise((function(e,r){n.load(N(t.uri,o.path),e,void 0,(function(){r(new Error('THREE.GLTFLoader: Failed to load buffer "'+t.uri+'".'))}))}))},z.prototype.loadBufferView=function(e){var t=this.json.bufferViews[e];return this.getDependency("buffer",t.buffer).then((function(e){var r=t.byteLength||0,n=t.byteOffset||0;return e.slice(n,n+r)}))},z.prototype.loadAccessor=function(e){var t=this,r=this.json,n=this.json.accessors[e];if(void 0===n.bufferView&&void 0===n.sparse)return Promise.resolve(null);var o=[];return void 0!==n.bufferView?o.push(this.getDependency("bufferView",n.bufferView)):o.push(null),void 0!==n.sparse&&(o.push(this.getDependency("bufferView",n.sparse.indices.bufferView)),o.push(this.getDependency("bufferView",n.sparse.values.bufferView))),Promise.all(o).then((function(e){var o,a,i=e[0],s=R[n.type],c=L[n.componentType],u=c.BYTES_PER_ELEMENT,l=u*s,p=n.byteOffset||0,f=void 0!==n.bufferView?r.bufferViews[n.bufferView].byteStride:void 0,m=!0===n.normalized;if(f&&f!==l){var g=Math.floor(p/f),h="InterleavedBuffer:"+n.bufferView+":"+n.componentType+":"+g+":"+n.count,b=t.cache.get(h);b||(o=new c(i,g*f,n.count*f/u),b=new d.p(o,f/u),t.cache.add(h,b)),a=new d.q(b,s,p%f/u,m)}else o=null===i?new c(n.count*s):new c(i,p,n.count*s),a=new d.d(o,s,m);if(void 0!==n.sparse){var v=R.SCALAR,y=L[n.sparse.indices.componentType],j=n.sparse.indices.byteOffset||0,O=n.sparse.values.byteOffset||0,x=new y(e[1],j,n.sparse.count*v),S=new c(e[2],O,n.sparse.count*s);null!==i&&(a=new d.d(a.array.slice(),a.itemSize,a.normalized));for(var M=0,C=x.length;M<C;M++){var w=x[M];if(a.setX(w,S[M*s]),s>=2&&a.setY(w,S[M*s+1]),s>=3&&a.setZ(w,S[M*s+2]),s>=4&&a.setW(w,S[M*s+3]),s>=5)throw new Error("THREE.GLTFLoader: Unsupported itemSize in sparse BufferAttribute.")}}return a}))},z.prototype.loadTexture=function(e){var t=this.json,r=this.options,n=t.textures[e],o=t.images[n.source],a=this.textureLoader;if(o.uri){var i=r.manager.getHandler(o.uri);null!==i&&(a=i)}return this.loadTextureImage(e,o,a)},z.prototype.loadTextureImage=function(e,t,r){var n=this,o=this.json,a=this.options,i=o.textures[e],s=this.URL||this.webkitURL,c=t.uri,u=!1,l=!0;if("image/jpeg"===t.mimeType&&(l=!1),void 0!==t.bufferView)c=n.getDependency("bufferView",t.bufferView).then((function(e){if("image/png"===t.mimeType){var r=new DataView(e,25,1).getUint8(0,!1);l=6===r||4===r||3===r}u=!0;var n=new Blob([e],{type:t.mimeType});return c=s.createObjectURL(n)}));else if(void 0===t.uri)throw new Error("THREE.GLTFLoader: Image "+e+" is missing URI and bufferView");return Promise.resolve(c).then((function(e){return new Promise((function(t,n){var o=t;!0===r.isImageBitmapLoader&&(o=function(e){t(new d.g(e))}),r.load(N(e,a.path),o,void 0,n)}))})).then((function(t){!0===u&&s.revokeObjectURL(c),t.flipY=!1,i.name&&(t.name=i.name),l||(t.format=d.X);var r=(o.samplers||{})[i.sampler]||{};return t.magFilter=I[r.magFilter]||d.y,t.minFilter=I[r.minFilter]||d.z,t.wrapS=T[r.wrapS]||d.Y,t.wrapT=T[r.wrapT]||d.Y,n.associations.set(t,{type:"textures",index:e}),t}))},z.prototype.assignTexture=function(e,t,n){var o=this;return this.getDependency("texture",n.index).then((function(a){if(void 0===n.texCoord||0===n.texCoord||"aoMap"===t&&1===n.texCoord||console.warn("THREE.GLTFLoader: Custom UV set "+n.texCoord+" for texture "+t+" not yet supported."),o.extensions[r.KHR_TEXTURE_TRANSFORM]){var i=void 0!==n.extensions?n.extensions[r.KHR_TEXTURE_TRANSFORM]:void 0;if(i){var s=o.associations.get(a);a=o.extensions[r.KHR_TEXTURE_TRANSFORM].extendTexture(a,i),o.associations.set(a,s)}}e[t]=a}))},z.prototype.assignFinalMaterial=function(e){var t=e.geometry,r=e.material,n=void 0!==t.attributes.tangent,o=void 0!==t.attributes.color,a=void 0===t.attributes.normal,i=!0===e.isSkinnedMesh,s=Object.keys(t.morphAttributes).length>0,c=s&&void 0!==t.morphAttributes.normal,u=void 0;if(e.isPoints){u="PointsMaterial:"+r.uuid;var l=this.cache.get(u);l||(l=new d.U,d.D.prototype.copy.call(l,r),l.color.copy(r.color),l.map=r.map,l.sizeAttenuation=!1,this.cache.add(u,l)),r=l}else if(e.isLine){u="LineBasicMaterial:"+r.uuid;var p=this.cache.get(u);p||(p=new d.v,d.D.prototype.copy.call(p,r),p.color.copy(r.color),this.cache.add(u,p)),r=p}if(n||o||a||i||s){u="ClonedMaterial:"+r.uuid+":",r.isGLTFSpecularGlossinessMaterial&&(u+="specular-glossiness:"),i&&(u+="skinning:"),n&&(u+="vertex-tangents:"),o&&(u+="vertex-colors:"),a&&(u+="flat-shading:"),s&&(u+="morph-targets:"),c&&(u+="morph-normals:");var f=this.cache.get(u);f||(f=r.clone(),i&&(f.skinning=!0),o&&(f.vertexColors=!0),a&&(f.flatShading=!0),s&&(f.morphTargets=!0),c&&(f.morphNormals=!0),n&&(f.vertexTangents=!0,f.normalScale&&(f.normalScale.y*=-1),f.clearcoatNormalScale&&(f.clearcoatNormalScale.y*=-1)),this.cache.add(u,f),this.associations.set(f,this.associations.get(r))),r=f}r.aoMap&&void 0===t.attributes.uv2&&void 0!==t.attributes.uv&&t.setAttribute("uv2",t.attributes.uv),e.material=r},z.prototype.getMaterialType=function(){return d.J},z.prototype.loadMaterial=function(e){var t,n=this,o=this.json,a=this.extensions,i=o.materials[e],s={},c=i.extensions||{},u=[];if(c[r.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS]){var l=a[r.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS];t=l.getMaterialType(),u.push(l.extendParams(s,i,n))}else if(c[r.KHR_MATERIALS_UNLIT]){var p=a[r.KHR_MATERIALS_UNLIT];t=p.getMaterialType(),u.push(p.extendParams(s,i,n))}else{var f=i.pbrMetallicRoughness||{};if(s.color=new d.i(1,1,1),s.opacity=1,Array.isArray(f.baseColorFactor)){var m=f.baseColorFactor;s.color.fromArray(m),s.opacity=m[3]}void 0!==f.baseColorTexture&&u.push(n.assignTexture(s,"map",f.baseColorTexture)),s.metalness=void 0!==f.metallicFactor?f.metallicFactor:1,s.roughness=void 0!==f.roughnessFactor?f.roughnessFactor:1,void 0!==f.metallicRoughnessTexture&&(u.push(n.assignTexture(s,"metalnessMap",f.metallicRoughnessTexture)),u.push(n.assignTexture(s,"roughnessMap",f.metallicRoughnessTexture))),t=this._invokeOne((function(t){return t.getMaterialType&&t.getMaterialType(e)})),u.push(Promise.all(this._invokeAll((function(t){return t.extendMaterialParams&&t.extendMaterialParams(e,s)}))))}!0===i.doubleSided&&(s.side=d.k);var g=i.alphaMode||k;return g===F?(s.transparent=!0,s.depthWrite=!1):(s.transparent=!1,g===H&&(s.alphaTest=void 0!==i.alphaCutoff?i.alphaCutoff:.5)),void 0!==i.normalTexture&&t!==d.H&&(u.push(n.assignTexture(s,"normalMap",i.normalTexture)),s.normalScale=new d.ib(1,-1),void 0!==i.normalTexture.scale&&s.normalScale.set(i.normalTexture.scale,-i.normalTexture.scale)),void 0!==i.occlusionTexture&&t!==d.H&&(u.push(n.assignTexture(s,"aoMap",i.occlusionTexture)),void 0!==i.occlusionTexture.strength&&(s.aoMapIntensity=i.occlusionTexture.strength)),void 0!==i.emissiveFactor&&t!==d.H&&(s.emissive=(new d.i).fromArray(i.emissiveFactor)),void 0!==i.emissiveTexture&&t!==d.H&&u.push(n.assignTexture(s,"emissiveMap",i.emissiveTexture)),Promise.all(u).then((function(){var o;return o=t===b?a[r.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS].createMaterial(s):new t(s),i.name&&(o.name=i.name),o.map&&(o.map.encoding=d.mb),o.emissiveMap&&(o.emissiveMap.encoding=d.mb),B(o,i),n.associations.set(o,{type:"materials",index:e}),i.extensions&&U(a,o,i),o}))},z.prototype.createUniqueName=function(e){for(var t=d.V.sanitizeNodeName(e||""),r=t,n=1;this.nodeNamesUsed[r];++n)r=t+"_"+n;return this.nodeNamesUsed[r]=!0,r},z.prototype.loadGeometries=function(e){var t=this,n=this.extensions,o=this.primitiveCache;function a(e){return n[r.KHR_DRACO_MESH_COMPRESSION].decodePrimitive(e,t).then((function(r){return q(r,e,t)}))}for(var i,s,c=[],u=0,l=e.length;u<l;u++){var p,f=e[u],m=(s=void 0,(s=(i=f).extensions&&i.extensions[r.KHR_DRACO_MESH_COMPRESSION])?"draco:"+s.bufferView+":"+s.indices+":"+D(s.attributes):i.indices+":"+D(i.attributes)+":"+i.mode),g=o[m];if(g)c.push(g.promise);else p=f.extensions&&f.extensions[r.KHR_DRACO_MESH_COMPRESSION]?a(f):q(new d.e,f,t),o[m]={primitive:f,promise:p},c.push(p)}return Promise.all(c)},z.prototype.loadMesh=function(e){for(var t,r=this,n=this.json,o=this.extensions,a=n.meshes[e],i=a.primitives,s=[],c=0,u=i.length;c<u;c++){var l=void 0===i[c].material?(void 0===(t=this.cache).DefaultMaterial&&(t.DefaultMaterial=new d.J({color:16777215,emissive:0,metalness:1,roughness:1,transparent:!1,depthTest:!0,side:d.m})),t.DefaultMaterial):this.getDependency("material",i[c].material);s.push(l)}return s.push(r.loadGeometries(i)),Promise.all(s).then((function(t){var n=t.slice(0,t.length-1),s=t[t.length-1],c=[],l=void 0;for(l=0,u=s.length;l<u;l++){var p,f=s[l],m=i[l],g=n[l];if(m.mode===C||m.mode===w||m.mode===E||void 0===m.mode)!0!==(p=!0===a.isSkinnedMesh?new d.bb(f,g):new d.G(f,g)).isSkinnedMesh||p.geometry.attributes.skinWeight.normalized||p.normalizeSkinWeights(),m.mode===w?p.geometry=V(p.geometry,d.hb):m.mode===E&&(p.geometry=V(p.geometry,d.gb));else if(m.mode===x)p=new d.x(f,g);else if(m.mode===M)p=new d.u(f,g);else if(m.mode===S)p=new d.w(f,g);else{if(m.mode!==O)throw new Error("THREE.GLTFLoader: Primitive mode unsupported: "+m.mode);p=new d.T(f,g)}Object.keys(p.geometry.morphAttributes).length>0&&G(p,a),p.name=r.createUniqueName(a.name||"mesh_"+e),B(p,a),m.extensions&&U(o,p,m),r.assignFinalMaterial(p),c.push(p)}if(1===c.length)return c[0];var h=new d.n;for(l=0,u=c.length;l<u;l++)h.add(c[l]);return h}))},z.prototype.loadCamera=function(e){var t,r=this.json.cameras[e],n=r[r.type];if(n)return"perspective"===r.type?t=new d.R(d.E.radToDeg(n.yfov),n.aspectRatio||1,n.znear||1,n.zfar||2e6):"orthographic"===r.type&&(t=new d.Q(-n.xmag,n.xmag,n.ymag,-n.ymag,n.znear,n.zfar)),r.name&&(t.name=this.createUniqueName(r.name)),B(t,r),Promise.resolve(t);console.warn("THREE.GLTFLoader: Missing camera parameters.")},z.prototype.loadSkin=function(e){var t=this.json.skins[e],r={joints:t.joints};return void 0===t.inverseBindMatrices?Promise.resolve(r):this.getDependency("accessor",t.inverseBindMatrices).then((function(e){return r.inverseBindMatrices=e,r}))},z.prototype.loadAnimation=function(e){for(var t=this.json.animations[e],r=[],n=[],o=[],a=[],i=[],s=0,c=t.channels.length;s<c;s++){var u=t.channels[s],l=t.samplers[u.sampler],p=u.target,f=void 0!==p.node?p.node:p.id,m=void 0!==t.parameters?t.parameters[l.input]:l.input,g=void 0!==t.parameters?t.parameters[l.output]:l.output;r.push(this.getDependency("node",f)),n.push(this.getDependency("accessor",m)),o.push(this.getDependency("accessor",g)),a.push(l),i.push(p)}return Promise.all([Promise.all(r),Promise.all(n),Promise.all(o),Promise.all(a),Promise.all(i)]).then((function(r){for(var n=r[0],o=r[1],a=r[2],i=r[3],s=r[4],c=[],u=0,l=n.length;u<l;u++){var p=n[u],f=o[u],m=a[u],g=i[u],h=s[u];if(void 0!==p){var b;switch(p.updateMatrix(),p.matrixAutoUpdate=!0,A[h.path]){case A.weights:b=d.O;break;case A.rotation:b=d.W;break;case A.position:case A.scale:default:b=d.kb}var v=p.name?p.name:p.uuid,y=void 0!==g.interpolation?P[g.interpolation]:d.t,O=[];A[h.path]===A.weights?p.traverse((function(e){!0===e.isMesh&&e.morphTargetInfluences&&O.push(e.name?e.name:e.uuid)})):O.push(v);var x,S=m.array,M=void 0;if(m.normalized){var C;if(S.constructor===Int8Array)C=1/127;else if(S.constructor===Uint8Array)C=1/255;else if(S.constructor===Int16Array)C=1/32767;else{if(S.constructor!==Uint16Array)throw new Error("THREE.GLTFLoader: Unsupported output accessor component type.");C=1/65535}var w=new Float32Array(S.length);for(x=0,M=S.length;x<M;x++)w[x]=S[x]*C;S=w}for(x=0,M=O.length;x<M;x++){var E=new b(O[x]+"."+A[h.path],f.array,S,y);"CUBICSPLINE"===g.interpolation&&(E.createInterpolant=function(e){return new j(this.times,this.values,this.getValueSize()/3,e)},E.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline=!0),c.push(E)}}}var L=t.name?t.name:"animation_"+e;return new d.a(L,void 0,c)}))},z.prototype.loadNode=function(e){var t,r=this.json,n=this.extensions,o=this,a=r.nodes[e],i=a.name?o.createUniqueName(a.name):"";return(t=[],void 0!==a.mesh&&t.push(o.getDependency("mesh",a.mesh).then((function(e){var t=o._getNodeRef(o.meshCache,a.mesh,e);return void 0!==a.weights&&t.traverse((function(e){if(e.isMesh)for(var t=0,r=a.weights.length;t<r;t++)e.morphTargetInfluences[t]=a.weights[t]})),t}))),void 0!==a.camera&&t.push(o.getDependency("camera",a.camera).then((function(e){return o._getNodeRef(o.cameraCache,a.camera,e)}))),o._invokeAll((function(t){return t.createNodeAttachment&&t.createNodeAttachment(e)})).forEach((function(e){t.push(e)})),Promise.all(t)).then((function(t){var r;if((r=!0===a.isBone?new d.b:t.length>1?new d.n:1===t.length?t[0]:new d.P)!==t[0])for(var s=0,c=t.length;s<c;s++)r.add(t[s]);if(a.name&&(r.userData.name=a.name,r.name=i),B(r,a),a.extensions&&U(n,r,a),void 0!==a.matrix){var u=new d.F;u.fromArray(a.matrix),r.applyMatrix4(u)}else void 0!==a.translation&&r.position.fromArray(a.translation),void 0!==a.rotation&&r.quaternion.fromArray(a.rotation),void 0!==a.scale&&r.scale.fromArray(a.scale);return o.associations.set(r,{type:"nodes",index:e}),r}))},z.prototype.loadScene=function(){function e(t,r,n,o){var a=n.nodes[t];return o.getDependency("node",t).then((function(e){return void 0===a.skin?e:o.getDependency("skin",a.skin).then((function(e){for(var r=[],n=0,a=(t=e).joints.length;n<a;n++)r.push(o.getDependency("node",t.joints[n]));return Promise.all(r)})).then((function(r){return e.traverse((function(e){if(e.isMesh){for(var n=[],o=[],a=0,i=r.length;a<i;a++){var s=r[a];if(s){n.push(s);var c=new d.F;void 0!==t.inverseBindMatrices&&c.fromArray(t.inverseBindMatrices.array,16*a),o.push(c)}else console.warn('THREE.GLTFLoader: Joint "%s" could not be found.',t.joints[a])}e.bind(new d.ab(n,o),e.matrixWorld)}})),e}));var t})).then((function(t){r.add(t);var i=[];if(a.children)for(var s=a.children,c=0,u=s.length;c<u;c++){var l=s[c];i.push(e(l,t,n,o))}return Promise.all(i)}))}return function(t){var r=this.json,n=this.extensions,o=this.json.scenes[t],a=new d.n;o.name&&(a.name=this.createUniqueName(o.name)),B(a,o),o.extensions&&U(n,a,o);for(var i=o.nodes||[],s=[],c=0,u=i.length;c<u;c++)s.push(e(i[c],a,r,this));return Promise.all(s).then((function(){return a}))}}(),e}(),m=r(1),g=function(e){var t=Object(o.useContext)(c.b),r=Object(o.useState)(!0),n=Object(s.a)(r,2),a=n[0],i=n[1],l=Object(o.useRef)(!0),g=Object(o.useRef)(!1),h=Object(o.useRef)(null),b=Object(o.useRef)(e.init),v=function(){h.current&&h.current.style&&(h.current.getLayer("3d-model")&&h.current.removeLayer("3d-model"),h.current=null)};return Object(o.useEffect)((function(){return"function"==typeof b.current&&b.current(),v}),[]),Object(o.useEffect)((function(){if(t.mapExists(e.mapId)&&!g.current){g.current=!0,h.current=t.getMap(e.mapId);var r=[Math.PI/2,90,0],n=p.a.MercatorCoordinate.fromLngLat([7.1300753566457304,50.71596191210998],0),o={translateX:n.x+8e-7,translateY:n.y+18e-7,translateZ:n.z,rotateX:r[0],rotateY:r[1],rotateZ:r[2],scale:n.meterInMercatorCoordinateUnits()+3e-8},a={id:"3d-model",type:"custom",renderingMode:"3d",onAdd:function(t,r){this.camera=new d.f,this.scene=new d.Z;var n=new d.j(16777215);n.position.set(0,-70,100).normalize(),this.scene.add(n);var o=new d.j(16777215);o.position.set(0,70,100).normalize(),this.scene.add(o);var a=new f;a.load("/assets/3D/godzilla_simple.glb",function(t){this.scene.add(t.scene),"function"==typeof e.onDone&&e.onDone()}.bind(this)),a.load("/assets/3D/posttower.gltf",function(e){this.scene.add(e.scene)}.bind(this)),this.map=t,this.renderer=new d.lb({canvas:t.getCanvas(),context:r,antialias:!0}),this.renderer.autoClear=!1},render:function(e,t){var r=(new d.F).makeRotationAxis(new d.jb(1,0,0),o.rotateX),n=(new d.F).makeRotationAxis(new d.jb(0,1,0),o.rotateY),a=(new d.F).makeRotationAxis(new d.jb(0,0,1),o.rotateZ),i=(new d.F).fromArray(t),s=(new d.F).makeTranslation(o.translateX,o.translateY,o.translateZ).scale(new d.jb(o.scale,-o.scale,o.scale)).multiply(r).multiply(n).multiply(a);this.camera.projectionMatrix=i.multiply(s),this.renderer.resetState(),this.renderer.render(this.scene,this.camera),this.map.triggerRepaint()}};h.current.addLayer(a),h.current.getLayer("3d-model")&&h.current.setLayoutProperty("3d-model","visibility","visible"),h.current.setCenter([7.130255969902919,50.7143656091998]),h.current.setZoom(15),h.current.setPitch(45)}}),[t.mapIds,t,e]),Object(o.useEffect)((function(){h.current&&h.current.getLayer("3d-model")&&(a?h.current.setLayoutProperty("3d-model","visibility","visible"):h.current.setLayoutProperty("3d-model","visibility","none"))}),[a,t]),Object(m.jsx)(m.Fragment,{children:Object(m.jsx)(u.a,{color:"primary",variant:a?"contained":"outlined",onClick:function(){i(!a),l.current=!a},children:"3D"})})};g.__docgenInfo={description:"Renders obj or gltf 3D Models on the MapLibreMap referenced by props.mapId\n\n@component",methods:[],displayName:"MlThreeJsLayer",props:{mapId:{type:{name:"string"},required:!1,description:"Id of the target MapLibre instance in mapContext"},init:{type:{name:"func"},required:!1,description:"function that gets called when initialized"},onDone:{type:{name:"func"},required:!1,description:"function that gets called when models are loaded"}}};var h=g;"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/MlThreeJsLayer/MlThreeJsLayer.js"]={name:"MlThreeJsLayer",docgenInfo:g.__docgenInfo,path:"src/components/MlThreeJsLayer/MlThreeJsLayer.js"});var b=r(42),v=a.a.createContext({}),y=v.Provider,j=function(e){var t=e.children,r=Object(o.useContext)(c.b),n=Object(o.useState)(!1),a=Object(s.a)(n,2),i=a[0],u=a[1],l=Object(o.useState)(!1),p=Object(s.a)(l,2),d=p[0],f=p[1],g=Object(o.useState)(!0),h=Object(s.a)(g,2),b=h[0],v=h[1],j=Object(o.useState)(!1),O=Object(s.a)(j,2),x=O[0],S=O[1],M=Object(o.useRef)({}),C=Object(o.useState)(0),w=Object(s.a)(C,2),E=w[0],L=w[1],I=function(e){return function(){M.current[e]=!0,L(Math.random())}},T=function(){setTimeout((function(){S(!0),setTimeout((function(){v(!1)}),1700)}),900)};Object(o.useEffect)((function(){if(r.map&&!i){for(var e in M.current)if(!M.current[e])return;T()}}),[E,i,r]),Object(o.useEffect)((function(){for(var e=0,t=r.mapIds.length;e<t;e++)if(-1===Object.keys(M.current).indexOf(r.mapIds[e])){var n=r.mapIds[e]+"";r.getMap(n)&&(M.current[n]=!1,r.getMap(n).on("idle",I(n)))}}),[r,r.mapIds]),Object(o.useEffect)((function(){d&&T()}),[d]);var R={setControlled:u,controlled:i,visible:b,fadeoutAnimation:x,setLoadingDone:f};return Object(m.jsx)(y,{value:R,children:t})};j.__docgenInfo={description:"",methods:[],displayName:"LoadingOverlayProvider",props:{children:{type:{name:"node"},required:!0,description:""}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/ui_components/LoadingOverlayContext.js"]={name:"LoadingOverlayProvider",docgenInfo:j.__docgenInfo,path:"src/ui_components/LoadingOverlayContext.js"});var O={title:"MapComponents/MlThreeJsLayer",component:h,argTypes:{options:{control:{type:"object"}}},decorators:b.a},x=(t.default=O,function(e){var t=Object(o.useContext)(v);return Object(m.jsx)(i.a,{children:Object(m.jsx)(h,{init:function(){var e;return null==t||null===(e=t.setControlled)||void 0===e?void 0:e.call(t,!0)},onDone:function(){return setTimeout((function(){var e;return null==t||null===(e=t.setLoadingDone)||void 0===e?void 0:e.call(t,!0)}),1200)}})})}.bind({}));x.parameters={},x.parameters=Object(n.a)({storySource:{source:"(args) => {\n  const loadingOverlayContext = useContext(LoadingOverlayContext);\n\n  return (\n    <TopToolbar>\n      <MlThreeJsLayer\n        init={() => loadingOverlayContext?.setControlled?.(true)}\n        onDone={() =>\n          setTimeout(() => loadingOverlayContext?.setLoadingDone?.(true), 1200)\n        }\n      />\n    </TopToolbar>\n  );\n}"}},x.parameters)},1471:function(e,t,r){"use strict";r.r(t),r.d(t,"ExampleConfig",(function(){return H}));var n=r(6),o=r(21),a=r(0),i=r(61),s=r(29),c=r(212),u=r(158),l=r(291),p=r(290),d=r(734),f=r.n(d);function m(e){Object(a.useContext)(s.b),Object(a.useRef)(!1);var t=Object(a.useState)(void 0),r=Object(o.a)(t,2),i=r[0],c=r[1],u=Object(a.useState)(e.url),l=Object(o.a)(u,2),p=(l[0],l[1]),d=Object(a.useState)(""),m=Object(o.a)(d,2),g=m[0],h=m[1],b=Object(a.useState)(void 0),v=Object(o.a)(b,2),y=v[0],j=v[1],O=Object(a.useState)(void 0),x=Object(o.a)(O,2),S=x[0],M=x[1],C=function(){c(void 0),j(void 0),h("")};return Object(a.useEffect)((function(){var t;if(C(),M(void 0),e.url){var r,o=e.url;-1!==e.url.indexOf("?")&&(o=(r=e.url.split("?"))[0]);var a=new URLSearchParams(null===(t=r)||void 0===t?void 0:t[1]),i=Object(n.a)(Object(n.a)({},Object.fromEntries(a)),e.urlParameters),s=new URLSearchParams(i),c=decodeURIComponent(s.toString())+"".replace(/%2F/g,"/").replace(/%3A/g,":");fetch(o+"?"+c).then((function(e){if(e.ok)return e.text();throw Error(e.statusText+" ("+e.status+" - "+e.type+")")})).then((function(e){j(new f.a(e).toJSON())})).catch((function(e){C(),console.log(e),M(e.message)}))}}),[e.url,e.urlParameters]),Object(a.useEffect)((function(){var e,t,r,n,o,a,i;(null==y?void 0:y.Service)&&(h(y.Service.OnlineResource),c(null===(e=y.Capability)||void 0===e||null===(t=e.Request)||void 0===t||null===(r=t.GetFeatureInfo)||void 0===r||null===(n=r.DCPType)||void 0===n||null===(o=n[0])||void 0===o||null===(a=o.HTTP)||void 0===a||null===(i=a.Get)||void 0===i?void 0:i.OnlineResource))}),[y]),{capabilities:y,getFeatureInfoUrl:i,wmsUrl:g,error:S,setUrl:p}}m.defaultProps={url:"",urlParameters:{SERVICE:"WMS",VERSION:"1.3.0",REQUEST:"getCapabilities"}};var g=m,h=r(735),b=r.n(h),v=r(736),y=r.n(v),j=r(1503),O=r(1497),x=r(1504),S=r(746),M=r(1),C=2*Math.PI*6378137/2,w=function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{enable:!0,decimal:1},n=e.lng,o=e.lat,a=n*C/180,i=Math.log(Math.tan((90+o)*Math.PI/360))/(Math.PI/180);return i=i*C/180,r.enable&&(a=Number(a.toFixed(r.decimal)),i=Number(i.toFixed(r.decimal))),[a,i]},E=function(e){var t,r,d,f,m,h,v=Object(a.useContext)(s.b),C=g({url:e.url,urlParameters:e.urlParameters}),E=C.capabilities,L=C.error,I=C.setUrl,T=C.getFeatureInfoUrl,R=C.wmsUrl,_=Object(a.useRef)(!1),A=Object(a.useRef)(void 0),P=Object(a.useRef)((e.idPrefix?e.idPrefix:"MlWmsLoader-")+Object(c.a)()),k=Object(a.useState)([]),H=Object(o.a)(k,2),F=H[0],N=H[1],U=Object(a.useState)(void 0),B=Object(o.a)(U,2),G=B[0],D=B[1],z=Object(a.useState)(void 0),q=Object(o.a)(z,2),V=q[0],W=q[1];Object(a.useEffect)((function(){var e=P.current;return function(){A.current&&(A.current.cleanup(e),A.current=void 0),_.current=!1}}),[]),Object(a.useEffect)((function(){I(e.url)}),[e.url]);var K=Object(a.useCallback)((function(t){var r,o,a,i,s;D(void 0),W(void 0);var c,u=A.current.getBounds(),l=w(u._sw),p=w(u._ne),d={REQUEST:"GetFeatureInfo",BBOX:[l[0],l[1],p[0],p[1]].join(","),SERVICE:"WMS",INFO_FORMAT:-1!==(null==E||null===(r=E.Capability)||void 0===r||null===(o=r.Request)||void 0===o?void 0:o.GetFeatureInfo.Format.indexOf("text/html"))?"text/html":"text/plain",FEATURE_COUNT:"10",LAYERS:F.map((function(e,t){return e.visible&&e.queryable?e.Name:void 0})).filter((function(e){return e})),QUERY_LAYERS:F.map((function(e,t){return e.visible&&e.queryable?e.Name:void 0})).filter((function(e){return e})),WIDTH:A.current._container.clientWidth,HEIGHT:A.current._container.clientHeight,srs:"EPSG:3857",CRS:"EPSG:3857",version:"1.3.0",X:t.point.x,Y:t.point.y,I:t.point.x,J:t.point.y,buffer:"50"},f=T;-1!==(null===(a=f)||void 0===a||null===(i=a.indexOf)||void 0===i?void 0:i.call(a,"?"))&&(f=(c=e.url.split("?"))[0]);var m=new URLSearchParams(null===(s=c)||void 0===s?void 0:s[1]),g=Object(n.a)(Object(n.a)({},Object.fromEntries(m)),d),h=new URLSearchParams(g);fetch(e.url+"?"+h.toString()).then((function(e){if(!e.ok)throw new Error("FeatureInfo could not be fetched");return e.text()})).then((function(e){D(t.lngLat),W(e)})).catch((function(e){return console.log(e)}))}),[E,T]);Object(a.useEffect)((function(){if(A.current){var e=K;return A.current.on("click",e,P.current),function(){var t,r;null===(t=A.current)||void 0===t||null===(r=t.off)||void 0===r||r.call(t,"click",e)}}}),[T]);return Object(a.useEffect)((function(){var e,t,r,n,o,a,i,s;(null==E?void 0:E.Service)&&(-1===(null==E||null===(e=E.Capability)||void 0===e||null===(t=e.Layer)||void 0===t||null===(r=t.SRS)||void 0===r||null===(n=r.indexOf)||void 0===n?void 0:n.call(r,"EPSG:3857"))?console.log("MlWmsLoader ("+E.Service.Title+"): No WGS 84/Pseudo-Mercator support"):(console.log("MlWmsLoader ("+E.Service.Title+"): WGS 84/Pseudo-Mercator supported"),N(null==E||null===(o=E.Capability)||void 0===o||null===(a=o.Layer)||void 0===a?void 0:a.Layer.map((function(e,t){var r,n,o;return 0===t&&((s=e.LatLonBoundingBox)||(s=e.EX_GeographicBoundingBox)),e.visible=!((null==E||null===(r=E.Capability)||void 0===r||null===(n=r.Layer)||void 0===n||null===(o=n.Layer)||void 0===o?void 0:o.length)>2)||t>1,e}))),A.current&&(null===(i=s)||void 0===i?void 0:i.length)>3&&A.current.fitBounds([[s[0],s[1]],[s[2],s[3]]])))}),[E]),Object(a.useEffect)((function(){var t;(null==v||null===(t=v.mapExists)||void 0===t?void 0:t.call(v,e.mapId))&&!_.current&&(_.current=!0,A.current=v.getMap(e.mapId))}),[v.mapIds,v,e.mapId]),Object(M.jsxs)(M.Fragment,{children:[L&&Object(M.jsx)("p",{children:L}),Object(M.jsx)("h3",{children:null==E||null===(t=E.Service)||void 0===t?void 0:t.Title},"title"),null==E||null===(r=E.Capability)||void 0===r||null===(d=r.Layer)||void 0===d?void 0:d.Layer.map((function(e,t){return Object(M.jsx)(p.a,Object(n.a)({layerId:"Order-",idSuffix:P.current+"-"+t},t>0?{insertBeforeLayer:"Order-"+P.current+"-"+(t-1)}:void 0),P.current+"-"+t)})),Object(M.jsx)(j.a,{dense:!0,children:R&&(null==F||null===(f=F.map)||void 0===f?void 0:f.call(F,(function(t,r){return(null==t?void 0:t.Name)?Object(M.jsxs)(O.a,{secondaryAction:Object(M.jsx)(S.a,{edge:"end","aria-label":"toggle visibility",onClick:function(){var e=Object(i.a)(F);e[r].visible=!e[r].visible,N(Object(i.a)(e))},children:F[r].visible?Object(M.jsx)(b.a,{}):Object(M.jsx)(y.a,{})}),children:[Object(M.jsx)(x.a,{primary:null==t?void 0:t.Title,secondary:null==t?void 0:t.Abstract}),Object(M.jsx)(u.a,{url:R,urlParameters:Object(n.a)(Object(n.a)({},e.wmsUrlParameters),{},{layers:null==t?void 0:t.Name}),visible:F[r].visible,insertBeforeLayer:"Order-"+P.current+"-"+r},(null==t?void 0:t.Name)+r)]},t.Name+r):Object(M.jsx)(M.Fragment,{})})))},"layers"),Object(M.jsx)("p",{style:{fontSize:".7em"},children:null==E||null===(m=E.Capability)||void 0===m||null===(h=m.Layer)||void 0===h?void 0:h.Abstract},"description"),G&&Object(M.jsx)(l.a,Object(n.a)(Object(n.a)({},G),{},{content:V}))]})};E.defaultProps={url:"",urlParameters:{SERVICE:"WMS",VERSION:"1.3.0",REQUEST:"getCapabilities"},wmsUrlParameters:{TRANSPARENT:"TRUE"}},E.__docgenInfo={description:"Loads a WMS getCapabilities xml document and adds a MlWmsLayer component for each layer that is\noffered by the WMS.\n\nTODO: EaseTo the extend offered by the WMS in a zoom level that is supported\n\n@component",methods:[],displayName:"MlWmsLoader",props:{url:{defaultValue:{value:'""',computed:!1},type:{name:"string"},required:!1,description:"WMS URL"},urlParameters:{defaultValue:{value:'{\n  SERVICE: "WMS",\n  VERSION: "1.3.0",\n  REQUEST: "getCapabilities",\n}',computed:!1},type:{name:"object"},required:!1,description:"URL parameters that will be used in the getCapabilities request"},wmsUrlParameters:{defaultValue:{value:'{\n  TRANSPARENT: "TRUE",\n}',computed:!1},type:{name:"object"},required:!1,description:"URL parameters that will be added when requesting WMS capabilities"},mapId:{type:{name:"string"},required:!1,description:"Id of the target MapLibre instance in mapContext"},layerUrlParameters:{type:{name:"object"},required:!1,description:"URL parameters that will be added when requesting tiles"}}};var L=E;"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/MlWmsLoader/MlWmsLoader.js"]={name:"MlWmsLoader",docgenInfo:E.__docgenInfo,path:"src/components/MlWmsLoader/MlWmsLoader.js"});var I=r(1567),T=r(42),R=r(1496),_=r(1498),A=Object(R.a)((function(e){return{drawer:{flexGrow:1,zIndex:101,position:"absolute",top:0,left:0,bottom:0,backgroundColor:"#fafafa",display:"flex",flexDirection:"column",alignContent:"stretch",alignItems:"stretch"},drawerPaper:{position:"initial",padding:"20px"}}}));function P(e){var t=A();return Object(M.jsx)(_.a,{className:t.drawer,variant:"persistent",anchor:"left",open:!0,classes:{paper:t.drawerPaper},sx:Object(n.a)({},e.sx),children:e.children})}P.__docgenInfo={description:"",methods:[],displayName:"Sidebar"},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/ui_components/Sidebar.js"]={name:"Sidebar",docgenInfo:P.__docgenInfo,path:"src/ui_components/Sidebar.js"});var k={title:"MapComponents/MlWmsLoader",component:L,argTypes:{url:{},layer:{}},decorators:T.a},H=(t.default=k,function(e){var t=Object(a.useState)(""),r=Object(o.a)(t,2),i=r[0],s=r[1];return Object(M.jsx)(M.Fragment,{children:Object(M.jsxs)(P,{sx:{width:"500px",wordBreak:"break-word"},children:[Object(M.jsx)(I.a,{label:"WMS Url",variant:"standard",value:i,onChange:function(e){return s(e.target.value)}}),Object(M.jsx)(L,Object(n.a)(Object(n.a)({},e),{},{url:i}))]})})}.bind({}));H.parameters={},H.args={url:"https://www.wms.nrw.de/geobasis/wms_nw_vdop"},H.parameters=Object(n.a)({storySource:{source:'(props) => {\n  const [url, setUrl] = useState("");\n\n  return (\n    <>\n      <Sidebar sx={{ width: "500px", wordBreak: "break-word" }}>\n        <TextField\n          label="WMS Url"\n          variant="standard"\n          value={url}\n          onChange={(ev) => setUrl(ev.target.value)}\n        />\n        <MlWmsLoader {...props} url={url} />\n      </Sidebar>\n    </>\n  );\n}'}},H.parameters)},1478:function(e,t,r){"use strict";r.r(t);var n={};r.r(n),r.d(n,"parameters",(function(){return i}));var o=r(1573),a=r(13),i=(r(0),r(29),r(159),r(1115),{docs:{inlineStories:!1},actions:{argTypesRegex:"^on[A-Z].*"}});function s(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function c(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}Object.keys(n).forEach((function(e){var t=n[e];switch(e){case"args":case"argTypes":return a.a.warn("Invalid args/argTypes in config, ignoring.",JSON.stringify(t));case"decorators":return t.forEach((function(e){return Object(o.d)(e,!1)}));case"loaders":return t.forEach((function(e){return Object(o.e)(e,!1)}));case"parameters":return Object(o.f)(function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?s(Object(r),!0).forEach((function(t){c(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):s(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({},t),!1);case"argTypesEnhancers":return t.forEach((function(e){return Object(o.b)(e)}));case"argsEnhancers":return t.forEach((function(e){return Object(o.c)(e)}));case"render":return Object(o.g)(t);case"globals":case"globalTypes":var r={};return r[e]=t,Object(o.f)(r,!1);case"decorateStory":case"renderToDOM":return null;default:return console.log(e+" was not supported :( !")}}))},1479:function(e,t,r){"use strict";r.r(t),r.d(t,"ExampleConfig",(function(){return m}));var n=r(6),o=r(0),a=r(3),i=r.n(a),s=r(29),c=r(212),u=r(1),l=function(e){var t=Object(o.useContext)(s.b),r=Object(o.useRef)(!1),n=Object(o.useRef)(void 0),a=Object(o.useRef)((e.idPrefix?e.idPrefix:"MlComponentTemplate-")+Object(c.a)());return Object(o.useEffect)((function(){var e=a.current;return function(){n.current&&(n.current.cleanup(e),n.current=void 0),r.current=!1}}),[]),Object(o.useEffect)((function(){t.mapExists(e.mapId)&&!r.current&&(r.current=!0,n.current=t.getMap(e.mapId),n.current.setCenter([7.132122000552613,50.716405378037706]))}),[t.mapIds,t,e.mapId]),Object(u.jsx)(u.Fragment,{})};l.defaultProps={mapId:void 0},l.propTypes={mapId:i.a.string},l.__docgenInfo={description:"TODO: Add short & useful description\n\n@param {object} props\n@param {string} props.mapId Id of the target MapLibre instance in mapContext\n\n@component",methods:[],displayName:"MlComponentTemplate",props:{mapId:{defaultValue:{value:"undefined",computed:!0},type:{name:"string"},required:!1,description:"Id of the target MapLibre instance in mapContext"}}};var p=l;"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/MlComponentTemplate/MlComponentTemplate.js"]={name:"MlComponentTemplate",docgenInfo:l.__docgenInfo,path:"src/components/MlComponentTemplate/MlComponentTemplate.js"});var d=r(42),f={title:"MapComponents/MlComponentTemplate",component:p,argTypes:{url:{},layer:{}},decorators:d.a},m=(t.default=f,function(e){return Object(u.jsx)(p,{})}.bind({}));m.parameters={},m.args={},m.parameters=Object(n.a)({storySource:{source:"(args) => <MlComponentTemplate />"}},m.parameters)},1480:function(e,t,r){"use strict";r.r(t),r.d(t,"ExampleConfig",(function(){return g}));var n=r(6),o=r(0),a=r(95),i=r(21),s=r(29),c=r(212),u=r(745),l=r(1),p=function(e){var t=Object(o.useContext)(s.b),r=Object(o.useRef)(null),a=Object(o.useState)(!0),p=Object(i.a)(a,2),d=p[0],f=p[1],m=Object(o.useRef)((e.idPrefix?e.idPrefix:"MlFillExtrusionLayer-")+Object(c.a)()),g=Object(o.useRef)(!1),h=Object(o.useRef)(e.layerId||"MlFillExtrusionLayer-"+Object(c.a)());return Object(o.useEffect)((function(){var e=m.current;return function(){r.current&&(r.current.cleanup(e),r.current=void 0),g.current=!1}}),[]),Object(o.useEffect)((function(){if(t.mapExists(e.mapId)&&!g.current){g.current=!0,r.current=t.getMap(e.mapId);var o=void 0;t.map.getLayer("waterway-name")&&(o="waterway-name"),t.map.getLayer("poi_label")&&(o="poi_label"),t.map.addLayer({id:h.current,type:"fill-extrusion",source:e.sourceId||"openmaptiles","source-layer":e.sourceLayer||"building",minzoom:e.minZoom||14,paint:Object(n.a)({},e.paint)},e.insertBeforeLayer||o,m.current)}}),[t,e.insertBeforeLayer,e.mapId,e.minZoom,e.paint,e.sourceId,e.sourceLayer]),Object(o.useEffect)((function(){g.current&&r.current.setLayoutProperty(h.current,"visibility",d?"visible":"none")}),[d,t]),Object(l.jsx)(u.a,{color:"primary",variant:d?"contained":"outlined",onClick:function(){return f(!d)},children:"Composite"})};p.defaultProps={mapId:void 0,paint:{"fill-extrusion-color":"hsl(196, 61%, 83%)","fill-extrusion-height":{property:"render_height",type:"identity"},"fill-extrusion-base":{property:"render_min_height",type:"identity"},"fill-extrusion-opacity":1}},p.__docgenInfo={description:"Adds a fill extrusion layer to the MapLibre instance reference by props.mapId\n\n@Component",methods:[],displayName:"MlFillExtrusionLayer",props:{mapId:{defaultValue:{value:"undefined",computed:!0},type:{name:"string"},required:!1,description:"Id of the target MapLibre instance in mapContext"},paint:{defaultValue:{value:'{\n  "fill-extrusion-color": "hsl(196, 61%, 83%)",\n  "fill-extrusion-height": {\n    property: "render_height",\n    type: "identity",\n  },\n  "fill-extrusion-base": {\n    property: "render_min_height",\n    type: "identity",\n  },\n  "fill-extrusion-opacity": 1,\n}',computed:!1},type:{name:"object"},required:!1,description:"Paint properties of the config object that is passed to the MapLibreGl.addLayer call. All\navailable properties are documented in the MapLibreGl documentation\nhttps://maplibre.org/maplibre-gl-js-docs/style-spec/layers/#fill-extrusion"},layerId:{type:{name:"string"},required:!1,description:"Id of the layer that will be added by this component"},idPrefix:{type:{name:"string"},required:!1,description:"Prefix of the component id this component uses when adding elements to the MapLibreGl-instance"},sourceId:{type:{name:"string"},required:!1,description:"Source id of a vector tile source containing the geometries to use for this fill-extrusion\nlayer.\nhttps://maplibre.org/maplibre-gl-js-docs/style-spec/layers/#source-layer"},sourceLayer:{type:{name:"string"},required:!1,description:"Layer id from a vector tile source containing the geometries to use for this fill-extrusion\nlayer.\nhttps://maplibre.org/maplibre-gl-js-docs/style-spec/layers/#source-layer"},minZoom:{type:{name:"number"},required:!1,description:"This layer will be hidde for zoom levels lower than defined on this property\nhttps://maplibre.org/maplibre-gl-js-docs/style-spec/layers/#minzoom"},insertBeforeLayer:{type:{name:"string"},required:!1,description:'The layerId of an existing layer this layer should be rendered visually beneath\nhttps://maplibre.org/maplibre-gl-js-docs/api/map/#map#addlayer - see "beforeId" property'}}};var d=p;"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/MlFillExtrusionLayer/MlFillExtrusionLayer.js"]={name:"MlFillExtrusionLayer",docgenInfo:p.__docgenInfo,path:"src/components/MlFillExtrusionLayer/MlFillExtrusionLayer.js"});var f=r(42),m={title:"MapComponents/MlFillExtrusionLayer",component:d,argTypes:{options:{control:{type:"object"}}},decorators:f.a},g=(t.default=m,function(e){return Object(l.jsx)(a.a,{children:Object(l.jsx)(d,{})})}.bind({}));g.parameters={},g.parameters=Object(n.a)({storySource:{source:"(args) => (\n  <TopToolbar>\n    <MlFillExtrusionLayer />\n  </TopToolbar>\n)"}},g.parameters)},1481:function(e,t,r){"use strict";r.r(t),r.d(t,"ExampleConfig",(function(){return u}));var n=r(6),o=(r(0),r(288)),a=r(42),i=r.p+"static/media/wg-marker.bf3eeb2d.png",s=r(1),c={title:"MapComponents/MlImageMarkerLayer",component:o.a,argTypes:{url:{},layer:{}},decorators:a.a},u=(t.default=c,function(e){return Object(s.jsx)(o.a,{options:{type:"symbol",source:{type:"geojson",data:{type:"Feature",properties:{id:"test"},geometry:{type:"Point",coordinates:[7.0847929969609424,50.73855193187643]}}},layout:{"icon-allow-overlap":!0,"icon-size":.14,"icon-offset":[0,-180]}},imgSrc:i})}.bind({}));u.parameters={},u.args={},u.parameters=Object(n.a)({storySource:{source:'(args) => (\n  <MlImageMarkerLayer\n    options={{\n      type: "symbol",\n      source: {\n        type: "geojson",\n        data: {\n          type: "Feature",\n          properties: {\n            id: "test",\n          },\n          geometry: {\n            type: "Point",\n            coordinates: [7.0847929969609424, 50.73855193187643],\n          },\n        },\n      },\n      layout: {\n        "icon-allow-overlap": true,\n        "icon-size": 0.14,\n        "icon-offset": [0, -180],\n      },\n    }}\n    imgSrc={wgMarker}\n  />\n)'}},u.parameters)},1482:function(e,t,r){"use strict";r.r(t),r.d(t,"ExampleConfig",(function(){return g}));var n=r(6),o=r(0),a=r(21),i=r(371),s=r.n(i),c=(r(1174),r(29)),u=r(1),l=function(e){var t=Object(o.useContext)(c.b),r=Object(o.useRef)(!1),n=Object(o.useRef)(null),i=Object(o.useState)(50),l=Object(a.a)(i,2),p=l[0],d=l[1],f=Object(o.useRef)(50),m=Object(o.useState)(50),g=Object(a.a)(m,2),h=g[0],b=g[1],v=Object(o.useRef)(50),y=Object(o.useRef)(e.magnifierRadius),j=Object(o.useState)(y.current),O=Object(a.a)(j,2),x=O[0],S=O[1],M=Object(o.useCallback)((function(){return!(!e.map1Id||!e.map2Id)&&!(!t.mapExists(e.map1Id)||!t.mapExists(e.map2Id))}),[e,t]),C=Object(o.useRef)((function(){M()&&w({clientX:f.current,clientY:v.current})}));Object(o.useEffect)((function(){window.addEventListener("resize",C.current);var e=C.current;return function(){window.removeEventListener("resize",e),n.current&&n.current()}}),[]);var w=Object(o.useCallback)((function(r){if(M()){var n=t.maps[e.map1Id].getCanvas().getBoundingClientRect(),o=r.clientX||(void 0!==r.touches&&void 0!==r.touches[0]?r.touches[0].clientX:0),a=r.clientY||(void 0!==r.touches&&void 0!==r.touches[0]?r.touches[0].clientY:0);o-=n.x,a-=n.y;var i=(o/n.width*100).toFixed(2),s=(a/n.height*100).toFixed(2);f.current===i&&v.current===s||(d(i),f.current=i,b(s),v.current=s,t.maps[e.map2Id].getContainer().style.clipPath="circle(".concat(y.current,"px at ")+f.current*n.width/100+"px "+v.current*n.height/100+"px)")}}),[t,M,e]);Object(o.useEffect)((function(){M()&&!r.current&&(r.current=!0,n.current=s()(t.getMap(e.map1Id),t.getMap(e.map2Id)),t.maps[e.map1Id].getCanvas().clientWidth>t.maps[e.map1Id].getCanvas().clientHeight&&2*y.current>t.maps[e.map1Id].getCanvas().clientHeight&&(y.current=Math.floor(t.maps[e.map1Id].getCanvas().clientHeight/2),S(y.current)),t.maps[e.map1Id].getCanvas().clientHeight>t.maps[e.map1Id].getCanvas().clientWidth&&2*y.current>t.maps[e.map1Id].getCanvas().clientWidth&&(y.current=Math.floor(t.maps[e.map1Id].getCanvas().clientWidth/2),S(y.current)),w({clientX:t.maps[e.map1Id].getCanvas().clientWidth/2,clientY:t.maps[e.map1Id].getCanvas().clientHeight/2}))}),[t.mapIds,t,M,e,w]);var E=function(e){e.touches?(document.addEventListener("touchmove",w),document.addEventListener("touchend",L)):(document.addEventListener("mousemove",w),document.addEventListener("mouseup",I))},L=function e(){document.removeEventListener("touchmove",w),document.removeEventListener("touchend",e)},I=function e(){document.removeEventListener("mousemove",w),document.removeEventListener("mouseup",e)};return Object(u.jsx)("div",{style:{position:"absolute",left:p+"%",top:h+"%",borderRadius:"50%",width:2*x+1+"px",height:2*x+1+"px",background:"rgba(0,0,0,0)",border:"2px solid #fafafa",boxShadow:"1px 2px 2px rgba(19, 19, 19, .5), inset 1px 1px 1px rgba(19, 19, 19, .2)",cursor:"pointer",zIndex:"110",marginLeft:-1*x-1+"px",marginTop:-1*x-1+"px",textAlign:"center",lineHeight:"91px",fontSize:"2em",color:"#fafafa",userSelect:"none"},onTouchStart:E,onMouseDown:E,onWheel:function(e){var r=new WheelEvent(e.type,e);t.map.getCanvas().dispatchEvent(r)}})};l.defaultProps={magnifierRadius:200},l.__docgenInfo={description:'Hides the MapLibreMap referenced by props.map2Id except for the "magnifier"-circle that reveals\nthe map and can be dragged around on top of the MapLibreMap referenced by props.map1Id\n\n@component',methods:[],displayName:"MlLayerMagnify",props:{magnifierRadius:{defaultValue:{value:"200",computed:!1},type:{name:"number"},required:!1,description:'Size of the "magnifier"-circle'},map1Id:{type:{name:"string"},required:!1,description:"Id of the first MapLibre instance"},map2Id:{type:{name:"string"},required:!1,description:"Id of the second MapLibre instance"}}};var p=l;"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/MlLayerMagnify/MlLayerMagnify.js"]={name:"MlLayerMagnify",docgenInfo:l.__docgenInfo,path:"src/components/MlLayerMagnify/MlLayerMagnify.js"});var d=r(158),f=r(235),m={title:"MapComponents/MlLayerMagnify",component:p,argTypes:{url:{},layer:{}},decorators:f.a},g=(t.default=m,function(e){return Object(u.jsxs)(u.Fragment,{children:[Object(u.jsx)(d.a,{url:"https://www.wms.nrw.de/geobasis/wms_nw_uraufnahme",urlParameters:{layers:"nw_uraufnahme_rw"},sourceOptions:{minzoom:13,maxzoom:20},mapId:e.wmsLayerMapId}),Object(u.jsx)(p,{map1Id:"map_1",map2Id:"map_2",magnifierRadius:e.magnifierRadius})]})}.bind({}));g.parameters={},g.args={wmsLayerMapId:"map_2",magnifierRadius:200},g.parameters=Object(n.a)({storySource:{source:'(args) => (\n  <>\n    <MlWmsLayer\n      url="https://www.wms.nrw.de/geobasis/wms_nw_uraufnahme"\n      urlParameters={{\n        layers: "nw_uraufnahme_rw",\n      }}\n      sourceOptions={{\n        minzoom: 13,\n        maxzoom: 20,\n      }}\n      mapId={args.wmsLayerMapId}\n    />\n    <MlLayerMagnify map1Id="map_1" map2Id="map_2" magnifierRadius={args.magnifierRadius} />\n  </>\n)'}},g.parameters)},1483:function(e,t,r){"use strict";r.r(t),r.d(t,"ExampleConfig",(function(){return g}));var n=r(6),o=r(0),a=r(21),i=r(371),s=r.n(i),c=(r(1175),r(29)),u=r(1),l=function(e){var t=Object(o.useContext)(c.b),r=Object(o.useRef)(!1),n=Object(o.useState)(50),i=Object(a.a)(n,2),l=i[0],p=i[1],d=Object(o.useRef)(50),f=Object(o.useRef)(null),m=Object(o.useCallback)((function(){return!(!e.map1Id||!e.map2Id)&&!(!t.mapExists(e.map1Id)||!t.mapExists(e.map2Id))}),[t,e.map1Id,e.map2Id]),g=function(){f.current&&f.current()},h=Object(o.useCallback)((function(r){if(m()){var n=t.maps[e.map1Id].getCanvas().getBoundingClientRect(),o=r.clientX||(void 0!==r.touches&&void 0!==r.touches[0]?r.touches[0].clientX:0),a=((o-=n.x)/n.width*100).toFixed(2);if(d.current!==a){p(a),d.current=a;var i="rect(0, "+d.current*n.width/100+"px, 999em, 0)";t.maps[e.map2Id].getContainer().style.clip=i}}}),[t,m,e.map1Id,e.map2Id]);Object(o.useEffect)((function(){return g}),[]),Object(o.useEffect)((function(){m()&&!r.current&&(r.current=!0,f.current=s()(t.getMap(e.map1Id),t.getMap(e.map2Id)),h({clientX:t.maps[e.map1Id].getCanvas().clientWidth/2}))}),[t.mapIds,t,e,h,m]);var b=function(e){e.touches?(document.addEventListener("touchmove",h),document.addEventListener("touchend",v)):(document.addEventListener("mousemove",h),document.addEventListener("mouseup",y))},v=function e(){document.removeEventListener("touchmove",h),document.removeEventListener("touchend",e)},y=function e(){document.removeEventListener("mousemove",h),document.removeEventListener("mouseup",e)};return Object(u.jsx)("div",{style:{position:"absolute",left:l+"%",top:"50%",borderRadius:"50%",width:"100px",height:"100px",background:"#0066ff",border:"3px solid #eaebf1",cursor:"pointer",zIndex:"110",marginLeft:"-50px",marginTop:"-50px",textAlign:"center",lineHeight:"91px",fontSize:"2em",color:"#fafafa",userSelect:"none"},onTouchStart:b,onMouseDown:b})};l.__docgenInfo={description:"MlLayerSwipe returns a Button that will add a standard OSM tile layer to the maplibre-gl instance, that you can move like a curtain.\n\n@component",methods:[],displayName:"MlLayerSwipe",props:{map1Id:{type:{name:"string"},required:!1,description:"Id of the first MapLibre instance."},map2Id:{type:{name:"string"},required:!1,description:"Id of the second MapLibre instance."}}};var p=l;"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/MlLayerSwipe/MlLayerSwipe.js"]={name:"MlLayerSwipe",docgenInfo:l.__docgenInfo,path:"src/components/MlLayerSwipe/MlLayerSwipe.js"});var d=r(158),f=r(235),m={title:"MapComponents/MlLayerSwipe",name:"MlLayerSwipe",component:p,argTypes:{url:{},layer:{}},decorators:f.a},g=(t.default=m,function(e){return Object(u.jsxs)(u.Fragment,{children:[Object(u.jsx)(d.a,{url:"https://www.wms.nrw.de/geobasis/wms_nw_uraufnahme",urlParameters:{layers:"nw_uraufnahme_rw"},sourceOptions:{minzoom:13,maxzoom:20},mapId:"map_2"}),Object(u.jsx)(p,{map1Id:"map_1",map2Id:"map_2"})]})}.bind({}));g.parameters={},g.args={},g.parameters=Object(n.a)({storySource:{source:'(args) => (\n  <>\n    <MlWmsLayer\n      url="https://www.wms.nrw.de/geobasis/wms_nw_uraufnahme"\n      urlParameters={{\n        layers: "nw_uraufnahme_rw",\n      }}\n      sourceOptions={{\n        minzoom: 13,\n        maxzoom: 20,\n      }}\n      mapId="map_2"\n    />\n    <MlLayerSwipe map1Id="map_1" map2Id="map_2" />\n  </>\n)'}},g.parameters)},1484:function(e,t,r){"use strict";r.r(t),r.d(t,"ExampleConfig",(function(){return S}));var n=r(6),o=r(0),a=r(21),i=r(29),s=r(745),c=r(1575),u=r(729),l=r.n(u),p=r(730),d=r.n(p),f=r(728),m=r.n(f),g=r(212),h=r(292),b=r(287),v=r(1),y=function(e){var t=Object(o.useContext)(i.b),r=Object(o.useRef)(!1),u=Object(o.useRef)(void 0),p=Object(o.useRef)((e.idPrefix?e.idPrefix:"MlComponentTemplate-")+Object(g.a)()),f=Object(o.useState)(0),y=Object(a.a)(f,2),j=y[0],O=y[1],x=Object(o.useState)(!1),S=Object(a.a)(x,2),M=S[0],C=S[1],w={minWidth:"30px",minHeight:"30px",width:"30px",height:"30px",color:"#bbb",backgroundColor:"#414141",borderRadius:"23%",margin:.15,":hover":{backgroundColor:"#515151",color:"#ececec"}};Object(o.useEffect)((function(){var e=p.current;return function(){u.current&&(u.current.cleanup(e),u.current=void 0),r.current=!1}}),[]),Object(o.useEffect)((function(){t.mapExists(e.mapId)&&!r.current&&(r.current=!0,u.current=t.getMap(e.mapId),u.current.on("pitchend",(function(){O(u.current.getPitch())}),p.current),O(u.current.getPitch()))}),[t.mapIds,t,e.mapId]);var E=function(e){u.current.setCenter([e.coords.longitude,e.coords.latitude])},L=function(){console.log("Access of user location denied"),C(!0)};return Object(v.jsxs)("div",{style:{zIndex:501,position:"absolute",right:"20px",bottom:"20px",display:"flex",flexDirection:"column"},children:[Object(v.jsx)(h.a,{style:{width:"31px",position:"relative",height:"50px",marginLeft:"-5px"},backgroundStyle:{boxShadow:"0px 0px 18px rgba(0,0,0,.5)"}}),Object(v.jsx)(s.a,{sx:Object(n.a)(Object(n.a)({},w),{},{fontSize:".9em",fontWeight:600}),onClick:function(){if(u.current){var e=60;0!==u.current.getPitch()&&(e=0),u.current.easeTo({pitch:e})}},children:j?"2D":"3D"}),Object(v.jsx)(s.a,{sx:w,onClick:function(){navigator.geolocation.getCurrentPosition(E,L)},disabled:M,children:Object(v.jsx)(m.a,{sx:{width:".9em"}})}),Object(v.jsx)(b.a,{}),Object(v.jsxs)(c.a,{orientation:"vertical",sx:{width:"30px",border:"none",Button:{minWidth:"30px !important",border:"none",padding:0},"Button:hover":{border:"none"}},children:[Object(v.jsx)(s.a,{sx:w,onClick:function(){u.current&&u.current.transform._zoom+.5<=u.current.transform._maxZoom&&u.current.easeTo({zoom:u.current.transform._zoom+.5})},children:Object(v.jsx)(l.a,{})}),Object(v.jsx)(s.a,{sx:w,onClick:function(){u.current&&u.current.transform._zoom-.5>=u.current.transform._minZoom&&u.current.easeTo({zoom:u.current.transform._zoom-.5})},children:Object(v.jsx)(d.a,{})})]})]})};y.__docgenInfo={description:"",methods:[],displayName:"MlNavigationTools"};var j=y;"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/MlNavigationTools/MlNavigationTools.js"]={name:"MlNavigationTools",docgenInfo:y.__docgenInfo,path:"src/components/MlNavigationTools/MlNavigationTools.js"});var O=r(42),x={title:"MapComponents/MlNavigationTools",component:j,argTypes:{url:{},layer:{}},decorators:O.a},S=(t.default=x,function(e){return Object(v.jsx)(j,{})}.bind({}));S.parameters={},S.args={},S.parameters=Object(n.a)({storySource:{source:"(args) => <MlNavigationTools />"}},S.parameters)},1485:function(e,t,r){"use strict";r.r(t),r.d(t,"ExampleConfig",(function(){return g}));var n=r(6),o=r(0),a=r(21),i=r(29),s=r(212),c=r(745),u=r(1),l=function(e){var t=Object(o.useContext)(i.b),r=Object(o.useRef)(void 0),l=Object(o.useState)(!0),p=Object(a.a)(l,2),d=p[0],f=p[1],m=Object(o.useRef)((e.idPrefix?e.idPrefix:"MlOsmLayer-")+Object(s.a)()),g=Object(o.useRef)(!1),h=Object(o.useRef)((e.idPrefix?e.idPrefix:"MlOsmLayer-source-")+Object(s.a)()),b=Object(o.useRef)((e.idPrefix?e.idPrefix:"MlOsmLayer-layer-")+Object(s.a)());return Object(o.useEffect)((function(){var e=m.current;return function(){r.current&&(r.current.cleanup(e),r.current=null)}}),[]),Object(o.useEffect)((function(){t.mapExists(e.mapId)&&!g.current&&(g.current=!0,r.current=t.getMap(e.mapId),r.current.addSource(h.current,Object(n.a)({type:"raster",tileSize:256},e.sourceOptions),m.current),r.current.addLayer(Object(n.a)({id:b.current,type:"raster",source:h.current,minzoom:0,maxzoom:22},e.layerOptions),e.insertBeforeLayer,m.current))}),[t.mapIds,e,t]),Object(o.useEffect)((function(){r.current&&(d?r.current.setLayoutProperty(b.current,"visibility","visible"):r.current.setLayoutProperty(b.current,"visibility","none"))}),[d]),Object(u.jsx)(c.a,{color:"primary",variant:d?"contained":"outlined",onClick:function(){return f(!d)},children:"OSM"})};l.__docgenInfo={description:"Adds a standard OSM tile layer to the maplibre-gl instancereference by\nprops.mapId\n\n@component",methods:[],displayName:"MlOsmLayer",props:{mapId:{type:{name:"string"},required:!1,description:"Id of the target MapLibre instance in mapContext"},idPrefix:{type:{name:"string"},required:!1,description:"Prefix of the component id this component uses when adding elements to the MapLibreGl-instance"},sourceOptions:{type:{name:"object"},required:!1,description:"Options object that will be used as first parameter on the MapLibreGl.addSource call see MapLibre source options documentation."},layerOptions:{type:{name:"object"},required:!1,description:"Options object that will be used as first parameter on the MapLibreGl.addLayer call see MapLibre layer options documentation."},insertBeforeLayer:{type:{name:"string"},required:!1,description:'The layerId of an existing layer this layer should be rendered visually beneath\nhttps://maplibre.org/maplibre-gl-js-docs/api/map/#map#addlayer - see "beforeId" property'}}};var p=l;"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/MlOsmLayer/MlOsmLayer.js"]={name:"MlOsmLayer",docgenInfo:l.__docgenInfo,path:"src/components/MlOsmLayer/MlOsmLayer.js"});var d=r(95),f=r(42),m={title:"MapComponents/MlOsmLayer",component:p,argTypes:{options:{control:{type:"object"}}},decorators:f.a},g=(t.default=m,function(e){return Object(u.jsx)(d.a,{children:Object(u.jsx)(p,Object(n.a)({},e))})}.bind({}));g.args={sourceOptions:{tiles:["https://stamen-tiles.a.ssl.fastly.net/watercolor/{z}/{x}/{y}.jpg"],attribution:'Map tiles by <a target="_top" rel="noopener" href="http://stamen.com">Stamen Design</a>, under <a target="_top" rel="noopener" href="http://creativecommons.org/licenses/by/3.0">CC BY 3.0</a>. Data by <a target="_top" rel="noopener" href="http://openstreetmap.org">OpenStreetMap</a>, under <a target="_top" rel="noopener" href="http://creativecommons.org/licenses/by-sa/3.0">CC BY SA</a>'},layerOptions:{}},g.parameters=Object(n.a)({storySource:{source:"(props) => (\n  <TopToolbar>\n    <MlOsmLayer {...props} />\n  </TopToolbar>\n)"}},g.parameters)},1486:function(e,t,r){"use strict";r.r(t),r.d(t,"Toolbar",(function(){return g})),r.d(t,"Overlay",(function(){return h}));var n=r(6),o=r(0),a=r(21),i=r(29),s=r(212),c=r(1),u=function(e){var t=Object(o.useContext)(i.b),r=Object(o.useRef)(void 0),n=Object(o.useRef)(!1),u=Object(o.useRef)(0),l=Object(o.useRef)((e.idPrefix?e.idPrefix:"MlScaleReference-")+Object(s.a)()),p=Object(o.useState)(0),d=Object(a.a)(p,2),f=d[0],m=d[1],g=Object(o.useState)(""),h=Object(a.a)(g,2),b=h[0],v=h[1];Object(o.useEffect)((function(){var e=l.current;return function(){r.current&&(r.current.cleanup(e),r.current=void 0)}}),[]),Object(o.useEffect)((function(){t.mapExists(e.mapId)&&!n.current&&(n.current=!0,r.current=t.getMap(e.mapId),r.current.on("move",y.current,l.current),y.current())}),[t.mapIds,t,e.mapId]);var y=Object(o.useRef)((function(){if(r.current.map.getZoom()!==u.current){u.current=r.current.map.getZoom();var t=e.maxWidth||100,n=r.current._container.clientHeight/2,o=r.current.unproject([0,n]),a=r.current.unproject([t,n]),i=o.distanceTo(a);if("imperial"===e.unit){var s=3.2808*i;if(s>5280)j(t,s/5280,r.current._getUIString("ScaleControl.Miles"));else j(t,s,r.current._getUIString("ScaleControl.Feet"))}else if("nautical"===e.unit){j(t,i/1852,r.current._getUIString("ScaleControl.NauticalMiles"))}else i>=1e3?j(t,i/1e3,r.current._getUIString("ScaleControl.Kilometers")):j(t,i,r.current._getUIString("ScaleControl.Meters"))}})),j=function(e,t,r){var n=O(t);m(e*(n/t)),v(n+"&nbsp;"+r)},O=function(e){var t=Math.pow(10,"".concat(Math.floor(e)).length-1),r=e/t;return t*(r=r>=10?10:r>=5?5:r>=3?3:r>=2?2:r>=1?1:function(e){var t=Math.pow(10,Math.ceil(-Math.log(e)/Math.LN10));return Math.round(e*t)/t}(r))};return Object(c.jsx)(c.Fragment,{children:Object(c.jsx)("div",{style:{backgroundColor:"hsla(0,0%,100%,.75)",fontSize:"10px",border:"2px solid #333",borderTop:"#333",padding:"0 5px",color:"#333",boxSizing:"border-box",width:f+"px",fontFamily:"sans-serif"},dangerouslySetInnerHTML:{__html:b}})})};u.__docgenInfo={description:"",methods:[],displayName:"MlScaleReference"};var l=u;"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/MlScaleReference/MlScaleReference.js"]={name:"MlScaleReference",docgenInfo:u.__docgenInfo,path:"src/components/MlScaleReference/MlScaleReference.js"});var p=r(95),d=r(42),f={title:"MapComponents/MlScaleReference",component:l,argTypes:{url:{},layer:{}},decorators:d.a},m=(t.default=f,function(e){return Object(c.jsxs)(c.Fragment,{children:["toolbar"===e.show&&Object(c.jsx)(p.a,{children:Object(c.jsx)(l,Object(n.a)({},e))}),"overlay"===e.show&&Object(c.jsx)("div",{style:{position:"absolute",zIndex:1e5,bottom:"20px",right:"20px"},children:Object(c.jsx)(l,Object(n.a)({},e))})]})}),g=m.bind({});g.args={show:"toolbar"};var h=m.bind({});h.args={show:"overlay"},g.parameters=Object(n.a)({storySource:{source:'(props) => (\n  <>\n    {props.show === "toolbar" && (\n      <TopToolbar>\n        <MlScaleReference {...props} />\n      </TopToolbar>\n    )}\n    {props.show === "overlay" && (\n      <div\n        style={{\n          position: "absolute",\n          zIndex: 100000,\n          bottom: "20px",\n          right: "20px",\n        }}\n      >\n        <MlScaleReference {...props} />\n      </div>\n    )}\n  </>\n)'}},g.parameters),h.parameters=Object(n.a)({storySource:{source:'(props) => (\n  <>\n    {props.show === "toolbar" && (\n      <TopToolbar>\n        <MlScaleReference {...props} />\n      </TopToolbar>\n    )}\n    {props.show === "overlay" && (\n      <div\n        style={{\n          position: "absolute",\n          zIndex: 100000,\n          bottom: "20px",\n          right: "20px",\n        }}\n      >\n        <MlScaleReference {...props} />\n      </div>\n    )}\n  </>\n)'}},h.parameters)},1487:function(e,t,r){"use strict";r.r(t),r.d(t,"ExampleConfig",(function(){return g}));var n=r(6),o=r(21),a=r(0),i=r(3),s=r.n(i),c=r(29),u=r(212),l=r(1),p=function(e){var t=Object(a.useContext)(c.b),r=Object(a.useRef)(!1),i=Object(a.useRef)(void 0),s=Object(a.useState)(void 0),p=Object(o.a)(s,2),d=p[0],f=p[1],m=Object(a.useRef)((e.idPrefix?e.idPrefix:"MlShareMapState-")+Object(u.a)()),g=Object(a.useRef)({});Object(a.useEffect)((function(){var e=m.current;return function(){i.current&&(i.current.cleanup(e),i.current=void 0),r.current=!1}}),[]),Object(a.useEffect)((function(){if(t.mapExists(e.mapId)&&!r.current){r.current=!0,i.current=t.getMap(e.mapId),f(i.current);var n=h();n.lat&&n.lng&&(g.current.lat=n.lat,g.current.lng=n.lng,g.current.zoom=n.zoom,i.current.setCenter([g.current.lng,g.current.lat]),i.current.setZoom(g.current.zoom))}}),[t.mapIds,t,e.mapId,e.active]),Object(a.useEffect)((function(){d&&(e.active?d.on("moveend",(function(){b();var e=new URLSearchParams(Object(n.a)(Object(n.a)({},h()),g.current)),t=new URLSearchParams(window.location.search);e.toString()!==t.toString()&&window.history.pushState(Object(n.a)({},g.current),document.title,"?"+e.toString())}),m.current):d.cleanup(m.current))}),[e.active,d]);var h=function(){return Object.fromEntries(new URLSearchParams(window.location.search))},b=function(){g.current.lat=i.current.getCenter().lat,g.current.lng=i.current.getCenter().lng,g.current.zoom=i.current.getZoom()};return window.onpopstate=function(e){e.state&&e.state.lng&&e.state.lat&&e.state.zoom&&i.current.easeTo({zoom:e.state.zoom,center:[e.state.lng,e.state.lat]})},Object(l.jsx)(l.Fragment,{})};p.defaultProps={mapId:void 0},p.propTypes={mapId:s.a.string},p.__docgenInfo={description:"TODO: Add short & useful description\n\n@param {object} props\n@param {string} props.mapId Id of the target MapLibre instance in mapContext\n\n@component",methods:[],displayName:"MlShareMapState",props:{mapId:{defaultValue:{value:"undefined",computed:!0},type:{name:"string"},required:!1,description:"Id of the target MapLibre instance in mapContext"}}};var d=p;"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/MlShareMapState/MlShareMapState.js"]={name:"MlShareMapState",docgenInfo:p.__docgenInfo,path:"src/components/MlShareMapState/MlShareMapState.js"});var f=r(42),m={title:"MapComponents/MlShareMapState",component:d,argTypes:{},decorators:f.a},g=(t.default=m,function(e){var t=Object(a.useState)(!0),r=Object(o.a)(t,2),n=r[0],i=r[1];return Object(l.jsxs)(l.Fragment,{children:[Object(l.jsxs)("button",{style:{zIndex:"1000",position:"absolute"},onClick:function(){return i(!n)},children:["watch map state ",n?1:0]}),Object(l.jsx)(d,{active:n})]})}.bind({}));g.parameters={},g.args={},g.parameters=Object(n.a)({storySource:{source:'(args) => {\n  const [watchState, setWatchState] = useState(true);\n\n  return (\n    <>\n      <button\n        style={{ zIndex: "1000", position: "absolute" }}\n        onClick={() => setWatchState(!watchState)}\n      >\n        watch map state {watchState?1:0}\n      </button>\n      <MlShareMapState active={watchState} />\n    </>\n  );\n}'}},g.parameters)},1488:function(e,t,r){"use strict";r.r(t),r.d(t,"ExampleConfig",(function(){return S}));var n=r(6),o=r(0),a=r(61),i=r(29),s=r(234),c=r(492),u=r(62),l=r(212),p=r(3),d=r.n(p),f=r(1),m=function(e){var t=Object(o.useContext)(i.b),r=Object(o.useRef)((e.idPrefix?e.idPrefix:"MlSpatialElevationProfile-")+Object(l.a)()),n=Object(o.useRef)(null),p=Object(o.useRef)(!1),d=Object(o.useContext)(s.b),m=Object(o.useRef)("elevationprofile-"+Object(l.a)()),g=Object(o.useRef)("elevationprofile-layer-"+Object(l.a)()),h=Object(o.useCallback)((function(t,r,n,o,a){var i=Object(c.a)([[t,r],[o,a]]),s=Object(u.lineOffset)(i,5,{units:"meters"}),l=s.geometry.coordinates[0][0],p=s.geometry.coordinates[0][1],d=s.geometry.coordinates[1][0],f=s.geometry.coordinates[1][1];return Object(c.b)([[[t,r],[o,a],[d,f],[l,p],[t,r]]],{height:n*e.elevationFactor})}),[e.elevationFactor]);return Object(o.useEffect)((function(){var e=r.current;return function(){n.current&&(n.current.cleanup(e),n.current=null)}}),[]),Object(o.useEffect)((function(){t.mapExists(e.mapId)&&!p.current&&(p.current=!0,n.current=t.getMap(e.mapId),n.current.addSource(m.current,{type:"geojson",data:d.data},r.current),n.current.addLayer({id:g.current,source:m.current,type:"fill-extrusion",paint:{"fill-extrusion-height":["get","height"],"fill-extrusion-opacity":.9,"fill-extrusion-color":["interpolate",["linear"],["get","height"],0,"rgba(0, 0, 255, 0)",.1,"royalblue",.3,"cyan",.5,"lime",.7,"yellow",1,"yellow"]}},e.insertBeforeLayer,r.current))}),[t.mapIds,e.insertBeforeLayer,e.mapId,d,t]),Object(o.useEffect)((function(){var t;if(n.current&&n.current.getLayer(g.current)){var r=d.data;if(r&&r.features){var o=r.features.find((function(e){return"LineString"===e.geometry.type}));if(o&&o.geometry){var i=o.geometry.coordinates.map((function(e,t){return e[2]})),s=Math.min.apply(Math,Object(a.a)(i)),c=Math.max.apply(Math,Object(a.a)(i))-s;c=0===c?1:c,n.current.setPaintProperty(g.current,"fill-extrusion-color",["interpolate",["linear"],["get","height"],0,"rgb(0,255,55)",c*e.elevationFactor,"rgb(255,0,0)"]);var l=function(e,t,r){return e*(1-r)+t*r},p=[];o.geometry.coordinates.forEach((function(e,t){if(o.geometry.coordinates[t+1]){var r=~~(1e3*Object(u.distance)([e[0],e[1]],[o.geometry.coordinates[t+1][0],o.geometry.coordinates[t+1][1]],{units:"kilometers"})/10);r=r<1?1:r;for(var n=0;n<r;n++){var a=l(o.geometry.coordinates[t][0],o.geometry.coordinates[t+1][0],n/r),i=l(o.geometry.coordinates[t][1],o.geometry.coordinates[t+1][1],n/r),c=l(o.geometry.coordinates[t][2]-s,o.geometry.coordinates[t+1][2]-s,n/r),d=l(o.geometry.coordinates[t][0],o.geometry.coordinates[t+1][0],(n+1)/r),f=l(o.geometry.coordinates[t][1],o.geometry.coordinates[t+1][1],(n+1)/r),m=h(a,i,c,d,f);p.push(m)}}}));var f=d.getEmptyFeatureCollection();f.features=p,null===(t=n.current.getSource(m.current))||void 0===t||t.setData(f)}}}}),[d.data,h,d,e.elevationFactor,t]),Object(f.jsx)(f.Fragment,{})};m.defaultProps={elevationFactor:1},m.propTypes={mapId:d.a.string,idPrefix:d.a.string,elevationFactor:d.a.number,insertBeforeLayer:d.a.string},m.__docgenInfo={description:"MlSpatialElevationProfile returns a Button that will add a standard OSM tile layer to the maplibre-gl instance.\n\n@component",methods:[],displayName:"MlSpatialElevationProfile",props:{elevationFactor:{defaultValue:{value:"1",computed:!1},type:{name:"number"},required:!1,description:"Number describes the factor of the height of the elevation"},mapId:{type:{name:"string"},required:!1,description:"Id of the target MapLibre instance in mapContext"},idPrefix:{type:{name:"string"},required:!1,description:"Prefix of the component id this component uses when adding elements to the MapLibreGl-instance"},insertBeforeLayer:{type:{name:"string"},required:!1,description:'The layerId of an existing layer this layer should be rendered visually beneath\nhttps://maplibre.org/maplibre-gl-js-docs/api/map/#map#addlayer - see "beforeId" property'}}};var g=m;"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/MlSpatialElevationProfile/MlSpatialElevationProfile.js"]={name:"MlSpatialElevationProfile",docgenInfo:m.__docgenInfo,path:"src/components/MlSpatialElevationProfile/MlSpatialElevationProfile.js"});var h=r(289),b=r(42),v=r(370),y=r(731),j=r.n(y),O=r(746),x={title:"MapComponents/MlSpatialElevationProfile",component:g,argTypes:{options:{control:{type:"object"}}},decorators:b.a},S=(t.default=x,function(e){return Object(f.jsxs)(f.Fragment,{children:[Object(f.jsx)(O.a,{style:{position:"absolute",right:"5px",bottom:"125px",backgroundColor:"rgba(255,255,255,1)",zIndex:1e3},title:"Download sample-data",size:"large",href:"/assets/sample.gpx",target:"blank",children:Object(f.jsx)(j.a,{})}),Object(f.jsxs)(v.a,{children:[Object(f.jsx)(h.a,{}),Object(f.jsx)(g,{})]})]})}.bind({}));S.parameters={},S.parameters=Object(n.a)({storySource:{source:'(args) => (\n  <>\n    <IconButton\n      style={{\n        position: "absolute",\n        right: "5px",\n        bottom: "125px",\n        backgroundColor: "rgba(255,255,255,1)",\n\n        zIndex: 1000,\n      }}\n      title="Download sample-data"\n      size="large"\n      href="/assets/sample.gpx"\n      target="blank"\n    >\n      <FileDownloadIcon/>\n    </IconButton>\n    <GeoJsonProvider>\n      <MlGPXViewer/>\n      <MlSpatialElevationProfile/>\n    </GeoJsonProvider>\n  </>\n)'}},S.parameters)},1489:function(e,t,r){"use strict";r.r(t),r.d(t,"ExampleConfig",(function(){return d}));var n=r(6),o=r(0),a=r(21),i=r(206),s=(r(1178),r(1)),c=function(e){var t=Object(i.a)({mapId:e.mapId,watch:Object(n.a)({layers:!0,sources:!1,viewport:!1},e.watch),filter:Object(n.a)({},e.filter)}),r=Object(o.useRef)(0);r.current=r.current+1;var c=Object(o.useState)(!0),u=Object(a.a)(c,2);u[0],u[1];return Object(s.jsx)(s.Fragment,{children:Object(s.jsxs)("div",{style:{overflow:"hidden",width:"100px",height:"20px"},children:["Render: ",r.current,Object(s.jsx)("br",{}),Object(s.jsx)("pre",{children:JSON.stringify(t,null," ")})]})})};c.defaultProps={mapId:void 0},c.__docgenInfo={description:"Renders a collapsable top-drawer containing live map debug information\n\n@param {object} props\n@param {string} props.mapId Id of the target MapLibre instance in mapContext\n\n@component",methods:[],displayName:"MlUseMapDebugger",props:{mapId:{defaultValue:{value:"undefined",computed:!0},type:{name:"string"},required:!1,description:"Id of the target MapLibre instance in mapContext"}}};var u=c;"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/MlUseMapDebugger/MlUseMapDebugger.js"]={name:"MlUseMapDebugger",docgenInfo:c.__docgenInfo,path:"src/components/MlUseMapDebugger/MlUseMapDebugger.js"});var l=r(42),p={title:"MapComponents/MlUseMapDebugger",component:u,argTypes:{url:{},layer:{}},decorators:l.a},d=(t.default=p,function(e){return Object(s.jsx)(s.Fragment,{children:Object(s.jsx)(u,Object(n.a)({},e))})}.bind({}));d.parameters={},d.args={mapId:"map_1"},d.parameters=Object(n.a)({storySource:{source:"(props) => {\n  return (\n    <>\n      <MlUseMapDebugger {...props} />\n    </>\n  );\n}"}},d.parameters)},1490:function(e,t,r){"use strict";r.r(t),r.d(t,"ExampleConfig",(function(){return m}));var n=r(6),o=r(0),a=r(29),i=r(3),s=r.n(i),c=r(1),u=function(e){var t=Object(o.useContext)(a.b),r="vector-tile-layer-",i="vector-tile-source-",s=Object(o.useRef)((new Date).getTime()),u=Object(o.useRef)({}),l=Object(o.useRef)({}),p=Object(o.useRef)(!1),d=Object(o.useRef)(null),f=function(){if(d.current&&d.current.style){for(var e in u.current)d.current.getLayer(u.current[e])&&d.current.removeLayer(u.current[e]);d.current.getSource(i+s.current)&&d.current.removeSource(i+s.current)}};return Object(o.useEffect)((function(){return f}),[]),Object(o.useEffect)((function(){if(t.mapExists(e.mapId)&&!p.current)for(var o in p.current=!0,d.current=t.getMap(e.mapId),d.current.addSource(i+s.current,{type:"vector",tiles:[e.url],tileSize:512,attribution:""}),e.layers){var a=r+"_"+o+"_"+s.current;u.current[o]=a,d.current.addLayer(Object(n.a)({id:a,source:i+s.current,type:"line",minzoom:0,maxzoom:22,layout:{},paint:{"line-opacity":.5,"line-color":"rgb(80, 80, 80)","line-width":2}},e.layers[o])),l.current[o]=JSON.stringify(e.layers[o].paint)}}),[t.mapIds,e,t]),Object(o.useEffect)((function(){if(d.current)for(var r in e.layers)if(d.current.getLayer(u.current[r])){var n=JSON.stringify(e.layers[r].paint);if(n!==l.current[r])for(var o in e.layers[r].paint)t.getMap(e.mapId).setPaintProperty(u.current[r],o,e.layers[r].paint[o]);l.current[r]=n}}),[e.layers,e,t]),Object(o.useEffect)((function(){d.current&&(e.visible?d.current.setLayoutProperty(r+s.current,"visibility","visible"):d.current.setLayoutProperty(r+s.current,"visibility","none"))}),[e.visible]),Object(c.jsx)(c.Fragment,{})};u.propTypes={mapId:s.a.string,sourceOptions:s.a.object,layers:s.a.object,url:s.a.string},u.__docgenInfo={description:"Adds a vector-tile source and 0...n vector-tile-layers to the MapLibre instance referenced by\nprops.mapId\n\n@component",methods:[],displayName:"MlVectorTileLayer",props:{mapId:{type:{name:"string"},required:!1,description:"Id of the target MapLibre instance in mapContext"},sourceOptions:{type:{name:"object"},required:!1,description:"Options object that will be used as first parameter on the MapLibreGl.addSource call see MapLibre source options documentation."},layers:{type:{name:"object"},required:!1,description:"Object that hold layers"},url:{type:{name:"string"},required:!1,description:"String of the URL of a wms layer"}}};var l=u;"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/MlVectorTileLayer/MlVectorTileLayer.js"]={name:"MlVectorTileLayer",docgenInfo:u.__docgenInfo,path:"src/components/MlVectorTileLayer/MlVectorTileLayer.js"});var p=r(95),d=r(42),f={title:"MapComponents/MlVectorTileLayer",component:l,argTypes:{url:{},layer:{}},decorators:d.a},m=(t.default=f,function(e){return Object(c.jsx)(p.a,{children:Object(c.jsx)(l,Object(n.a)({},e))})}.bind({}));m.parameters={},m.args={mapId:"map_1",url:"https://wms.wheregroup.com/tileserver/tile/tileserver.php?/europe-0-14/index.json?/europe-0-14/{z}/{x}/{y}.pbf",layers:{landuseLine:{"source-layer":"landuse",layout:{"line-cap":"round","line-join":"round"},paint:{"line-width":2,"line-color":"#ff0000"}}},sourceOptions:{minzoom:0,maxzoom:20}},m.parameters=Object(n.a)({storySource:{source:"(args) => (\n  <TopToolbar>\n    <MlVectorTileLayer {...args} />\n  </TopToolbar>\n)"}},m.parameters)},1491:function(e,t,r){"use strict";r.r(t),r.d(t,"ExampleConfig",(function(){return m}));var n=r(6),o=r(0),a=r(3),i=r.n(a),s=r(29),c=r(212),u=r(1),l=function(e){var t=Object(o.useContext)(s.b),r=Object(o.useRef)(!1),n=Object(o.useRef)(void 0),a=Object(o.useRef)((e.idPrefix?e.idPrefix:"MlWmsFeatureInfoPopup-")+Object(c.a)());return Object(o.useEffect)((function(){var e=a.current;return function(){n.current&&(n.current.cleanup(e),n.current=void 0),r.current=!1}}),[]),Object(o.useEffect)((function(){t.mapExists(e.mapId)&&!r.current&&(r.current=!0,n.current=t.getMap(e.mapId),n.current.setCenter([7.132122000552613,50.716405378037706]))}),[t.mapIds,t,e.mapId]),Object(u.jsx)(u.Fragment,{})};l.defaultProps={mapId:void 0},l.propTypes={mapId:i.a.string},l.__docgenInfo={description:"TODO: Add short & useful description\n\n@param {object} props\n@param {string} props.mapId Id of the target MapLibre instance in mapContext\n\n@component",methods:[],displayName:"MlWmsFeatureInfoPopup",props:{mapId:{defaultValue:{value:"undefined",computed:!0},type:{name:"string"},required:!1,description:"Id of the target MapLibre instance in mapContext"}}};var p=l;"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/MlWmsFeatureInfoPopup/MlWmsFeatureInfoPopup.js"]={name:"MlWmsFeatureInfoPopup",docgenInfo:l.__docgenInfo,path:"src/components/MlWmsFeatureInfoPopup/MlWmsFeatureInfoPopup.js"});var d=r(42),f={title:"MapComponents/MlWmsFeatureInfoPopup",component:p,argTypes:{url:{},layer:{}},decorators:d.a},m=(t.default=f,function(e){return Object(u.jsx)(p,{})}.bind({}));m.parameters={},m.args={},m.parameters=Object(n.a)({storySource:{source:"(args) => <MlWmsFeatureInfoPopup />"}},m.parameters)},158:function(e,t,r){"use strict";var n=r(6),o=r(0),a=r(29),i=r(3),s=r.n(i),c=r(212),u=r(1),l={visible:!0,urlParameters:{bbox:"{bbox-epsg-3857}",format:"image/png",service:"WMS",version:"1.1.1",request:"GetMap",srs:"EPSG:3857",width:256,height:256,styles:""},attribution:"",sourceOptions:{minZoom:0,maxZoom:20},layerOptions:{minZoom:0,maxZoom:20}},p=function(e){var t=Object(o.useContext)(a.b),r=Object(o.useRef)((e.idPrefix?e.idPrefix:"MlWmsLayer-")+Object(c.a)()),i=Object(o.useRef)(null),s=Object(o.useRef)(!1),p=Object(o.useRef)(e.layerId||r.current);return Object(o.useEffect)((function(){var e=r.current;return function(){i.current&&(i.current.cleanup(e),i.current=null),s.current=!1}}),[]),Object(o.useEffect)((function(){var o;if(t.mapExists(e.mapId)&&!s.current&&(i.current=t.getMap(e.mapId),i.current)){var a;s.current=!0;var c=e.url;-1!==e.url.indexOf("?")&&(c=(a=e.url.split("?"))[0]);var u=new URLSearchParams(null===(o=a)||void 0===o?void 0:o[1]),d=Object(n.a)(Object(n.a)(Object(n.a)({},l.urlParameters),Object.fromEntries(u)),e.urlParameters),f=new URLSearchParams(d),m=decodeURIComponent(f.toString())+"".replace(/%2F/g,"/").replace(/%3A/g,":");i.current.addSource(p.current,Object(n.a)({type:"raster",tiles:[c+"?"+m],tileSize:d.width,attribution:e.attribution},e.sourceOptions),r.current),i.current.addLayer(Object(n.a)({id:p.current,type:"raster",source:r.current},e.layerOptions),e.insertBeforeLayer,r.current),e.visible||i.current.setLayoutProperty(r.current,"visibility","none")}}),[t.mapIds,t,e]),Object(o.useEffect)((function(){i.current&&s.current&&(e.visible?i.current.setLayoutProperty(r.current,"visibility","visible"):i.current.setLayoutProperty(r.current,"visibility","none"))}),[e.visible]),Object(u.jsx)(u.Fragment,{})};p.defaultProps=Object(n.a)({},l),p.propTypes={url:s.a.string.isRequired,urlParameters:s.a.shape({layers:s.a.string.isRequired,bbox:s.a.string,format:s.a.string,service:s.a.string,version:s.a.string,request:s.a.string,srs:s.a.string,width:s.a.number,height:s.a.number}),mapId:s.a.string,attribution:s.a.string,layerOptions:s.a.object,sourceOptions:s.a.object,insertBeforeLayer:s.a.string,visible:s.a.bool},p.__docgenInfo={description:'Adds a WMS raster source & layer to the maplibre-gl instance\n\n@param {object} props\n@param {object} props.urlParameters URL query parameters that will be added to the WMS URL. A layers property (string) is mandatory. Any value defined on this attribute will extend the default object\n@param {string} props.url WMS URL\n@param {bool} props.visible Sets layer "visibility" property to "visible" if true or "none" if false\n@param {string} props.attribution MapLibre attribution shown in the bottom right of the map, if this layer is visible\n@param {string} props.mapId Id of the target MapLibre instance in mapContext\n@param {object} props.sourceOptions Object that is passed to the MapLibre.addSource call as config option parameter\n@param {object} props.layerOptions Object that is passed to the MapLibre.addLayer call as config option parameter\n@param {string} props.insertBeforeLayer Id of an existing layer in the mapLibre instance to help specify the layer order\n                                           This layer will be visually beneath the layer with the "insertBeforeLayer" id\n\n@component',methods:[],displayName:"MlWmsLayer",props:{visible:{defaultValue:{value:"true",computed:!1},type:{name:"bool"},required:!1,description:'Sets layer "visibility" property to "visible" if true or "none" if false'},urlParameters:{defaultValue:{value:'{\n  bbox: "{bbox-epsg-3857}",\n  format: "image/png",\n  service: "WMS",\n  version: "1.1.1",\n  request: "GetMap",\n  srs: "EPSG:3857",\n  width: 256,\n  height: 256,\n  styles: "",\n}',computed:!1},type:{name:"shape",value:{layers:{name:"string",required:!0},bbox:{name:"string",required:!1},format:{name:"string",required:!1},service:{name:"string",required:!1},version:{name:"string",required:!1},request:{name:"string",required:!1},srs:{name:"string",required:!1},width:{name:"number",required:!1},height:{name:"number",required:!1}}},required:!1,description:"URL query parameters that will be added to the WMS URL. A layers property (string) is mandatory. Any value defined on this attribute will extend the default object."},attribution:{defaultValue:{value:'""',computed:!1},type:{name:"string"},required:!1,description:"MapLibre attribution shown in the bottom right of the map, if this layer is visible"},sourceOptions:{defaultValue:{value:"{\n  minZoom: 0,\n  maxZoom: 20,\n}",computed:!1},type:{name:"object"},required:!1,description:"Object that is passed to the MapLibre.addSource call as config option parameter"},layerOptions:{defaultValue:{value:"{\n  minZoom: 0,\n  maxZoom: 20,\n}",computed:!1},type:{name:"object"},required:!1,description:"Object that is passed to the MapLibre.addLayer call as config option parameter"},url:{type:{name:"string"},required:!0,description:"WMS URL"},mapId:{type:{name:"string"},required:!1,description:"Id of the target MapLibre instance in mapContext"},insertBeforeLayer:{type:{name:"string"},required:!1,description:'Id of an existing layer in the mapLibre instance to help specify the layer order\nThis layer will be visually beneath the layer with the "insertBeforeLayer" id.'}}},t.a=p,"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/MlWmsLayer/MlWmsLayer.js"]={name:"MlWmsLayer",docgenInfo:p.__docgenInfo,path:"src/components/MlWmsLayer/MlWmsLayer.js"})},159:function(e,t,r){"use strict";var n=r(6),o=r(0),a=r(29),i=r(486),s=r.n(i),c=r(704),u=r(61),l=r(740),p=r(178),d=r.n(p),f=["lng","lat"],m=function(e){var t=this,r=this;this.registeredElements={},this.baseLayers=[],this.firstSymbolLayer=void 0,this.eventHandlers={layerchange:[],viewportchange:[]},this.wrapper={on:function(e,t,n,o){if(r.eventHandlers[e]){"string"==typeof n&&(o=n,n={}),r.eventHandlers[e].push({handler:t,options:n});var a=[e,t];o&&"string"==typeof o&&(r.initRegisteredElements(o),r.registeredElements[o].wrapperEvents.push(a))}},off:function(e,t){r.eventHandlers[e]&&(r.eventHandlers[e]=r.eventHandlers[e].filter((function(e){if(!Object.is(e.handler,t))return e})))},fire:function(e,t){if(r.eventHandlers[e]){var n=t||window,o=new Event(e);o.data=r,r.eventHandlers[e].forEach((function(e){e.handler.call(n,o)}))}},layerState:{},layerStateStrings:{},oldLayerStateStrings:{},buildLayerObject:function(e){var t,n,o={},a=null===(t=e.paint)||void 0===t?void 0:t._values;Object.keys(a||{}).map((function(e){o[e]=void 0!==a[e].value?a[e].value.value:a[e]}));var i={};return a=null===(n=e.layout)||void 0===n?void 0:n._values,Object.keys(a||{}).map((function(e){i[e]=void 0!==a[e].value?a[e].value.value:a[e]})),{id:e.id,type:e.type,visible:"none"!==e.visibility,baseLayer:-1!==r.baseLayers.indexOf(e.id),paint:o,layout:i}},buildLayerObjects:function(){return r.style._order.map((function(e){return r.wrapper.buildLayerObject(r.map.style._layers[e])})).filter((function(e){return e}))},refreshLayerState:function(){r.wrapper.layerState=r.wrapper.buildLayerObjects(),r.wrapper.layerStateStrings=r.wrapper.layerState.map((function(e){return JSON.stringify(e)}))},viewportState:{},viewportStateString:"{}",oldViewportStateString:"{}",getViewport:function(){return"function"==typeof r.map.getCenter?{center:function(e){var t=e.lng,r=e.lat;Object(l.a)(e,f);return{lng:t,lat:r}}(r.map.getCenter()),zoom:r.map.getZoom(),bearing:r.map.getBearing(),pitch:r.map.getPitch()}:{}},viewportRefreshEnabled:!0,viewportRefreshWaiting:!1,refreshViewport:function(e){r.wrapper.viewportRefreshEnabled||e?(r.wrapper.viewportRefreshEnabled=!1,r.wrapper.viewportState=r.wrapper.getViewport(),r.wrapper.viewportStateString=JSON.stringify(r.wrapper.viewportState),setTimeout((function(){r.wrapper.viewportRefreshEnabled=!0,r.wrapper.viewportRefreshWaiting&&(r.wrapper.viewportRefreshWaiting=!1,r.wrapper.refreshViewport())}),50)):r.wrapper.viewportRefreshWaiting=!0}},this.initRegisteredElements=function(e,t){(void 0===r.registeredElements[e]||"undefined"!==t&&t)&&(r.registeredElements[e]={layers:[],sources:[],images:[],events:[],controls:[],wrapperEvents:[]})},this.addLayer=function(e,t,n){r.map.style&&(n&&"string"==typeof n&&void 0!==e.id&&(r.initRegisteredElements(n),r.registeredElements[n].layers.push(e.id),"object"==typeof e.source&&r.registeredElements[n].sources.push(e.id)),r.map.addLayer(e,t))},this.addSource=function(e,t,n,o){if(r.map.style){if("string"==typeof n&&void 0===o)return r.addSource.call(r,e,t,void 0,n);o&&"string"==typeof o&&void 0!==e&&(r.initRegisteredElements(o),r.registeredElements[o].sources.push(e)),r.map.addSource(e,t,n)}},this.addImage=function(e,t,n,o){if(r.map.style){if("string"==typeof n&&void 0===o)return r.addImage.call(r,e,t,void 0,n);o&&"string"==typeof o&&void 0!==e&&(r.initRegisteredElements(o),r.registeredElements[o].images.push(e)),r.map.addImage(e,t,n)}},this.on=function(e,t,n,o){var a;if("string"==typeof n&&"function"==typeof t)return r.on.call(r,e,void 0,t,n);var i=[e,t,n];t||(i=[e,n]),o&&"string"==typeof o&&(r.initRegisteredElements(o),r.registeredElements[o].events.push(i)),(a=r.map).on.apply(a,Object(u.a)(i))},this.addControl=function(e,t,n){n&&"string"==typeof n&&(r.initRegisteredElements(n),r.registeredElements[n].controls.push(e)),r.map.addControl(e,t)},this.cleanup=function(e){r.map.style&&void 0!==r.registeredElements[e]&&(r.registeredElements[e].layers.forEach((function(e){r.map.style.getLayer(e)&&r.map.style.removeLayer(e)})),r.registeredElements[e].sources.forEach((function(e){r.map.style.getSource(e)&&r.map.style.removeSource(e)})),r.registeredElements[e].images.forEach((function(e){r.map.hasImage(e)&&r.map.style.removeImage(e)})),r.registeredElements[e].events.forEach((function(e){var t;(t=r.map).off.apply(t,Object(u.a)(e))})),r.registeredElements[e].controls.forEach((function(e){r.map.removeControl(e)})),r.registeredElements[e].wrapperEvents.forEach((function(e){var t;(t=r.wrapper).off.apply(t,Object(u.a)(e))})),r.initRegisteredElements(e,!0))};["moveLayer","removeLayer","removeSource","setPaintProperty","setLayoutProperty"].forEach((function(e){t[e]=function(){var n;r.map&&t.map.style&&"function"==typeof r.map.style[e]&&(n=r.map.style)[e].apply(n,arguments);return r.map._update?r.map._update(!0):void 0}}));["getLayer","getSource","listImages","getPaintProperty","getLayoutProperty","removeImage"].forEach((function(e){t[e]=function(){var t;return!(!r.map||!r.map.style)&&(t=r.map.style)[e].apply(t,arguments)}})),this.addNativeMaplibreFunctionsAndProps=function(){Object.keys(t.map.__proto__).forEach((function(e){void 0===t[e]&&(t[e]=function(){var t;return(t=r.map)[e].apply(t,arguments)})})),Object.keys(t.map).forEach((function(e){void 0===t[e]&&(t[e]=r.map[e])}))};["getZoom","setZoom","getCenter","setCenter","getBearing","setBearing","getPitch","setPitch","jumpTo","flyTo","panTo","panBy","panBy","zoomTo","zoomIn","zoomOut","getPadding","setPadding","rotateTo","resetNorth","resetNorthPitch","snapToNorth","cameraForBounds","fitBounds","fitScreenCoordinates","getFreeCameraOptions","setFreeCameraOptions","easeTo","stop"].forEach((function(e){t[e]=function(){if("function"==typeof r.map[e]){for(var t,n=arguments.length,o=new Array(n),a=0;a<n;a++)o[a]=arguments[a];return(t=r.map[e]).call.apply(t,[r.map].concat(o))}}})),function(){var t=Object(c.a)(s.a.mark((function t(){return s.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if("string"!=typeof e.mapOptions.style||-1!==e.mapOptions.style.indexOf("mapbox://")){t.next=3;break}return t.next=3,fetch(e.mapOptions.style).then((function(e){if(e.ok)return e.json();throw new Error("error loading map style.json")})).then((function(t){t.layers.forEach((function(e){r.baseLayers.push(e.id),r.firstSymbolLayer||"symbol"!==e.type||(r.firstSymbolLayer=e.id)})),r.styleJson=t,e.mapOptions.style=t})).catch((function(e){console.log(e)}));case 3:r.map=new d.a.Map(e.mapOptions),r.addNativeMaplibreFunctionsAndProps(),r.wrapper.refreshViewport(!0),r.wrapper.fire("viewportchange"),r.map.on("move",(function(){r.wrapper.refreshViewport(),r.wrapper.viewportStateString!==r.wrapper.oldViewportStateString&&(r.wrapper.oldViewportStateString=r.wrapper.viewportStateString,r.wrapper.fire("viewportchange"))})),r.map.on("data",(function(){r.wrapper.refreshLayerState(),r.wrapper.fire("layerchange")})),"function"==typeof e.onReady&&e.onReady(r.map,r);case 10:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}()()},g=(r(1113),r(1)),h=function(e){var t=Object(o.useRef)(null),r=Object(o.useRef)(null),i=Object(o.useContext)(a.b),s=Object(o.useRef)(i),c=Object(o.useRef)(e.mapId),u=e.options;return Object(o.useEffect)((function(){var e=c.current,r=s.current;return function(){var n,o;r.removeMap(e),null===(n=t.current)||void 0===n||null===(o=n.remove)||void 0===o||o.call(n),t.current=null}}),[]),Object(o.useEffect)((function(){r.current&&(t.current=new m({mapOptions:Object(n.a)({container:r.current},u),onReady:function(t,r){t.once("load",(function(){e.mapId?i.registerMap(e.mapId,r):i.setMap(r)})),window.map=r}}))}),[r]),Object(g.jsx)("div",{ref:r,className:"mapContainer"})};h.defaultProps={mapId:void 0,options:{lng:8.607,lat:53.1409349,zoom:10,accessToken:"pk.eyJ1IjoibWF4dG9iaSIsImEiOiJjaW1rcWQ5bWMwMDJvd2hrbWZ2ZTBhcnM5In0.NcGt5NmLP5Q1WC7P5u6qUA"}},h.__docgenInfo={description:"Creates a MapLibreGlWrapper instance and registers it in MapContext\nafter the MapLibre-gl load event has fired.\n\nMapLibreMap returns the html node that will be used by MapLibre-gl to render the map.\nThis Component must be kept unaware of any related components that interact with the MapLibre-gl\ninstance.\n\n@component",methods:[],displayName:"MapLibreMap",props:{mapId:{defaultValue:{value:"undefined",computed:!0},type:{name:"string"},required:!1,description:"Id of the MapLibreGl(Wrapper) instance in mapContext"},options:{defaultValue:{value:'{\n  lng: 8.607,\n  lat: 53.1409349,\n  zoom: 10,\n  accessToken:\n    "pk.eyJ1IjoibWF4dG9iaSIsImEiOiJjaW1rcWQ5bWMwMDJvd2hrbWZ2ZTBhcnM5In0.NcGt5NmLP5Q1WC7P5u6qUA",\n}',computed:!1},type:{name:"object"},required:!1,description:"Config object that is passed to the MapLibreGl constructor as first parameter.\nSee https://maplibre.org/maplibre-gl-js-docs/api/map/ for a formal documentation of al\navailable properties."}}};t.a=h;"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/MapLibreMap/MapLibreMap.js"]={name:"MapLibreMap",docgenInfo:h.__docgenInfo,path:"src/components/MapLibreMap/MapLibreMap.js"})},206:function(e,t,r){"use strict";var n=r(21),o=r(0),a=r(3),i=r.n(a),s=r(212),c=r(29);function u(e){var t=Object(o.useContext)(c.b),r=Object(o.useRef)(!1),a=Object(o.useRef)(void 0),i=Object(o.useState)(void 0),u=Object(n.a)(i,2),l=(u[0],u[1]),p=Object(o.useState)(void 0),d=Object(n.a)(p,2),f=d[0],m=d[1],g=Object(o.useRef)(void 0),h=Object(o.useState)(void 0),b=Object(n.a)(h,2),v=b[0],y=b[1],j=Object(o.useRef)(void 0),O=Object(o.useRef)(Object(s.a)()),x=Object(o.useCallback)((function(t){return!(!e.filter.includeBaseLayers&&t.baseLayer)&&(void 0===e.filter.matchLayerIds||(e.filter.matchLayerIds instanceof RegExp?e.filter.matchLayerIds.test(t.id):t.id.includes(e.filter.matchLayerIds)))}),[e.filter]),S=Object(o.useCallback)((function(){var e=a.current.wrapper.layerState.filter(x),t=JSON.stringify(e);j.current!==t&&(j.current=t,y(e))}),[x]);return Object(o.useEffect)((function(){var e=O.current;return function(){a.current&&(a.current.cleanup(e),a.current=void 0),r.current=!1}}),[]),Object(o.useEffect)((function(){var n,o,i,s;t.mapExists(e.mapId)&&!r.current&&(r.current=!0,a.current=t.getMap(e.mapId),(null==e||null===(n=e.watch)||void 0===n?void 0:n.viewport)&&(m(a.current.wrapper.viewportState),a.current.wrapper.on("viewportchange",(function(){var e,t,r,n;g.current!==(null===(e=a.current)||void 0===e?void 0:e.wrapper.viewportStateString)&&(m(null===(t=a.current)||void 0===t?void 0:t.wrapper.viewportState),l(null===(r=a.current)||void 0===r||null===(n=r.wrapper.viewportState)||void 0===n?void 0:n.center))}),O.current)),(null==e||null===(o=e.watch)||void 0===o?void 0:o.layers)&&(S(),a.current.wrapper.on("layerchange",S,{includeBaseLayers:null==e||null===(i=e.filter)||void 0===i?void 0:i.includeBaseLayers,matchLayerIds:null==e||null===(s=e.filter)||void 0===s?void 0:s.matchLayerIds},O.current)))}),[t.mapIds,t,e.mapId,S]),{layers:v,viewport:f}}u.defaultProps={mapId:void 0,watch:{layers:!0,sources:!1,viewport:!1},filter:{includeBaseLayers:!1}},u.propTypes={mapId:i.a.string,watch:i.a.shape({layers:i.a.bool,sources:i.a.bool,viewport:i.a.bool}),filter:i.a.shape({includeBaseLayers:i.a.bool,matchLayerIds:i.a.oneOfType([i.a.string,i.a.instanceOf(RegExp)]),matchSourceIds:i.a.oneOfType([i.a.string,i.a.instanceOf(RegExp)])})},t.a=u},207:function(e,t,r){"use strict";var n=r(0),o=r(3),a=r.n(o),i=r(212),s=r(62),c=r(29),u=r(61),l=function(e,t,r,n,o,a,i,c,l,p,d){var f=[],m=[],g=[],h=[];r.current=[];var b=a.current||{geometry:{type:"LineString",coordinates:[]},properties:{},type:"Feature"},v=e,y=v,j=b,O=!1;if(void 0===y.geometry&&void 0!==j.geometry&&j.geometry.coordinates.length>1)y=s.lineString(j.geometry.coordinates.slice(0,2));else if(void 0===j.geometry&&void 0!==y.geometry&&y.geometry.coordinates.length>1)j=s.lineString(y.geometry.coordinates.slice(0,2));else if(void 0===j.geometry&&void 0===y.geometry)return;if(y.geometry.coordinates.length<j.geometry.coordinates.length&&(y=b,j=v,O=!0),y&&j)for(var x=0,S=y.geometry.coordinates.length;x<S;x++)void 0!==j.geometry.coordinates[x]&&y.geometry.coordinates[x][0]===j.geometry.coordinates[x][0]&&y.geometry.coordinates[x][1]===j.geometry.coordinates[x][1]?r.current.push(y.geometry.coordinates[x]):(void 0!==y.geometry.coordinates[x]&&m.push(y.geometry.coordinates[x]),void 0!==j.geometry.coordinates[x]&&f.push(j.geometry.coordinates[x]));if(O?(g=f,h=m):(g=m,h=f),!(g.length<2&&h<2)){var M=t.transitionTime/i,C=h.length>1?Math.round(s.length(s.lineString(h))):0,w=g.length>1?Math.round(s.length(s.lineString(g))):0,E=w+C,L=C/E,I=Math.round(M*L),T=Math.round(C/I*100)/100,R=w/E,_=Math.round(M*R),A=Math.round(w/_*100)/100;n.current=[];var P=C;P<=0&&(P=.1);var k={},H={};if(h.length>1){for(k=(H=s.lineChunk(s.lineString(h),T)).features[1],x=0;x<I;x++){if(n.current.push(k),void 0===H.features[x]){n.current.push(k);break}k=s.lineString([].concat(Object(u.a)(k.geometry.coordinates),Object(u.a)(H.features[x].geometry.coordinates)))}n.current.reverse()}if(g.length>1)for(P=0,k=(H=s.lineChunk(s.lineString(g),A)).features[1],x=0;x<_;x++){if(n.current.push(k),void 0===H.features[x]){n.current.push(k);break}k=s.lineString([].concat(Object(u.a)(k.geometry.coordinates),Object(u.a)(H.features[x].geometry.coordinates)))}n.current.push(t.geojson),c.current=1,o.current=!0,d.current=setTimeout((function(){return function e(t,r,n,o,a,i,c,l,p){var d=arguments;if(void 0!==n.getSource(r)&&o.current){if(void 0!==a.current[c.current]){var f,m=c.current+1===a.current.length?t.geojson:s.lineString([].concat(Object(u.a)(i.current),Object(u.a)(a.current[c.current].geometry.coordinates)));if(!(null==n||null===(f=n.getSource)||void 0===f?void 0:f.call(n,r)))return;n.getSource(r).setData(m),"function"==typeof t.onTransitionFrame&&t.onTransitionFrame(m),c.current++,o.current&&c.current<a.current.length?p.current=setTimeout((function(){return e.apply(void 0,Object(u.a)(d))}),l):("function"==typeof t.onTransitionEnd&&t.onTransitionEnd(t.geojson),o.current=!1)}}else p.current=setTimeout((function(){return e.apply(void 0,Object(u.a)(d))}),l)}(t,p,l,o,n,r,c,i,d)}),i)}},p=r(1),d=function(e){var t=Object(n.useContext)(c.b),r=Object(n.useRef)(null),o=Object(n.useRef)(null),a=Object(n.useRef)(!1),u=Object(n.useRef)(!1),d=Object(n.useRef)(void 0),f=Object(n.useRef)(!1),m=Object(n.useRef)([]),g=Object(n.useRef)([]),h=Object(n.useRef)((e.layerId?e.layerId:"MlGeoJsonLayer-")+(e.idSuffix||Object(i.a)())),b=Object(n.useRef)(e.layerId||h.current);Object(n.useEffect)((function(){var e=h.current;return function(){d.current&&clearTimeout(d.current),o.current&&(o.current.cleanup(e),o.current=null)}}),[]),Object(n.useEffect)((function(){if(o.current&&a.current)for(var r in e.paint)t.getMap(e.mapId).setPaintProperty(h.current,r,e.paint[r])}),[e.paint,t,e.mapId]);var v=Object(n.useCallback)((function(t){l(t,e,g,m,u,r,50,f,o.current,h.current,d)}),[e]);return Object(n.useEffect)((function(){var t,n;(null===(t=o.current)||void 0===t||null===(n=t.getSource)||void 0===n?void 0:n.call(t,h.current))&&a.current&&(void 0!==e.transitionTime&&"line"===e.type&&r.current?(u.current=!1,f.current=!1,m.current=[],g.current=[],v(e.geojson)):o.current.getSource(h.current).setData(e.geojson),r.current=e.geojson)}),[e.geojson,e.mapId,t,e.type,v,e.transitionTime]),Object(n.useEffect)((function(){if(t.mapExists(e.mapId)&&!a.current&&e.geojson){a.current=!0;var n=e.geojson;if("line"===e.type&&void 0!==e.transitionTime&&e.transitionTime&&void 0!==e.geojson.geometry)n=s.lineChunk(e.geojson,.01).features[0];o.current=t.getMap(e.mapId),o.current.addLayer({id:b.current,source:{type:"geojson",data:n},type:e.type||"line",paint:e.paint||{"line-color":"rgb(100,200,100)","line-width":10}},e.insertBeforeLayer,h.current),void 0!==e.onHover&&o.current.on("mousemove",h.current,e.onHover,h.current),void 0!==e.onClick&&o.current.on("click",h.current,e.onClick,h.current),void 0!==e.onLeave&&o.current.on("mouseleave",h.current,e.onLeave,h.current),"line"===e.type&&void 0!==e.transitionTime&&void 0!==e.geojson.geometry&&(v(e.geojson),r.current=e.geojson)}}),[t.mapIds,t,e,v]),Object(p.jsx)(p.Fragment,{})};d.propTypes={mapId:a.a.string,type:a.a.string,paint:a.a.object,geojson:a.a.object,insertBeforeLayer:a.a.string,layerId:a.a.string,onClick:a.a.func,onHover:a.a.func,onLeave:a.a.func,transitionTime:a.a.number,idSuffix:a.a.string},d.__docgenInfo={description:'Adds source and layer of types "line", "fill" or "circle" to display GeoJSON data on the map.\n\n@component',methods:[],displayName:"MlGeoJsonLayer",props:{mapId:{type:{name:"string"},required:!1,description:"Id of the target MapLibre instance in mapContext"},type:{type:{name:"string"},required:!1,description:'Type of the layer that will be added to the MapLibre instance.\nPossible values: "line", "circle", "fill"'},paint:{type:{name:"object"},required:!1,description:"Paint object, that is passed to the addLayer call.\nPossible propsdepend on the layer type.\nhttps://maplibre.org/maplibre-gl-js-docs/style-spec/layers/#line\nhttps://maplibre.org/maplibre-gl-js-docs/style-spec/layers/#circle\nhttps://maplibre.org/maplibre-gl-js-docs/style-spec/layers/#fill"},geojson:{type:{name:"object"},required:!1,description:"GeoJSON data that is supposed to be rendered by this component."},insertBeforeLayer:{type:{name:"string"},required:!1,description:'Id of an existing layer in the mapLibre instance to help specify the layer order\nThis layer will be visually beneath the layer with the "insertBeforeLayer" id.'},layerId:{type:{name:"string"},required:!1,description:"Id of the new layer and source that are added to the MapLibre instance"},onClick:{type:{name:"func"},required:!1,description:"Click event handler that is executed whenever a geometry rendered by this component is clicked."},onHover:{type:{name:"func"},required:!1,description:"Hover event handler that is executed whenever a geometry rendered by this component is hovered."},onLeave:{type:{name:"func"},required:!1,description:"Leave event handler that is executed whenever a geometry rendered by this component is\nleft/unhovered."},transitionTime:{type:{name:"number"},required:!1,description:'Creates transition animation whenever the geojson prop changes.\nOnly works with layer type "line" and LineString GeoJSON data.'},idSuffix:{type:{name:"string"},required:!1,description:"Id suffix string that is appended to the componentId.\nProbably removed soon."}}};t.a=d;"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/MlGeoJsonLayer/MlGeoJsonLayer.js"]={name:"MlGeoJsonLayer",docgenInfo:d.__docgenInfo,path:"src/components/MlGeoJsonLayer/MlGeoJsonLayer.js"})},234:function(e,t,r){"use strict";r.d(t,"a",(function(){return a}));var n=r(0),o=r.n(n).a.createContext({}),a=o.Provider;t.b=o},235:function(e,t,r){"use strict";r(0);var n=r(29),o=r(159),a=r(493),i=r(1505),s=(r(640),r(1)),c=Object(a.a)({}),u=[function(e){return Object(s.jsx)("div",{className:"fullscreen_map",children:Object(s.jsx)(i.a,{theme:c,children:Object(s.jsx)(n.a,{children:Object(s.jsxs)("div",{style:{overflow:"hidden",position:"absolute",top:"0",bottom:"0",left:"0",right:"0"},children:[Object(s.jsx)(e,{}),Object(s.jsxs)("div",{className:"maps",children:[Object(s.jsx)(o.a,{mapId:"map_1",options:{zoom:14.5,style:"https://wms.wheregroup.com/tileserver/style/osm-liberty.json",center:[7.0851268,50.73884]}}),Object(s.jsx)(o.a,{mapId:"map_2",options:{zoom:14.5,style:"https://wms.wheregroup.com/tileserver/style/osm-bright.json",center:[7.0851268,50.73884]}})]})]})})})})}];t.a=u},287:function(e,t,r){"use strict";var n=r(6),o=r(21),a=r(0),i=r(29),s=r(212),c=r(745),u=r(723),l=r.n(u),p=r(62),d=r(207),f=r(288),m=r(1),g=function(e){var t=Object(a.useContext)(i.b),r=Object(a.useState)(!1),u=Object(o.a)(r,2),g=u[0],h=u[1],b=Object(a.useState)(void 0),v=Object(o.a)(b,2),y=v[0],j=v[1],O=Object(a.useRef)(void 0),x=Object(a.useState)(!1),S=Object(o.a)(x,2),M=S[0],C=S[1],w=Object(a.useRef)(!1),E=Object(a.useRef)(void 0),L=Object(a.useRef)((e.idPrefix?e.idPrefix:"MlFollowGps-")+Object(s.a)()),I=Object(a.useState)(30),T=Object(o.a)(I,2),R=T[0],_=T[1];Object(a.useEffect)((function(){var e=L.current;return function(){E.current&&(E.current.cleanup(e),E.current=void 0),O.current&&(w.current=!1,navigator.geolocation.clearWatch(O.current),O.current=void 0)}}),[]),Object(a.useEffect)((function(){t.mapExists(e.mapId)&&!w.current&&(w.current=!0,E.current=t.getMap(e.mapId),E.current.setCenter([7.132122000552613,50.716405378037706]))}),[t.mapIds,t,e.mapId]);var A=function(e){E.current&&(E.current.setCenter([e.coords.longitude,e.coords.latitude]),_(e.coords.accuracy),j(Object(p.point)([e.coords.longitude,e.coords.latitude])))},P=function(e){console.log("Access of user location denied"),C(!0)};return Object(m.jsxs)(m.Fragment,{children:[g&&y&&Object(m.jsx)(d.a,{geojson:y,type:"circle",paint:{"circle-radius":{stops:[[0,0],[20,R/.075/Math.cos(y.geometry.coordinates[1]*Math.PI/180)]],base:2},"circle-color":"#ee7700","circle-opacity":.5}}),g&&y&&Object(m.jsx)(f.a,{options:{type:"symbol",source:{type:"geojson",data:y},layout:{"icon-size":.1,"icon-offset":[0,-340]}},imgSrc:"/assets/marker.png"}),Object(m.jsxs)(c.a,{sx:Object(n.a)({zIndex:1002,color:g?"#bbb":"#666"},e.style),disabled:M,onClick:function(){g?navigator.geolocation.clearWatch(O.current):O.current=navigator.geolocation.watchPosition(A,P),h(!g)},children:[" ",Object(m.jsx)(l.a,{sx:{}})," "]})]})};g.defaultProps={mapId:void 0,style:{minWidth:"30px",minHeight:"30px",width:"30px",height:"30px",backgroundColor:"#414141",borderRadius:"23%",margin:.15,":hover":{backgroundColor:"#515151",color:"#ececec"}}},g.__docgenInfo={description:"Adds a button that makes the map follow the users GPS position using\nnavigator.geolocation.watchPosition if activated\n\n@param {object} props\n@param {string} props.mapId Id of the target MapLibre instance in mapContext\n\n@component",methods:[],displayName:"MlFollowGps",props:{mapId:{defaultValue:{value:"undefined",computed:!0},type:{name:"string"},required:!1,description:"Id of the target MapLibre instance in mapContext"},style:{defaultValue:{value:'{\n  minWidth: "30px",\n  minHeight: "30px",\n  width: "30px",\n  height: "30px",\n  backgroundColor: "#414141",\n  borderRadius: "23%",\n  margin: 0.15,\n  ":hover": {\n    backgroundColor: "#515151",\n    color: "#ececec",\n  },\n}',computed:!1},type:{name:"object"},required:!1,description:"CSS style object that is applied to the button component"}}},t.a=g,"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/MlFollowGps/MlFollowGps.js"]={name:"MlFollowGps",docgenInfo:g.__docgenInfo,path:"src/components/MlFollowGps/MlFollowGps.js"})},288:function(e,t,r){"use strict";var n=r(6),o=r(0),a=r(212),i=r(29),s=r(1),c=function(e){var t=Object(o.useRef)(null),r=Object(o.useRef)((e.idPrefix?e.idPrefix:"MlOsmLayer-")+Object(a.a)()),c=Object(o.useContext)(i.b),u=Object(o.useRef)(!1),l=Object(o.useRef)(e.idSuffix||(new Date).getTime()),p=Object(o.useRef)(e.imageId||"img_"+(new Date).getTime()),d=Object(o.useRef)((e.layerId||"MlImageMarkerLayer-")+l.current);Object(o.useEffect)((function(){var e=r.current;return function(){t.current&&(t.current.cleanup(e),t.current=null)}}),[]),Object(o.useEffect)((function(){if(t.current&&(!t.current||c.getMap(e.mapId).getLayer(d.current))&&e.options){var r;if(e.options.layout)for(r in e.options.layout)c.getMap(e.mapId).setLayoutProperty(d.current,r,e.options.layout[r]);if(e.options.paint)for(r in e.options.paint)c.getMap(e.mapId).setPaintProperty(d.current,r,e.options.paint[r])}}),[e.options,d.current,c,e.mapId]);var f=Object(o.useCallback)((function(){var o=Object(n.a)({id:d.current,layout:{}},e.options);o.layout["icon-image"]=p.current,t.current.addLayer(o,e.insertBeforeLayer,r.current)}),[e]);return Object(o.useEffect)((function(){e.options&&c.mapExists(e.mapId)&&!u.current&&(t.current=c.getMap(e.mapId),u.current=!0,e.imgSrc&&t.current.loadImage(e.imgSrc,(function(e,n){if(e)throw e;t.current.addImage(p.current,n,r.current)})),f())}),[c.mapIds,c,e,f]),Object(o.useEffect)((function(){t.current&&(!t.current||c.getMap(e.mapId).getLayer(d.current))&&e.options&&t.current.getSource(d.current).setData(e.options.source.data)}),[e.options.source.data,c,e]),Object(s.jsx)(s.Fragment,{})};c.__docgenInfo={description:"",methods:[],displayName:"MlImageMarkerLayer"},t.a=c,"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/MlImageMarkerLayer/MlImageMarkerLayer.js"]={name:"MlImageMarkerLayer",docgenInfo:c.__docgenInfo,path:"src/components/MlImageMarkerLayer/MlImageMarkerLayer.js"})},289:function(e,t,r){"use strict";var n=r(61),o=r(21),a=r(0),i=r(29),s=r(62),c=r(1502),u=r(744),l=r(1498),p=r(746),d=r(483),f=r.n(d),m=r(725),g=r.n(m),h=r(178),b=r(1503),v=r(1497),y=r(1504),j=r(234),O=r(724),x=r(212),S=r(1),M=function(e){var t=Object(a.useContext)(j.b),r=Object(a.useRef)((e.idPrefix?e.idPrefix:"MlGpxViewer-")+Object(x.a)()),d=Object(a.useContext)(i.b),m=e.mapId,M=Object(a.useRef)(!1),C=Object(a.useRef)(null),w="importer-layer-lines",E="importer-layer-points",L=Object(a.useState)(!1),I=Object(o.a)(L,2),T=I[0],R=I[1],_=Object(a.useRef)(null),A=Object(a.useState)(0),P=Object(o.a)(A,2),k=P[0],H=P[1],F=Object(a.useState)([]),N=Object(o.a)(F,2),U=N[0],B=N[1],G=Object(a.useRef)(null),D=Object(a.useRef)(new h.Popup({closeButton:!1,closeOnClick:!0}));Object(a.useEffect)((function(){var e=r.current,t=D.current;return function(){C.current&&(C.current.cleanup(e),C.current.getCanvas().style.cursor="",C.current=null),t.remove()}}),[]),Object(a.useEffect)((function(){d.mapExists(m)&&!M.current&&(M.current=!0,C.current=d.getMap(m),C.current.addSource("import-source",{type:"geojson",data:t.data},r.current),C.current.addLayer({id:w,source:"import-source",type:"line",paint:{"line-width":4,"line-color":"rgba(212, 55, 23,0.5)"}},e.insertBeforeLayer,r.current),C.current.addLayer({id:E,source:"import-source",type:"circle",paint:{"circle-color":"rgba(72, 77, 99,0.5)","circle-radius":7},filter:["==","$type","Point"]},e.insertBeforeLayer,r.current),[w,E].forEach((function(e){C.current.setLayoutProperty(e,"visibility","visible")})),C.current.on("mouseenter",E,(function(t){d.getMap(e.mapId).getCanvas().style.cursor="pointer";for(var r=t.features[0].geometry.coordinates.slice(),n=t.features[0].properties.name;Math.abs(t.lngLat.lng-r[0])>180;)r[0]+=t.lngLat.lng>r[0]?360:-360;D.current.setLngLat(r).setHTML(n).addTo(C.current)})),C.current.on("mouseleave","places",(function(){C.current.getCanvas().style.cursor="",D.current.remove()})),C.current.setZoom(10))}),[d.mapIds,d,t.data,m,e]),Object(a.useEffect)((function(){var e=_.current,t=function(e){H(1e3),z(e)},r=function(){H(0)},n=function(e){H(0),z(e)};return window.addEventListener("dragenter",t),window.addEventListener("dragover",z),e.addEventListener("dragleave",r),window.addEventListener("drop",n),function(){window.removeEventListener("dragenter",t),window.removeEventListener("dragover",z),window.removeEventListener("drop",z),e.removeEventListener("dragleave",r),window.removeEventListener("drop",(function(e){return n}))}}));var z=function(e){e.preventDefault(),e.stopPropagation()};Object(a.useEffect)((function(){if(C.current){var t=e.visible?"visible":"none";[w,E].forEach((function(e){C.current.setLayoutProperty(e,"visibility",t)}))}}),[e.visible]);var q=function(e){if(C.current)try{B([]);var r=(new DOMParser).parseFromString(e,"application/xml");r.querySelector("metadata").childNodes.forEach((function(e){var t=e.textContent,r=e.nodeName;if("link"===e.nodeName&&(t=e.getAttribute("href")),t.trim().length){var o={title:r,value:t,id:(new Date).getTime()};B((function(e){return[].concat(Object(n.a)(e),[o])}))}}));var o=O.a.gpx(r);t.setData(o),C.current.getSource("import-source").setData(o);var a=Object(s.bbox)(o);C.current.fitBounds(a)}catch(e){console.log(e)}};return Object(S.jsxs)(S.Fragment,{children:[Object(S.jsxs)(p.a,{onClick:function(){G.current.click()},style:{position:"absolute",right:"5px",bottom:"75px",backgroundColor:"rgba(255,255,255,1)",zIndex:1e3},size:"large",children:[Object(S.jsx)("input",{ref:G,onChange:function(){var e=G.current.files[0];if(!e)return!1;var t=new FileReader;t.onload=function(e){q(e.currentTarget.result)},t.readAsText(e)},type:"file",id:"input",multiple:!0,style:{display:"none"}}),Object(S.jsx)(g.a,{})]}),Object(S.jsx)(p.a,{onClick:function(){R((function(e){return!e}))},style:{position:"absolute",right:"5px",bottom:"25px",backgroundColor:"rgba(255,255,255,1)",zIndex:1e3},size:"large",children:Object(S.jsx)(f.a,{})}),Object(S.jsxs)(l.a,{variant:"persistent",anchor:"left",open:T,children:[Object(S.jsx)(u.a,{variant:"h6",style:{textAlign:"center",padding:"1em"},noWrap:!0,children:"Informationen zur Route"}),Object(S.jsx)(c.a,{}),Object(S.jsx)(b.a,{children:U.map((function(e){return Object(S.jsx)(v.a,{children:Object(S.jsx)(y.a,{primary:e.value})},"item--".concat(e.id))}))})]}),Object(S.jsx)("div",{onDrop:function(e){if(e.preventDefault(),e.dataTransfer.items){if(e.dataTransfer.items.length>1)return!1;if("file"===e.dataTransfer.items[0].kind){var t=new FileReader;t.onload=function(e){q(e.currentTarget.result)};var r=e.dataTransfer.items[0].getAsFile();t.readAsText(r)}}},ref:_,style:{position:"absolute",left:"0",top:"0",backgroundColor:"rgba(255,255,255,0.5)",width:"100%",height:"100%",zIndex:k},children:Object(S.jsx)(u.a,{variant:"h6",style:{top:"50%",position:"absolute",left:"50%",msTransform:"translate(-50%, -50%)",transform:" translate(-50%, -50%)"},noWrap:!0,children:"Gpx-Datei ablegen"})})]})};M.defaultProps={visible:!0},M.__docgenInfo={description:"MlGPXViewer returns a dropzone and a button to load a GPX Track into the map.\n\n@component",methods:[],displayName:"MlGPXViewer",props:{visible:{defaultValue:{value:"true",computed:!1},type:{name:"bool"},required:!1,description:'Sets the layers layout-property "visibility" to "none" if false or "visible" if true'},mapId:{type:{name:"string"},required:!1,description:"Id of the target MapLibre instance in mapContext"},idPrefix:{type:{name:"string"},required:!1,description:"Prefix of the component id this component uses when adding elements to the MapLibreGl-instance"},insertBeforeLayer:{type:{name:"string"},required:!1,description:'The layerId of an existing layer this layer should be rendered visually beneath\nhttps://maplibre.org/maplibre-gl-js-docs/api/map/#map#addlayer - see "beforeId" property'}}},t.a=M,"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/MlGPXViewer/MlGPXViewer.js"]={name:"MlGPXViewer",docgenInfo:M.__docgenInfo,path:"src/components/MlGPXViewer/MlGPXViewer.js"})},290:function(e,t,r){"use strict";var n=r(6),o=r(0),a=r(212),i=r(29),s=r(1),c=function(e){var t=Object(o.useContext)(i.b),r=Object(o.useRef)(!1),c=Object(o.useRef)(null),u=Object(o.useRef)((e.layerId?e.layerId:"MlLayer-")+Object(a.a)()),l=Object(o.useRef)(e.idSuffix||(new Date).getTime()),p=(e.layerId||"MlLayer-")+l.current,d=Object(o.useRef)(void 0),f=Object(o.useRef)(void 0);return Object(o.useEffect)((function(){var e=u.current;return function(){c.current&&(c.current.cleanup(e),c.current=null)}}),[]),Object(o.useEffect)((function(){var n,o;if(t.mapExists(e.mapId)&&(null===(n=t.getMap(e.mapId))||void 0===n||null===(o=n.getLayer)||void 0===o?void 0:o.call(n,p))&&r.current&&e.options){var a,i=JSON.stringify(e.options.layout);if(e.options.layout&&i!==f.current){for(a in e.options.layout)c.current.setLayoutProperty(p,a,e.options.layout[a]);f.current=i}var s=JSON.stringify(e.options.paint);if(e.options.paint&&s===d.current)for(a in e.options.paint)c.current.setPaintProperty(p,a,e.options.paint[a])}}),[e.options,p,t,e]),Object(o.useEffect)((function(){var o,a;t.mapExists(e.mapId)&&!r.current&&(c.current=t.getMap(e.mapId),c.current&&(r.current=!0,c.current.addLayer(Object(n.a)({id:p,type:"background",paint:{"background-color":"rgba(0,0,0,0)"}},e.options),e.insertBeforeLayer,u.current),d.current=JSON.stringify(null===(o=e.options)||void 0===o?void 0:o.paint),f.current=JSON.stringify(null===(a=e.options)||void 0===a?void 0:a.layout)))}),[t.mapIds,t,e,p]),Object(s.jsx)(s.Fragment,{})};c.__docgenInfo={description:"",methods:[],displayName:"MlLayer"},t.a=c,"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/MlLayer/MlLayer.js"]={name:"MlLayer",docgenInfo:c.__docgenInfo,path:"src/components/MlLayer/MlLayer.js"})},291:function(e,t,r){"use strict";var n=r(21),o=r(0),a=r(207),i=r(1500),s=r(206),c=r(29),u=r(212),l=r(1),p=function(e){var t=Object(o.useContext)(c.b),r=Object(s.a)({mapId:e.mapId,watch:{viewport:!0}}),p=Object(o.useRef)(void 0),d=Object(o.useRef)(!1),f=Object(o.useRef)(void 0),m=Object(o.useRef)((e.idPrefix?e.idPrefix:"MlMarker-")+Object(u.a)()),g=Object(o.useState)({width:"400px",height:"500px"}),h=Object(n.a)(g,2),b=h[0],v=h[1],y=Object(o.useState)(void 0),j=Object(n.a)(y,2),O=j[0],x=j[1];return Object(o.useEffect)((function(){var e=m.current;return function(){f.current&&(f.current.cleanup(e),f.current=void 0),d.current=!1}}),[]),Object(o.useEffect)((function(){t.mapExists(e.mapId)&&!d.current&&(d.current=!0,f.current=t.getMap(e.mapId))}),[t.mapIds,t,e.mapId]),Object(o.useEffect)((function(){var t;if(null===(t=f.current)||void 0===t?void 0:t.project){var r=f.current.project([e.lng,e.lat]);x(r)}}),[e.lng,e.lat,r.viewport]),Object(o.useEffect)((function(){var t,r,n,o;f.current&&(null===(t=p.current)||void 0===t||null===(r=t.contentWindow)||void 0===r||null===(n=r.document)||void 0===n||null===(o=n.body)||void 0===o?void 0:o.scrollHeight)&&setTimeout((function(){f.current._container.clientWidth;var t,r,n,o,a,i,s,c,u=f.current._container.clientHeight-f.current.project([e.lng,e.lat]).y,l=null===(t=p.current)||void 0===t||null===(r=t.contentWindow)||void 0===r||null===(n=r.document)||void 0===n||null===(o=n.body)||void 0===o?void 0:o.scrollHeight,d=null===(a=p.current)||void 0===a||null===(i=a.contentWindow)||void 0===i||null===(s=i.document)||void 0===s||null===(c=s.body)||void 0===c?void 0:c.scrollWidth;v({width:d,height:u<l?u:l})}),100)}),[e.lng,e.lat,e.content]),Object(l.jsxs)(l.Fragment,{children:[Object(l.jsx)(a.a,{geojson:{type:"Feature",geometry:{type:"Point",coordinates:[e.lng,e.lat]},properties:{}},paint:{"circle-radius":14,"circle-color":"rgba(40,200,20,0.5)"},type:"circle",mapId:e.mapId}),O&&Object(l.jsx)(i.a,{sx:{opacity:.7,position:"fixed",display:"flex",left:O.x,top:O.y,width:b.width,height:b.height,"&:hover":{opacity:1},zIndex:1e3},children:Object(l.jsx)("iframe",{style:{width:"100%"},srcDoc:e.content,ref:p,sandbox:"allow-same-origin allow-popups-to-escape-sandbox",frameBorder:"0"})})]})};p.defaultProps={mapId:void 0},p.__docgenInfo={description:"Adds a marker to the map and displays a marker description next to it\n\n@param {object} props\n@param {string} props.mapId Id of the target MapLibre instance in mapContext\n@param {number} props.lng\n@param {number} props.lat\n@param {string} props.content\n\n@component",methods:[],displayName:"MlMarker",props:{mapId:{defaultValue:{value:"undefined",computed:!0},type:{name:"string"},required:!1,description:"Id of the target MapLibre instance in mapContext"},lng:{type:{name:"number"},required:!1,description:"Longitude of the marker position"},lat:{type:{name:"number"},required:!1,description:"Latitude of the marker position"},content:{type:{name:"string"},required:!1,description:"Content of the description popup"}}},t.a=p,"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/MlMarker/MlMarker.js"]={name:"MlMarker",docgenInfo:p.__docgenInfo,path:"src/components/MlMarker/MlMarker.js"})},292:function(e,t,r){"use strict";var n=r(6),o=r(21),a=r(376),i=r(0),s=r(29),c=r(212),u=["title","titleId"];function l(){return(l=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}function p(e,t){if(null==e)return{};var r,n,o=function(e,t){if(null==e)return{};var r,n,o={},a=Object.keys(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)>=0||(o[r]=e[r]);return o}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(o[r]=e[r])}return o}function d(e,t){var r=e.title,n=e.titleId,o=p(e,u);return i.createElement("svg",l({width:"39.675098mm",height:"104.27064mm",viewBox:"0 0 39.675098 104.27064",ref:t,"aria-labelledby":n},o),r?i.createElement("title",{id:n},r):null,i.createElement("g",{transform:"translate(-86.019554,-58.032633)"},i.createElement("path",{style:{strokeWidth:.744756},d:"m 442.74023,219.33594 -117.62695,32.32422 54.71094,31.12304 c -21.99397,41.5931 -32.8507,84.88283 -38.33008,127.89649 -6.86182,50.94051 -5.95715,103.99765 20.23828,155.46484 5.97246,11.72776 13.65817,23.59773 24.38867,35.06641 2.6597,2.84073 5.65602,5.75455 9.12891,8.68164 0.87557,0.7378 1.85363,1.52609 2.95117,2.35547 0.29669,0.22563 0.63616,0.47742 1.02149,0.75586 l 0.58203,0.42578 34.57812,-15.12305 -0.33789,-0.2207 c -0.0265,-0.0151 -0.0842,-0.0587 -0.18359,-0.13086 -0.46723,-0.34885 -0.9819,-0.76796 -1.56055,-1.25 -2.29757,-1.91343 -4.46539,-4.04643 -6.64062,-6.33985 -8.80052,-9.27114 -15.30333,-19.4993 -20.83985,-30.13867 -24.42289,-46.90715 -24.77465,-97.03535 -18.58008,-146.68164 4.94388,-37.37493 13.65299,-74.4847 30.20508,-109.92969 l 58.6211,33.34766 z",transform:"scale(0.26458333)"})))}var f,m=i.forwardRef(d),g=(r.p,["title","titleId"]);function h(){return(h=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}function b(e,t){if(null==e)return{};var r,n,o=function(e,t){if(null==e)return{};var r,n,o={},a=Object.keys(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)>=0||(o[r]=e[r]);return o}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(o[r]=e[r])}return o}function v(e,t){var r=e.title,n=e.titleId,o=b(e,g);return i.createElement("svg",h({width:"39.675098mm",height:"104.27064mm",viewBox:"0 0 39.675098 104.27064",ref:t,"aria-labelledby":n},o),r?i.createElement("title",{id:n},r):null,f||(f=i.createElement("g",{transform:"translate(-86.019554,-58.032633)"},i.createElement("path",{d:"m 94.572523,58.032633 31.122127,8.55245 -14.4756,8.234638 c 5.81924,11.004841 8.69175,22.458582 10.1415,33.839279 1.81552,13.47801 1.57616,27.51604 -5.35471,41.13341 -1.58021,3.10296 -3.61373,6.24356 -6.45284,9.27798 -0.70371,0.75161 -1.49649,1.52256 -2.41535,2.29702 -0.23167,0.19521 -0.49044,0.40378 -0.78083,0.62322 -0.0785,0.0597 -0.16832,0.12632 -0.27027,0.19999 l -0.154,0.11265 -9.148793,-4.00131 0.0894,-0.0584 c 0.007,-0.004 0.02228,-0.0155 0.04857,-0.0346 0.123621,-0.0923 0.259794,-0.20319 0.412895,-0.33073 0.607899,-0.50626 1.181468,-1.07062 1.756997,-1.67742 2.328481,-2.45299 4.049011,-5.15919 5.513881,-7.97419 6.46189,-12.41085 6.55496,-25.67394 4.91598,-38.80952 -1.30807,-9.888781 -3.61235,-19.707408 -7.99176,-29.085561 l -15.510171,8.823235 z"}))))}var y,j=i.forwardRef(v),O=(r.p,["title","titleId"]);function x(){return(x=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}function S(e,t){if(null==e)return{};var r,n,o=function(e,t){if(null==e)return{};var r,n,o={},a=Object.keys(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)>=0||(o[r]=e[r]);return o}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(o[r]=e[r])}return o}function M(e,t){var r=e.title,n=e.titleId,o=S(e,O);return i.createElement("svg",x({width:"75.967445mm",height:"234.71339mm",viewBox:"0 0 75.967445 234.71339",ref:t,"aria-labelledby":n},o),r?i.createElement("title",{id:n},r):null,y||(y=i.createElement("g",{transform:"translate(-76.705281,-29.77268)"},i.createElement("path",{d:"m 114.68901,29.77268 37.98372,117.3567 H 76.705281 Z"}),i.createElement("path",{d:"m 114.68901,264.48608 37.98372,-117.3567 H 76.705281 Z"}))))}var C,w,E,L=i.forwardRef(M),I=(r.p,r(182)),T=r(244),R=r(1),_=I.a.div(C||(C=Object(a.a)(["\n  width: 40%;\n  display: flex;\n  align-items: center;\n\n  &:hover {\n    cursor: pointer;\n  }\n  path {\n    filter: drop-shadow(0px 0px 15px rgba(0, 0, 0, 0.2));\n  }\n  &:hover path {\n    filter: drop-shadow(0px 0px 13px rgba(255, 255, 255, 0.1));\n  }\n  path:nth-of-type(2) {\n    fill: #343434;\n  }\n  &:hover path:nth-of-type(2) {\n    fill: #434343;\n  }\n  path:nth-of-type(1) {\n    fill: #e90318;\n  }\n  &:hover path:nth-of-type(1) {\n    fill: #fb4052;\n  }\n"]))),A=I.a.div(w||(w=Object(a.a)(["\n  pointer-events: none;\n  display: flex;\n  z-index: 1002;\n  position: absolute;\n  align-items: center;\n\n  margin-left: -30%;\n  path:nth-of-type(2) {\n  }\n  svg g {\n    transform: translate(-76.7053, -29.7727) scale(2, 1);\n  }\n  svg {\n    z-index: 9990;\n    height: 150px;\n    width: 200px;\n  }\n"]))),P=I.a.div(E||(E=Object(a.a)(["\n  width: 30%;\n  margin-top: 14px;\n  z-index: 999;\n  display: flex;\n\n  svg:hover {\n    cursor: pointer;\n  }\n  svg:hover path {\n    fill: #ececec;\n    filter: drop-shadow(0px 0px 5px rgba(0, 0, 0, 0.1));\n  }\n  path {\n    fill: #bbb;\n  }\n  svg {\n    transform: scale(0.6);\n    z-index: 9990;\n    height: 172px;\n  }\n"]))),k=function(e){var t=Object(i.useContext)(s.b),r=Object(i.useRef)(!1),a=Object(i.useRef)(void 0),u=Object(i.useRef)((e.idPrefix?e.idPrefix:"MlNavigationCompass-")+Object(c.a)()),l=Object(i.useState)(0),p=Object(o.a)(l,2),d=p[0],f=p[1];return Object(i.useEffect)((function(){var e=u.current;return function(){a.current&&(a.current.cleanup(e),a.current=void 0),r.current=!1}}),[]),Object(i.useEffect)((function(){t.mapExists(e.mapId)&&!r.current&&(r.current=!0,a.current=t.getMap(e.mapId),a.current.on("rotate",(function(){f(Math.round(a.current.getBearing()))}),u.current),f(Math.round(a.current.getBearing())))}),[t.mapIds,t,e.mapId]),Object(R.jsx)(R.Fragment,{children:Object(R.jsx)("div",{className:Object(T.a)(Object(n.a)({zIndex:1e3,top:0,position:"absolute"},e.style)),children:Object(R.jsxs)("div",{className:Object(T.a)(Object(n.a)({position:"absolute",border:"10px solid #bcbcbc",backgroundColor:"#717171",background:"radial-gradient(#717171, #414141)",height:"200px",width:"200px",borderRadius:"50%",display:"flex",justifyContent:"center",transform:"scale(0.2) translateX(-448px) translateY(-448px)"},e.backgroundStyle)),children:[Object(R.jsx)(P,{className:Object(T.a)(Object(n.a)({},e.rotateRightStyle)),children:Object(R.jsx)(m,{onClick:function(){var e,t,r=Math.round(null===(e=a.current)||void 0===e?void 0:e.getBearing()),n=Math.round(r%90);r>0&&(n=90-n),0===n&&(n=90),null===(t=a.current)||void 0===t||t.setBearing(Math.round(r+Math.abs(n)))}})}),Object(R.jsx)(_,{className:Object(T.a)(Object(n.a)({},e.needleStyle)),onClick:function(){var e;null===(e=a.current)||void 0===e||e.setBearing(0)},children:Object(R.jsx)(A,{style:{transform:"rotate("+d+"deg)"},children:Object(R.jsx)(L,{})})}),Object(R.jsx)(P,{className:Object(T.a)(Object(n.a)({},e.rotateLeftStyle)),children:Object(R.jsx)(j,{onClick:function(){var e,t,r=Math.round(null===(e=a.current)||void 0===e?void 0:e.getBearing()),n=Math.round(r%90);r<0&&(n=90+n),0===n&&(n=90),null===(t=a.current)||void 0===t||t.setBearing(Math.round(r-Math.abs(n)))}})})]})})})};k.__docgenInfo={description:"Navigation component that displays a compass component which indicates the current oriantation of the map it is registered for and offers controls to turn the bearing 90° left/right or reset north to point up.\n\nAll style props are applied using @emotion/css to allow more complex css selectors.\n\n@component",methods:[],displayName:"MlNavigationCompass",props:{idPrefix:{type:{name:"string"},required:!1,description:"Component id prefix"},style:{type:{name:"object"},required:!1,description:"Style object to adjust css definitions of the component."},backgroundStyle:{type:{name:"object"},required:!1,description:"Style object to adjust css definitions of the background."},needleStyle:{type:{name:"object"},required:!1,description:"Style object to adjust css definitions of the compass needle."},rotateRightStyle:{type:{name:"object"},required:!1,description:"Style object to adjust css definitions of the rotate right button."},rotateLeftStyle:{type:{name:"object"},required:!1,description:"Style object to adjust css definitions of the rotate left button."}}};t.a=k;"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/MlNavigationCompass/MlNavigationCompass.js"]={name:"MlNavigationCompass",docgenInfo:k.__docgenInfo,path:"src/components/MlNavigationCompass/MlNavigationCompass.js"})},370:function(e,t,r){"use strict";var n=r(21),o=r(0),a=r(234),i=r(1),s=function(e){var t=e.children,r=Object(o.useState)({type:"FeatureCollection",features:[]}),s=Object(n.a)(r,2),c={data:s[0],setData:s[1],getEmptyFeatureCollection:function(){return{type:"FeatureCollection",features:[]}}};return Object(i.jsx)(a.a,{value:c,children:t})};s.__docgenInfo={description:"",methods:[],displayName:"GeoJsonProvider",props:{children:{type:{name:"node"},required:!0,description:""}}},t.a=s,"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/MlGPXViewer/util/GeoJsonProvider.js"]={name:"GeoJsonProvider",docgenInfo:s.__docgenInfo,path:"src/components/MlGPXViewer/util/GeoJsonProvider.js"})},42:function(e,t,r){"use strict";r(0);var n=r(29),o=r(159),a=(r(640),r(1)),i=[function(e){return Object(a.jsx)("div",{className:"fullscreen_map",children:Object(a.jsxs)(n.a,{children:[Object(a.jsx)(e,{}),Object(a.jsx)(o.a,{options:{zoom:14.5,style:"https://wms.wheregroup.com/tileserver/style/osm-bright.json",center:[7.0851268,50.73884]},mapId:"map_1"})]})})}];t.a=i},640:function(e,t,r){},724:function(e,t,r){"use strict";(function(e){var n=function(){var t,n=/\s*/g,o=/^\s*|\s*$/g,a=/\s+/;function i(e){if(!e||!e.length)return 0;for(var t=0,r=0;t<e.length;t++)r=(r<<5)-r+e.charCodeAt(t)|0;return r}function s(e,t){return e.getElementsByTagName(t)}function c(e,t){return e.getAttribute(t)}function u(e,t){return parseFloat(c(e,t))}function l(e,t){var r=s(e,t);return r.length?r[0]:null}function p(e){for(var t=0,r=[];t<e.length;t++)r[t]=parseFloat(e[t]);return r}function d(e){var t;return e&&(t=e).normalize&&t.normalize(),e&&e.textContent||""}function f(e,t){var r,n,o={};for(n=0;n<t.length;n++)(r=l(e,t[n]))&&(o[t[n]]=d(r));return o}function m(e,t){for(var r in t)e[r]=t[r]}function g(e){return p(e.replace(n,"").split(","))}function h(e){for(var t=e.replace(o,"").split(a),r=[],n=0;n<t.length;n++)r.push(g(t[n]));return r}function b(e){var t,r=[u(e,"lon"),u(e,"lat")],n=l(e,"ele"),o=l(e,"gpxtpx:hr")||l(e,"hr"),a=l(e,"time");return n&&(t=parseFloat(d(n)),isNaN(t)||r.push(t)),{coordinates:r,time:a?d(a):null,heartRate:o?parseFloat(d(o)):null}}if("undefined"!=typeof XMLSerializer)t=new XMLSerializer;else{var v="object"==typeof e&&!e.browser,y="object"==typeof Titanium;if("object"!=typeof exports||!v&&!y)throw new Error("Unable to initialize serializer");t=new(r(1169).XMLSerializer)}function j(e){return void 0!==e.xml?e.xml:t.serializeToString(e)}return{kml:function(e){for(var t={type:"FeatureCollection",features:[]},r={},n={},o={},a=["Polygon","LineString","Point","Track","gx:Track"],u=s(e,"Placemark"),f=s(e,"Style"),m=s(e,"StyleMap"),b=0;b<f.length;b++){var v=i(j(f[b])).toString(16);r["#"+c(f[b],"id")]=v,n[v]=f[b]}for(var y=0;y<m.length;y++){r["#"+c(m[y],"id")]=i(j(m[y])).toString(16);for(var O=s(m[y],"Pair"),x={},S=0;S<O.length;S++)x[d(l(O[S],"key"))]=d(l(O[S],"styleUrl"));o["#"+c(m[y],"id")]=x}for(var M=0;M<u.length;M++)t.features=t.features.concat(E(u[M]));function C(e){var t,r;return"#"===(e=e||"").substr(0,1)&&(e=e.substr(1)),6!==e.length&&3!==e.length||(t=e),8===e.length&&(r=parseInt(e.substr(0,2),16)/255,t="#"+e.substr(6,2)+e.substr(4,2)+e.substr(2,2)),[t,isNaN(r)?void 0:r]}function w(e){var t=s(e,"coord"),r=[],n=[];0===t.length&&(t=s(e,"gx:coord"));for(var o=0;o<t.length;o++)r.push(p(d(t[o]).split(" ")));for(var a=s(e,"when"),i=0;i<a.length;i++)n.push(d(a[i]));return{coords:r,times:n}}function E(e){var t,i=function e(t){var r,n,o,i,c,u=[],p=[];if(l(t,"MultiGeometry"))return e(l(t,"MultiGeometry"));if(l(t,"MultiTrack"))return e(l(t,"MultiTrack"));if(l(t,"gx:MultiTrack"))return e(l(t,"gx:MultiTrack"));for(o=0;o<a.length;o++)if(n=s(t,a[o]))for(i=0;i<n.length;i++)if(r=n[i],"Point"===a[o])u.push({type:"Point",coordinates:g(d(l(r,"coordinates")))});else if("LineString"===a[o])u.push({type:"LineString",coordinates:h(d(l(r,"coordinates")))});else if("Polygon"===a[o]){var f=s(r,"LinearRing"),m=[];for(c=0;c<f.length;c++)m.push(h(d(l(f[c],"coordinates"))));u.push({type:"Polygon",coordinates:m})}else if("Track"===a[o]||"gx:Track"===a[o]){var b=w(r);u.push({type:"LineString",coordinates:b.coords}),b.times.length&&p.push(b.times)}return{geoms:u,coordTimes:p}}(e),u={},p=d(l(e,"name")),f=d(l(e,"address")),m=d(l(e,"styleUrl")),b=d(l(e,"description")),v=l(e,"TimeSpan"),y=l(e,"TimeStamp"),j=l(e,"ExtendedData"),O=l(e,"LineStyle"),x=l(e,"PolyStyle"),S=l(e,"visibility");if(!i.geoms.length)return[];if(p&&(u.name=p),f&&(u.address=f),m){"#"!==m[0]&&(m="#"+m),u.styleUrl=m,r[m]&&(u.styleHash=r[m]),o[m]&&(u.styleMapHash=o[m],u.styleHash=r[o[m].normal]);var M=n[u.styleHash];if(M){O||(O=l(M,"LineStyle")),x||(x=l(M,"PolyStyle"));var E=l(M,"IconStyle");if(E){var L=l(E,"Icon");if(L){var I=d(l(L,"href"));I&&(u.icon=I)}}}}if(b&&(u.description=b),v){var T=d(l(v,"begin")),R=d(l(v,"end"));u.timespan={begin:T,end:R}}if(y&&(u.timestamp=d(l(y,"when"))),O){var _=C(d(l(O,"color"))),A=_[0],P=_[1],k=parseFloat(d(l(O,"width")));A&&(u.stroke=A),isNaN(P)||(u["stroke-opacity"]=P),isNaN(k)||(u["stroke-width"]=k)}if(x){var H=C(d(l(x,"color"))),F=H[0],N=H[1],U=d(l(x,"fill")),B=d(l(x,"outline"));F&&(u.fill=F),isNaN(N)||(u["fill-opacity"]=N),U&&(u["fill-opacity"]="1"===U?u["fill-opacity"]||1:0),B&&(u["stroke-opacity"]="1"===B?u["stroke-opacity"]||1:0)}if(j){var G=s(j,"Data"),D=s(j,"SimpleData");for(t=0;t<G.length;t++)u[G[t].getAttribute("name")]=d(l(G[t],"value"));for(t=0;t<D.length;t++)u[D[t].getAttribute("name")]=d(D[t])}S&&(u.visibility=d(S)),i.coordTimes.length&&(u.coordTimes=1===i.coordTimes.length?i.coordTimes[0]:i.coordTimes);var z={type:"Feature",geometry:1===i.geoms.length?i.geoms[0]:{type:"GeometryCollection",geometries:i.geoms},properties:u};return c(e,"id")&&(z.id=c(e,"id")),[z]}return t},gpx:function(e){var t,r,n=s(e,"trk"),o=s(e,"rte"),a=s(e,"wpt"),i={type:"FeatureCollection",features:[]};for(t=0;t<n.length;t++)(r=g(n[t]))&&i.features.push(r);for(t=0;t<o.length;t++)(r=h(o[t]))&&i.features.push(r);for(t=0;t<a.length;t++)i.features.push(v(a[t]));function u(e,t){for(var r=0;r<t;r++)e.push(null);return e}function p(e,t){var r=s(e,t),n=[],o=[],a=[],i=r.length;if(i<2)return{};for(var c=0;c<i;c++){var l=b(r[c]);n.push(l.coordinates),l.time&&o.push(l.time),(l.heartRate||a.length)&&(a.length||u(a,c),a.push(l.heartRate||null))}return{line:n,times:o,heartRates:a}}function g(e){for(var t,r=s(e,"trkseg"),n=[],o=[],a=[],i=0;i<r.length;i++)if((t=p(r[i],"trkpt"))&&(t.line&&n.push(t.line),t.times&&t.times.length&&o.push(t.times),a.length||t.heartRates&&t.heartRates.length)){if(!a.length)for(var c=0;c<i;c++)a.push(u([],n[c].length));t.heartRates&&t.heartRates.length?a.push(t.heartRates):a.push(u([],t.line.length||0))}if(0!==n.length){var d=j(e);return m(d,y(l(e,"extensions"))),o.length&&(d.coordTimes=1===n.length?o[0]:o),a.length&&(d.heartRates=1===n.length?a[0]:a),{type:"Feature",properties:d,geometry:{type:1===n.length?"LineString":"MultiLineString",coordinates:1===n.length?n[0]:n}}}}function h(e){var t=p(e,"rtept");if(t.line){var r=j(e);return m(r,y(l(e,"extensions"))),{type:"Feature",properties:r,geometry:{type:"LineString",coordinates:t.line}}}}function v(e){var t=j(e);return m(t,f(e,["sym"])),{type:"Feature",properties:t,geometry:{type:"Point",coordinates:b(e).coordinates}}}function y(e){var t={};if(e){var r=l(e,"line");if(r){var n=d(l(r,"color")),o=parseFloat(d(l(r,"opacity"))),a=parseFloat(d(l(r,"width")));n&&(t.stroke=n),isNaN(o)||(t["stroke-opacity"]=o),isNaN(a)||(t["stroke-width"]=96*a/25.4)}}return t}function j(e){var t=f(e,["name","cmt","desc","type","time","keywords"]),r=s(e,"link");r.length&&(t.links=[]);for(var n,o=0;o<r.length;o++)m(n={href:c(r[o],"href")},f(r[o],["text","type"])),t.links.push(n);return t}return i}}}();t.a=n}).call(this,r(148))},726:function(e){e.exports=JSON.parse('{"type":"Feature","properties":{},"geometry":{"type":"LineString","coordinates":[[7.1074676513671875,50.74340774029213],[7.0992279052734375,50.756441089372665],[7.079315185546874,50.764693667025014],[7.045669555664062,50.77945780529241],[7.030563354492187,50.79161300845443],[7.0291900634765625,50.80940599750376],[7.0236968994140625,50.820685846099174],[7.0085906982421875,50.825891011253546],[6.9879913330078125,50.826758482363275],[6.97906494140625,50.835432306955276],[6.9824981689453125,50.84583876895451],[6.9962310791015625,50.85147463352982],[7.012023925781249,50.85710981721644],[7.021636962890625,50.86664473085768],[7.0367431640625,50.872278081520406],[7.0477294921875,50.877044231111014],[7.052536010742187,50.88397594225127]]}}')},727:function(e){e.exports=JSON.parse('{"type":"Feature","properties":{},"geometry":{"type":"LineString","coordinates":[[7.0635223388671875,50.71385204707258],[7.06146240234375,50.709721458354075],[7.063865661621094,50.70298129536074],[7.064552307128906,50.69906720767511],[7.059059143066406,50.69428287906098],[7.05596923828125,50.68797551838366],[7.0580291748046875,50.680797145321655],[7.062835693359375,50.67514068397085],[7.060432434082031,50.6686131506577],[7.051849365234375,50.659255436656736],[7.044639587402344,50.6512019574539],[7.0484161376953125,50.64271166020676],[7.0566558837890625,50.63748609931014]]}}')},798:function(e,t,r){r(799),r(954),r(955),r(1472),r(1464),r(1474),r(1475),r(1476),r(1473),r(1467),r(1477),r(1466),r(1468),r(1478),e.exports=r(1116)},865:function(e,t){},95:function(e,t,r){"use strict";r.d(t,"a",(function(){return c}));r(0);var n=r(1496),o=r(1499),a=r(1501),i=r(1),s=Object(n.a)((function(e){return{root:{flexGrow:1,zIndex:120,position:"absolute",top:0,left:0,right:0},AppBar:{backgroundColor:"#fafafa",minHeight:"62px"}}}));function c(e){var t=s();return Object(i.jsx)("div",{className:t.root,children:Object(i.jsx)(o.a,{className:t.AppBar,position:"static",children:Object(i.jsx)(a.a,{children:e.children})})})}c.__docgenInfo={description:"",methods:[],displayName:"TopToolbar"},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/ui_components/TopToolbar.js"]={name:"TopToolbar",docgenInfo:c.__docgenInfo,path:"src/ui_components/TopToolbar.js"})},955:function(e,t,r){"use strict";r.r(t);r(551)}});
//# sourceMappingURL=main~24120820.a1f965d8.iframe.bundle.js.map